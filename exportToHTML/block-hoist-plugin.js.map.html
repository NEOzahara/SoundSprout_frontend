<html>
<head>
<title>block-hoist-plugin.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #6aab73;}
.s2 { color: #2aacb8;}
.s3 { color: #cf8e6d;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
block-hoist-plugin.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;_traverse&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;_plugin&quot;</span><span class="s0">,</span><span class="s1">&quot;LOADED_PLUGIN&quot;</span><span class="s0">,</span><span class="s1">&quot;blockHoistPlugin&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;visitor&quot;</span><span class="s0">,</span><span class="s1">&quot;Block&quot;</span><span class="s0">,</span><span class="s1">&quot;exit&quot;</span><span class="s0">,</span><span class="s1">&quot;node&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;performHoisting&quot;</span><span class="s0">,</span><span class="s1">&quot;SwitchCase&quot;</span><span class="s0">,</span><span class="s1">&quot;consequent&quot;</span><span class="s0">,</span><span class="s1">&quot;max&quot;</span><span class="s0">,</span><span class="s1">&quot;Math&quot;</span><span class="s0">,</span><span class="s1">&quot;pow&quot;</span><span class="s0">,</span><span class="s1">&quot;hasChange&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;n&quot;</span><span class="s0">,</span><span class="s1">&quot;p&quot;</span><span class="s0">,</span><span class="s1">&quot;priority&quot;</span><span class="s0">,</span><span class="s1">&quot;stableSort&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;loadBlockHoistPlugin&quot;</span><span class="s0">,</span><span class="s1">&quot;Plugin&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;assign&quot;</span><span class="s0">,</span><span class="s1">&quot;traverse&quot;</span><span class="s0">,</span><span class="s1">&quot;explode&quot;</span><span class="s0">,</span><span class="s1">&quot;bodyNode&quot;</span><span class="s0">,</span><span class="s1">&quot;_blockHoist&quot;</span><span class="s0">,</span><span class="s1">&quot;buckets&quot;</span><span class="s0">,</span><span class="s1">&quot;create&quot;</span><span class="s0">,</span><span class="s1">&quot;bucket&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;k&quot;</span><span class="s0">,</span><span class="s1">&quot;sort&quot;</span><span class="s0">,</span><span class="s1">&quot;a&quot;</span><span class="s0">,</span><span class="s1">&quot;b&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">],</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../src/transformation/block-hoist-plugin.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import traverse from </span><span class="s3">\&quot;</span><span class="s1">@babel/traverse</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type { Statement } from </span><span class="s3">\&quot;</span><span class="s1">@babel/types</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type { PluginObject } from </span><span class="s3">\&quot;</span><span class="s1">../config/index.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import Plugin from </span><span class="s3">\&quot;</span><span class="s1">../config/plugin.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">let LOADED_PLUGIN: Plugin | void;</span><span class="s3">\n\n</span><span class="s1">const blockHoistPlugin: PluginObject = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* [Please add a description.]</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* Priority:</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">*  - 0 We want this to be at the **very** bottom</span><span class="s3">\n   </span><span class="s1">*  - 1 Default node position</span><span class="s3">\n   </span><span class="s1">*  - 2 Priority over normal nodes</span><span class="s3">\n   </span><span class="s1">*  - 3 We want this to be at the **very** top</span><span class="s3">\n   </span><span class="s1">*  - 4 Reserved for the helpers used to implement module imports.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n\n  </span><span class="s1">name: </span><span class="s3">\&quot;</span><span class="s1">internal.blockHoist</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n\n  </span><span class="s1">visitor: {</span><span class="s3">\n    </span><span class="s1">Block: {</span><span class="s3">\n      </span><span class="s1">exit({ node }) {</span><span class="s3">\n        </span><span class="s1">node.body = performHoisting(node.body);</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">SwitchCase: {</span><span class="s3">\n      </span><span class="s1">exit({ node }) {</span><span class="s3">\n        </span><span class="s1">// In case statements, hoisting is difficult to perform correctly due to</span><span class="s3">\n        </span><span class="s1">// functions that are declared and referenced in different blocks.</span><span class="s3">\n        </span><span class="s1">// Nevertheless, hoisting the statements *inside* of each case should at</span><span class="s3">\n        </span><span class="s1">// least mitigate the failure cases.</span><span class="s3">\n        </span><span class="s1">node.consequent = performHoisting(node.consequent);</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">function performHoisting(body: Statement[]): Statement[] {</span><span class="s3">\n  </span><span class="s1">// Largest SMI</span><span class="s3">\n  </span><span class="s1">let max = 2 ** 30 - 1;</span><span class="s3">\n  </span><span class="s1">let hasChange = false;</span><span class="s3">\n  </span><span class="s1">for (let i = 0; i &lt; body.length; i++) {</span><span class="s3">\n    </span><span class="s1">const n = body[i];</span><span class="s3">\n    </span><span class="s1">const p = priority(n);</span><span class="s3">\n    </span><span class="s1">if (p &gt; max) {</span><span class="s3">\n      </span><span class="s1">hasChange = true;</span><span class="s3">\n      </span><span class="s1">break;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">max = p;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (!hasChange) return body;</span><span class="s3">\n\n  </span><span class="s1">// My kingdom for a stable sort!</span><span class="s3">\n  </span><span class="s1">return stableSort(body.slice());</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export default function loadBlockHoistPlugin(): Plugin {</span><span class="s3">\n  </span><span class="s1">if (!LOADED_PLUGIN) {</span><span class="s3">\n    </span><span class="s1">// cache the loaded blockHoist plugin plugin</span><span class="s3">\n    </span><span class="s1">LOADED_PLUGIN = new Plugin(</span><span class="s3">\n      </span><span class="s1">{</span><span class="s3">\n        </span><span class="s1">...blockHoistPlugin,</span><span class="s3">\n        </span><span class="s1">visitor: traverse.explode(blockHoistPlugin.visitor),</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">{},</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return LOADED_PLUGIN;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function priority(bodyNode: Statement &amp; { _blockHoist?: number | true }) {</span><span class="s3">\n  </span><span class="s1">const priority = bodyNode?._blockHoist;</span><span class="s3">\n  </span><span class="s1">if (priority == null) return 1;</span><span class="s3">\n  </span><span class="s1">if (priority === true) return 2;</span><span class="s3">\n  </span><span class="s1">return priority;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function stableSort(body: Statement[]) {</span><span class="s3">\n  </span><span class="s1">// By default, we use priorities of 0-4.</span><span class="s3">\n  </span><span class="s1">const buckets = Object.create(null);</span><span class="s3">\n\n  </span><span class="s1">// By collecting into buckets, we can guarantee a stable sort.</span><span class="s3">\n  </span><span class="s1">for (let i = 0; i &lt; body.length; i++) {</span><span class="s3">\n    </span><span class="s1">const n = body[i];</span><span class="s3">\n    </span><span class="s1">const p = priority(n);</span><span class="s3">\n\n    </span><span class="s1">// In case some plugin is setting an unexpected priority.</span><span class="s3">\n    </span><span class="s1">const bucket = buckets[p] || (buckets[p] = []);</span><span class="s3">\n    </span><span class="s1">bucket.push(n);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Sort our keys in descending order. Keys are unique, so we don't have to</span><span class="s3">\n  </span><span class="s1">// worry about stability.</span><span class="s3">\n  </span><span class="s1">const keys = Object.keys(buckets)</span><span class="s3">\n    </span><span class="s1">.map(k =&gt; +k)</span><span class="s3">\n    </span><span class="s1">.sort((a, b) =&gt; b - a);</span><span class="s3">\n\n  </span><span class="s1">let index = 0;</span><span class="s3">\n  </span><span class="s1">for (const key of keys) {</span><span class="s3">\n    </span><span class="s1">const bucket = buckets[key];</span><span class="s3">\n    </span><span class="s1">for (const n of bucket) {</span><span class="s3">\n      </span><span class="s1">body[index++] = n;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return body;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[]}</span></pre>
</body>
</html>