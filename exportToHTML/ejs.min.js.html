<html>
<head>
<title>ejs.min.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #cf8e6d;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
.s5 { color: #42c3d4;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
ejs.min.js</font>
</center></td></tr></table>
<pre><span class="s0">(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">f</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">exports</span><span class="s0">===</span><span class="s3">&quot;object&quot;</span><span class="s0">&amp;&amp;</span><span class="s1">typeof </span><span class="s2">module</span><span class="s0">!==</span><span class="s3">&quot;undefined&quot;</span><span class="s0">){</span><span class="s2">module</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">f</span><span class="s0">()}</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">define</span><span class="s0">===</span><span class="s3">&quot;function&quot;</span><span class="s0">&amp;&amp;</span><span class="s2">define</span><span class="s0">.</span><span class="s2">amd</span><span class="s0">){</span><span class="s2">define</span><span class="s0">([],</span><span class="s2">f</span><span class="s0">)}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">g</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">window</span><span class="s0">!==</span><span class="s3">&quot;undefined&quot;</span><span class="s0">){</span><span class="s2">g</span><span class="s0">=</span><span class="s2">window</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">global</span><span class="s0">!==</span><span class="s3">&quot;undefined&quot;</span><span class="s0">){</span><span class="s2">g</span><span class="s0">=</span><span class="s2">global</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">self</span><span class="s0">!==</span><span class="s3">&quot;undefined&quot;</span><span class="s0">){</span><span class="s2">g</span><span class="s0">=</span><span class="s2">self</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">g</span><span class="s0">=</span><span class="s1">this</span><span class="s0">}</span><span class="s2">g</span><span class="s0">.</span><span class="s2">ejs</span><span class="s0">=</span><span class="s2">f</span><span class="s0">()}})(</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">define</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">;</span><span class="s1">return function</span><span class="s0">(){</span><span class="s1">function </span><span class="s2">r</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">f</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">require</span><span class="s0">&amp;&amp;</span><span class="s2">require</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">f</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">)</span><span class="s1">return </span><span class="s2">c</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot find module '&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s3">&quot;'&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">=</span><span class="s3">&quot;MODULE_NOT_FOUND&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">}</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]={</span><span class="s2">exports</span><span class="s0">:{}};</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">][</span><span class="s4">0</span><span class="s0">].</span><span class="s2">call</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">,</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">][</span><span class="s4">1</span><span class="s0">][</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return </span><span class="s2">o</span><span class="s0">(</span><span class="s2">n</span><span class="s0">||</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">p</span><span class="s0">,</span><span class="s2">p</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">exports</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">require</span><span class="s0">&amp;&amp;</span><span class="s2">require</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">i</span><span class="s0">++)</span><span class="s2">o</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]);</span><span class="s1">return </span><span class="s2">o</span><span class="s0">}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">}()({</span><span class="s4">1</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">fs</span><span class="s0">=</span><span class="s2">require</span><span class="s0">(</span><span class="s3">&quot;fs&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">path</span><span class="s0">=</span><span class="s2">require</span><span class="s0">(</span><span class="s3">&quot;path&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">utils</span><span class="s0">=</span><span class="s2">require</span><span class="s0">(</span><span class="s3">&quot;./utils&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">scopeOptionWarned</span><span class="s0">=</span><span class="s1">false</span><span class="s0">;</span><span class="s1">var </span><span class="s2">_VERSION_STRING</span><span class="s0">=</span><span class="s2">require</span><span class="s0">(</span><span class="s3">&quot;../package.json&quot;</span><span class="s0">).</span><span class="s2">version</span><span class="s0">;</span><span class="s1">var </span><span class="s2">_DEFAULT_OPEN_DELIMITER</span><span class="s0">=</span><span class="s3">&quot;&lt;&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">_DEFAULT_CLOSE_DELIMITER</span><span class="s0">=</span><span class="s3">&quot;&gt;&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">_DEFAULT_DELIMITER</span><span class="s0">=</span><span class="s3">&quot;%&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">_DEFAULT_LOCALS_NAME</span><span class="s0">=</span><span class="s3">&quot;locals&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">_NAME</span><span class="s0">=</span><span class="s3">&quot;ejs&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">_REGEX_STRING</span><span class="s0">=</span><span class="s3">&quot;(&lt;%%|%%&gt;|&lt;%=|&lt;%-|&lt;%_|&lt;%#|&lt;%|%&gt;|-%&gt;|_%&gt;)&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">_OPTS_PASSABLE_WITH_DATA</span><span class="s0">=[</span><span class="s3">&quot;delimiter&quot;</span><span class="s0">,</span><span class="s3">&quot;scope&quot;</span><span class="s0">,</span><span class="s3">&quot;context&quot;</span><span class="s0">,</span><span class="s3">&quot;debug&quot;</span><span class="s0">,</span><span class="s3">&quot;compileDebug&quot;</span><span class="s0">,</span><span class="s3">&quot;client&quot;</span><span class="s0">,</span><span class="s3">&quot;_with&quot;</span><span class="s0">,</span><span class="s3">&quot;rmWhitespace&quot;</span><span class="s0">,</span><span class="s3">&quot;strict&quot;</span><span class="s0">,</span><span class="s3">&quot;filename&quot;</span><span class="s0">,</span><span class="s3">&quot;async&quot;</span><span class="s0">];</span><span class="s1">var </span><span class="s2">_OPTS_PASSABLE_WITH_DATA_EXPRESS</span><span class="s0">=</span><span class="s2">_OPTS_PASSABLE_WITH_DATA</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s3">&quot;cache&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">_BOM</span><span class="s0">=</span><span class="s5">/^\uFEFF/</span><span class="s0">;</span><span class="s1">var </span><span class="s2">_JS_IDENTIFIER</span><span class="s0">=</span><span class="s5">/^[a-zA-Z_$][0-9a-zA-Z_$]*$/</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">fileLoader</span><span class="s0">=</span><span class="s2">fs</span><span class="s0">.</span><span class="s2">readFileSync</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">localsName</span><span class="s0">=</span><span class="s2">_DEFAULT_LOCALS_NAME</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">promiseImpl</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Function</span><span class="s0">(</span><span class="s3">&quot;return this;&quot;</span><span class="s0">)().</span><span class="s2">Promise</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">resolveInclude</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">name</span><span class="s0">,</span><span class="s2">filename</span><span class="s0">,</span><span class="s2">isDir</span><span class="s0">){</span><span class="s1">var </span><span class="s2">dirname</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">dirname</span><span class="s0">;</span><span class="s1">var </span><span class="s2">extname</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">extname</span><span class="s0">;</span><span class="s1">var </span><span class="s2">resolve</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">;</span><span class="s1">var </span><span class="s2">includePath</span><span class="s0">=</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">isDir</span><span class="s0">?</span><span class="s2">filename</span><span class="s0">:</span><span class="s2">dirname</span><span class="s0">(</span><span class="s2">filename</span><span class="s0">),</span><span class="s2">name</span><span class="s0">);</span><span class="s1">var </span><span class="s2">ext</span><span class="s0">=</span><span class="s2">extname</span><span class="s0">(</span><span class="s2">name</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">ext</span><span class="s0">){</span><span class="s2">includePath</span><span class="s0">+=</span><span class="s3">&quot;.ejs&quot;</span><span class="s0">}</span><span class="s1">return </span><span class="s2">includePath</span><span class="s0">};</span><span class="s1">function </span><span class="s2">resolvePaths</span><span class="s0">(</span><span class="s2">name</span><span class="s0">,</span><span class="s2">paths</span><span class="s0">){</span><span class="s1">var </span><span class="s2">filePath</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">paths</span><span class="s0">.</span><span class="s2">some</span><span class="s0">(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">v</span><span class="s0">){</span><span class="s2">filePath</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">resolveInclude</span><span class="s0">(</span><span class="s2">name</span><span class="s0">,</span><span class="s2">v</span><span class="s0">,</span><span class="s1">true</span><span class="s0">);</span><span class="s1">return </span><span class="s2">fs</span><span class="s0">.</span><span class="s2">existsSync</span><span class="s0">(</span><span class="s2">filePath</span><span class="s0">)})){</span><span class="s1">return </span><span class="s2">filePath</span><span class="s0">}}</span><span class="s1">function </span><span class="s2">getIncludePath</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">options</span><span class="s0">){</span><span class="s1">var </span><span class="s2">includePath</span><span class="s0">;</span><span class="s1">var </span><span class="s2">filePath</span><span class="s0">;</span><span class="s1">var </span><span class="s2">views</span><span class="s0">=</span><span class="s2">options</span><span class="s0">.</span><span class="s2">views</span><span class="s0">;</span><span class="s1">var </span><span class="s2">match</span><span class="s0">=</span><span class="s5">/^[A-Za-z]+:\\|^\//</span><span class="s0">.</span><span class="s2">exec</span><span class="s0">(</span><span class="s2">path</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">match</span><span class="s0">&amp;&amp;</span><span class="s2">match</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s2">path</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/^\/*/</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">root</span><span class="s0">)){</span><span class="s2">includePath</span><span class="s0">=</span><span class="s2">resolvePaths</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">options</span><span class="s0">.</span><span class="s2">root</span><span class="s0">)}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">includePath</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">resolveInclude</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">options</span><span class="s0">.</span><span class="s2">root</span><span class="s0">||</span><span class="s3">&quot;/&quot;</span><span class="s0">,</span><span class="s1">true</span><span class="s0">)}}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">){</span><span class="s2">filePath</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">resolveInclude</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">options</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">fs</span><span class="s0">.</span><span class="s2">existsSync</span><span class="s0">(</span><span class="s2">filePath</span><span class="s0">)){</span><span class="s2">includePath</span><span class="s0">=</span><span class="s2">filePath</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">includePath</span><span class="s0">&amp;&amp;</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">views</span><span class="s0">)){</span><span class="s2">includePath</span><span class="s0">=</span><span class="s2">resolvePaths</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">views</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">includePath</span><span class="s0">&amp;&amp;</span><span class="s1">typeof </span><span class="s2">options</span><span class="s0">.</span><span class="s2">includer</span><span class="s0">!==</span><span class="s3">&quot;function&quot;</span><span class="s0">){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not find the include file &quot;'</span><span class="s0">+</span><span class="s2">options</span><span class="s0">.</span><span class="s2">escapeFunction</span><span class="s0">(</span><span class="s2">path</span><span class="s0">)+</span><span class="s3">'&quot;'</span><span class="s0">)}}</span><span class="s1">return </span><span class="s2">includePath</span><span class="s0">}</span><span class="s1">function </span><span class="s2">handleCache</span><span class="s0">(</span><span class="s2">options</span><span class="s0">,</span><span class="s2">template</span><span class="s0">){</span><span class="s1">var </span><span class="s2">func</span><span class="s0">;</span><span class="s1">var </span><span class="s2">filename</span><span class="s0">=</span><span class="s2">options</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">;</span><span class="s1">var </span><span class="s2">hasTemplate</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">filename</span><span class="s0">){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;cache option requires a filename&quot;</span><span class="s0">)}</span><span class="s2">func</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">filename</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">func</span><span class="s0">){</span><span class="s1">return </span><span class="s2">func</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">hasTemplate</span><span class="s0">){</span><span class="s2">template</span><span class="s0">=</span><span class="s2">fileLoader</span><span class="s0">(</span><span class="s2">filename</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">().</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">_BOM</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)}}</span><span class="s1">else if</span><span class="s0">(!</span><span class="s2">hasTemplate</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">filename</span><span class="s0">){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Internal EJS error: no file name or template &quot;</span><span class="s0">+</span><span class="s3">&quot;provided&quot;</span><span class="s0">)}</span><span class="s2">template</span><span class="s0">=</span><span class="s2">fileLoader</span><span class="s0">(</span><span class="s2">filename</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">().</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">_BOM</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)}</span><span class="s2">func</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">(</span><span class="s2">template</span><span class="s0">,</span><span class="s2">options</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">){</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">filename</span><span class="s0">,</span><span class="s2">func</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">func</span><span class="s0">}</span><span class="s1">function </span><span class="s2">tryHandleCache</span><span class="s0">(</span><span class="s2">options</span><span class="s0">,</span><span class="s2">data</span><span class="s0">,</span><span class="s2">cb</span><span class="s0">){</span><span class="s1">var </span><span class="s2">result</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">cb</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">exports</span><span class="s0">.</span><span class="s2">promiseImpl</span><span class="s0">==</span><span class="s3">&quot;function&quot;</span><span class="s0">){</span><span class="s1">return new </span><span class="s2">exports</span><span class="s0">.</span><span class="s2">promiseImpl</span><span class="s0">(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">resolve</span><span class="s0">,</span><span class="s2">reject</span><span class="s0">){</span><span class="s1">try</span><span class="s0">{</span><span class="s2">result</span><span class="s0">=</span><span class="s2">handleCache</span><span class="s0">(</span><span class="s2">options</span><span class="s0">)(</span><span class="s2">data</span><span class="s0">);</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">result</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">err</span><span class="s0">){</span><span class="s2">reject</span><span class="s0">(</span><span class="s2">err</span><span class="s0">)}})}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Please provide a callback function&quot;</span><span class="s0">)}}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">try</span><span class="s0">{</span><span class="s2">result</span><span class="s0">=</span><span class="s2">handleCache</span><span class="s0">(</span><span class="s2">options</span><span class="s0">)(</span><span class="s2">data</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">err</span><span class="s0">){</span><span class="s1">return </span><span class="s2">cb</span><span class="s0">(</span><span class="s2">err</span><span class="s0">)}</span><span class="s2">cb</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">result</span><span class="s0">)}}</span><span class="s1">function </span><span class="s2">fileLoader</span><span class="s0">(</span><span class="s2">filePath</span><span class="s0">){</span><span class="s1">return </span><span class="s2">exports</span><span class="s0">.</span><span class="s2">fileLoader</span><span class="s0">(</span><span class="s2">filePath</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">includeFile</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">options</span><span class="s0">){</span><span class="s1">var </span><span class="s2">opts</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">shallowCopy</span><span class="s0">(</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">createNullProtoObjWherePossible</span><span class="s0">(),</span><span class="s2">options</span><span class="s0">);</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">=</span><span class="s2">getIncludePath</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">opts</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">options</span><span class="s0">.</span><span class="s2">includer</span><span class="s0">===</span><span class="s3">&quot;function&quot;</span><span class="s0">){</span><span class="s1">var </span><span class="s2">includerResult</span><span class="s0">=</span><span class="s2">options</span><span class="s0">.</span><span class="s2">includer</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">includerResult</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">includerResult</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">){</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">=</span><span class="s2">includerResult</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">includerResult</span><span class="s0">.</span><span class="s2">template</span><span class="s0">){</span><span class="s1">return </span><span class="s2">handleCache</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">,</span><span class="s2">includerResult</span><span class="s0">.</span><span class="s2">template</span><span class="s0">)}}}</span><span class="s1">return </span><span class="s2">handleCache</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">rethrow</span><span class="s0">(</span><span class="s2">err</span><span class="s0">,</span><span class="s2">str</span><span class="s0">,</span><span class="s2">flnm</span><span class="s0">,</span><span class="s2">lineno</span><span class="s0">,</span><span class="s2">esc</span><span class="s0">){</span><span class="s1">var </span><span class="s2">lines</span><span class="s0">=</span><span class="s2">str</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">start</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s2">lineno</span><span class="s0">-</span><span class="s4">3</span><span class="s0">,</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">end</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s2">lines</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">lineno</span><span class="s0">+</span><span class="s4">3</span><span class="s0">);</span><span class="s1">var </span><span class="s2">filename</span><span class="s0">=</span><span class="s2">esc</span><span class="s0">(</span><span class="s2">flnm</span><span class="s0">);</span><span class="s1">var </span><span class="s2">context</span><span class="s0">=</span><span class="s2">lines</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">start</span><span class="s0">,</span><span class="s2">end</span><span class="s0">).</span><span class="s2">map</span><span class="s0">(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">line</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">var </span><span class="s2">curr</span><span class="s0">=</span><span class="s2">i</span><span class="s0">+</span><span class="s2">start</span><span class="s0">+</span><span class="s4">1</span><span class="s0">;</span><span class="s1">return</span><span class="s0">(</span><span class="s2">curr</span><span class="s0">==</span><span class="s2">lineno</span><span class="s0">?</span><span class="s3">&quot; &gt;&gt; &quot;</span><span class="s0">:</span><span class="s3">&quot;    &quot;</span><span class="s0">)+</span><span class="s2">curr</span><span class="s0">+</span><span class="s3">&quot;| &quot;</span><span class="s0">+</span><span class="s2">line</span><span class="s0">}).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">);</span><span class="s2">err</span><span class="s0">.</span><span class="s2">path</span><span class="s0">=</span><span class="s2">filename</span><span class="s0">;</span><span class="s2">err</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=(</span><span class="s2">filename</span><span class="s0">||</span><span class="s3">&quot;ejs&quot;</span><span class="s0">)+</span><span class="s3">&quot;:&quot;</span><span class="s0">+</span><span class="s2">lineno</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s2">context</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s2">err</span><span class="s0">.</span><span class="s2">message</span><span class="s0">;</span><span class="s1">throw </span><span class="s2">err</span><span class="s0">}</span><span class="s1">function </span><span class="s2">stripSemi</span><span class="s0">(</span><span class="s2">str</span><span class="s0">){</span><span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/;(\s*$)/</span><span class="s0">,</span><span class="s3">&quot;$1&quot;</span><span class="s0">)}</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">=</span><span class="s1">function </span><span class="s2">compile</span><span class="s0">(</span><span class="s2">template</span><span class="s0">,</span><span class="s2">opts</span><span class="s0">){</span><span class="s1">var </span><span class="s2">templ</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">&amp;&amp;</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">scope</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">scopeOptionWarned</span><span class="s0">){</span><span class="s2">console</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s3">&quot;`scope` option is deprecated and will be removed in EJS 3&quot;</span><span class="s0">);</span><span class="s2">scopeOptionWarned</span><span class="s0">=</span><span class="s1">true</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">context</span><span class="s0">){</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">context</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">scope</span><span class="s0">}</span><span class="s1">delete </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">scope</span><span class="s0">}</span><span class="s2">templ</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Template</span><span class="s0">(</span><span class="s2">template</span><span class="s0">,</span><span class="s2">opts</span><span class="s0">);</span><span class="s1">return </span><span class="s2">templ</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">()};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">render</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">template</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">o</span><span class="s0">){</span><span class="s1">var </span><span class="s2">data</span><span class="s0">=</span><span class="s2">d</span><span class="s0">||</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">createNullProtoObjWherePossible</span><span class="s0">();</span><span class="s1">var </span><span class="s2">opts</span><span class="s0">=</span><span class="s2">o</span><span class="s0">||</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">createNullProtoObjWherePossible</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">==</span><span class="s4">2</span><span class="s0">){</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">shallowCopyFromList</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">,</span><span class="s2">data</span><span class="s0">,</span><span class="s2">_OPTS_PASSABLE_WITH_DATA</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">handleCache</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">,</span><span class="s2">template</span><span class="s0">)(</span><span class="s2">data</span><span class="s0">)};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">renderFile</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">args</span><span class="s0">=</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">arguments</span><span class="s0">);</span><span class="s1">var </span><span class="s2">filename</span><span class="s0">=</span><span class="s2">args</span><span class="s0">.</span><span class="s2">shift</span><span class="s0">();</span><span class="s1">var </span><span class="s2">cb</span><span class="s0">;</span><span class="s1">var </span><span class="s2">opts</span><span class="s0">={</span><span class="s2">filename</span><span class="s0">:</span><span class="s2">filename</span><span class="s0">};</span><span class="s1">var </span><span class="s2">data</span><span class="s0">;</span><span class="s1">var </span><span class="s2">viewOpts</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]==</span><span class="s3">&quot;function&quot;</span><span class="s0">){</span><span class="s2">cb</span><span class="s0">=</span><span class="s2">args</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">()}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">args</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s2">data</span><span class="s0">=</span><span class="s2">args</span><span class="s0">.</span><span class="s2">shift</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">args</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">shallowCopy</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">,</span><span class="s2">args</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">())}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s2">data</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">data</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">.</span><span class="s2">views</span><span class="s0">){</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">views</span><span class="s0">=</span><span class="s2">data</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">.</span><span class="s2">views</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">data</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">[</span><span class="s3">&quot;view cache&quot;</span><span class="s0">]){</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">=</span><span class="s1">true</span><span class="s0">}</span><span class="s2">viewOpts</span><span class="s0">=</span><span class="s2">data</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">[</span><span class="s3">&quot;view options&quot;</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">viewOpts</span><span class="s0">){</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">shallowCopy</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">,</span><span class="s2">viewOpts</span><span class="s0">)}}</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">shallowCopyFromList</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">,</span><span class="s2">data</span><span class="s0">,</span><span class="s2">_OPTS_PASSABLE_WITH_DATA_EXPRESS</span><span class="s0">)}</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">=</span><span class="s2">filename</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">data</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">createNullProtoObjWherePossible</span><span class="s0">()}</span><span class="s1">return </span><span class="s2">tryHandleCache</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">,</span><span class="s2">data</span><span class="s0">,</span><span class="s2">cb</span><span class="s0">)};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">Template</span><span class="s0">=</span><span class="s2">Template</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">clearCache</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">.</span><span class="s2">reset</span><span class="s0">()};</span><span class="s1">function </span><span class="s2">Template</span><span class="s0">(</span><span class="s2">text</span><span class="s0">,</span><span class="s2">optsParam</span><span class="s0">){</span><span class="s1">var </span><span class="s2">opts</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">hasOwnOnlyObject</span><span class="s0">(</span><span class="s2">optsParam</span><span class="s0">);</span><span class="s1">var </span><span class="s2">options</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">createNullProtoObjWherePossible</span><span class="s0">();</span><span class="s1">this</span><span class="s0">.</span><span class="s2">templateText</span><span class="s0">=</span><span class="s2">text</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">=</span><span class="s1">false</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">currentLine</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">client</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">client</span><span class="s0">||</span><span class="s1">false</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">escapeFunction</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">escape</span><span class="s0">||</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">escapeFunction</span><span class="s0">||</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">escapeXML</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">compileDebug</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">compileDebug</span><span class="s0">!==</span><span class="s1">false</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">=!!</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">openDelimiter</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">openDelimiter</span><span class="s0">||</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">openDelimiter</span><span class="s0">||</span><span class="s2">_DEFAULT_OPEN_DELIMITER</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">closeDelimiter</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">closeDelimiter</span><span class="s0">||</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">closeDelimiter</span><span class="s0">||</span><span class="s2">_DEFAULT_CLOSE_DELIMITER</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">||</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">||</span><span class="s2">_DEFAULT_DELIMITER</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">strict</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strict</span><span class="s0">||</span><span class="s1">false</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">context</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">context</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">||</span><span class="s1">false</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">rmWhitespace</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">rmWhitespace</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">root</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">root</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">includer</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">includer</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">outputFunctionName</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">outputFunctionName</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">localsName</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">localsName</span><span class="s0">||</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">localsName</span><span class="s0">||</span><span class="s2">_DEFAULT_LOCALS_NAME</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">views</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">views</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">async</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">async</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">destructuredLocals</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">destructuredLocals</span><span class="s0">;</span><span class="s2">options</span><span class="s0">.</span><span class="s2">legacyInclude</span><span class="s0">=</span><span class="s1">typeof </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">legacyInclude</span><span class="s0">!=</span><span class="s3">&quot;undefined&quot;</span><span class="s0">?!!</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">legacyInclude</span><span class="s0">:</span><span class="s1">true</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">strict</span><span class="s0">){</span><span class="s2">options</span><span class="s0">.</span><span class="s2">_with</span><span class="s0">=</span><span class="s1">false</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">options</span><span class="s0">.</span><span class="s2">_with</span><span class="s0">=</span><span class="s1">typeof </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_with</span><span class="s0">!=</span><span class="s3">&quot;undefined&quot;</span><span class="s0">?</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_with</span><span class="s0">:</span><span class="s1">true</span><span class="s0">}</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">=</span><span class="s2">options</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">createRegex</span><span class="s0">()}</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">={</span><span class="s2">EVAL</span><span class="s0">:</span><span class="s3">&quot;eval&quot;</span><span class="s0">,</span><span class="s2">ESCAPED</span><span class="s0">:</span><span class="s3">&quot;escaped&quot;</span><span class="s0">,</span><span class="s2">RAW</span><span class="s0">:</span><span class="s3">&quot;raw&quot;</span><span class="s0">,</span><span class="s2">COMMENT</span><span class="s0">:</span><span class="s3">&quot;comment&quot;</span><span class="s0">,</span><span class="s2">LITERAL</span><span class="s0">:</span><span class="s3">&quot;literal&quot;</span><span class="s0">};</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">={</span><span class="s2">createRegex</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">str</span><span class="s0">=</span><span class="s2">_REGEX_STRING</span><span class="s0">;</span><span class="s1">var </span><span class="s2">delim</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">escapeRegExpChars</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">);</span><span class="s1">var </span><span class="s2">open</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">escapeRegExpChars</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">openDelimiter</span><span class="s0">);</span><span class="s1">var </span><span class="s2">close</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">escapeRegExpChars</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">closeDelimiter</span><span class="s0">);</span><span class="s2">str</span><span class="s0">=</span><span class="s2">str</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/%/g</span><span class="s0">,</span><span class="s2">delim</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/&lt;/g</span><span class="s0">,</span><span class="s2">open</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/&gt;/g</span><span class="s0">,</span><span class="s2">close</span><span class="s0">);</span><span class="s1">return new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">str</span><span class="s0">)},</span><span class="s2">compile</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">src</span><span class="s0">;</span><span class="s1">var </span><span class="s2">fn</span><span class="s0">;</span><span class="s1">var </span><span class="s2">opts</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">;</span><span class="s1">var </span><span class="s2">prepended</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">appended</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">escapeFn</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">escapeFunction</span><span class="s0">;</span><span class="s1">var </span><span class="s2">ctor</span><span class="s0">;</span><span class="s1">var </span><span class="s2">sanitizedFilename</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">?</span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">):</span><span class="s3">&quot;undefined&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">generateSource</span><span class="s0">();</span><span class="s2">prepended</span><span class="s0">+=</span><span class="s3">'  var __output = &quot;&quot;;</span><span class="s1">\n</span><span class="s3">'</span><span class="s0">+</span><span class="s3">&quot;  function __append(s) { if (s !== undefined &amp;&amp; s !== null) __output += s }</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">outputFunctionName</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">_JS_IDENTIFIER</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">outputFunctionName</span><span class="s0">)){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;outputFunctionName is not a valid JS identifier.&quot;</span><span class="s0">)}</span><span class="s2">prepended</span><span class="s0">+=</span><span class="s3">&quot;  var &quot;</span><span class="s0">+</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">outputFunctionName</span><span class="s0">+</span><span class="s3">&quot; = __append;&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">localsName</span><span class="s0">&amp;&amp;!</span><span class="s2">_JS_IDENTIFIER</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">localsName</span><span class="s0">)){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;localsName is not a valid JS identifier.&quot;</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">destructuredLocals</span><span class="s0">&amp;&amp;</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">destructuredLocals</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">var </span><span class="s2">destructuring</span><span class="s0">=</span><span class="s3">&quot;  var __locals = (&quot;</span><span class="s0">+</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">localsName</span><span class="s0">+</span><span class="s3">&quot; || {}),</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">destructuredLocals</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">i</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">name</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">destructuredLocals</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">_JS_IDENTIFIER</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">name</span><span class="s0">)){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;destructuredLocals[&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s3">&quot;] is not a valid JS identifier.&quot;</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">){</span><span class="s2">destructuring</span><span class="s0">+=</span><span class="s3">&quot;,</span><span class="s1">\n  </span><span class="s3">&quot;</span><span class="s0">}</span><span class="s2">destructuring</span><span class="s0">+=</span><span class="s2">name</span><span class="s0">+</span><span class="s3">&quot; = __locals.&quot;</span><span class="s0">+</span><span class="s2">name</span><span class="s0">}</span><span class="s2">prepended</span><span class="s0">+=</span><span class="s2">destructuring</span><span class="s0">+</span><span class="s3">&quot;;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_with</span><span class="s0">!==</span><span class="s1">false</span><span class="s0">){</span><span class="s2">prepended</span><span class="s0">+=</span><span class="s3">&quot;  with (&quot;</span><span class="s0">+</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">localsName</span><span class="s0">+</span><span class="s3">&quot; || {}) {&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s2">appended</span><span class="s0">+=</span><span class="s3">&quot;  }&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">}</span><span class="s2">appended</span><span class="s0">+=</span><span class="s3">&quot;  return __output;&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">=</span><span class="s2">prepended</span><span class="s0">+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">+</span><span class="s2">appended</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">compileDebug</span><span class="s0">){</span><span class="s2">src</span><span class="s0">=</span><span class="s3">&quot;var __line = 1&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">&quot;  , __lines = &quot;</span><span class="s0">+</span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">templateText</span><span class="s0">)+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">&quot;  , __filename = &quot;</span><span class="s0">+</span><span class="s2">sanitizedFilename</span><span class="s0">+</span><span class="s3">&quot;;&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">&quot;try {&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">+</span><span class="s3">&quot;} catch (e) {&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">&quot;  rethrow(e, __lines, __filename, __line, escapeFn);&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">&quot;}&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">src</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">client</span><span class="s0">){</span><span class="s2">src</span><span class="s0">=</span><span class="s3">&quot;escapeFn = escapeFn || &quot;</span><span class="s0">+</span><span class="s2">escapeFn</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">()+</span><span class="s3">&quot;;&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s2">src</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">compileDebug</span><span class="s0">){</span><span class="s2">src</span><span class="s0">=</span><span class="s3">&quot;rethrow = rethrow || &quot;</span><span class="s0">+</span><span class="s2">rethrow</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">()+</span><span class="s3">&quot;;&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s2">src</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strict</span><span class="s0">){</span><span class="s2">src</span><span class="s0">=</span><span class="s3">'&quot;use strict&quot;;</span><span class="s1">\n</span><span class="s3">'</span><span class="s0">+</span><span class="s2">src</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">){</span><span class="s2">console</span><span class="s0">.</span><span class="s2">log</span><span class="s0">(</span><span class="s2">src</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">compileDebug</span><span class="s0">&amp;&amp;</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">){</span><span class="s2">src</span><span class="s0">=</span><span class="s2">src</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">&quot;//# sourceURL=&quot;</span><span class="s0">+</span><span class="s2">sanitizedFilename</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">}</span><span class="s1">try</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">async</span><span class="s0">){</span><span class="s1">try</span><span class="s0">{</span><span class="s2">ctor</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Function</span><span class="s0">(</span><span class="s3">&quot;return (async function(){}).constructor;&quot;</span><span class="s0">)()}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">SyntaxError</span><span class="s0">){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;This environment does not support async/await&quot;</span><span class="s0">)}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">throw </span><span class="s2">e</span><span class="s0">}}}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">ctor</span><span class="s0">=</span><span class="s2">Function</span><span class="s0">}</span><span class="s2">fn</span><span class="s0">=</span><span class="s1">new </span><span class="s2">ctor</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">localsName</span><span class="s0">+</span><span class="s3">&quot;, escapeFn, include, rethrow&quot;</span><span class="s0">,</span><span class="s2">src</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">SyntaxError</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">+=</span><span class="s3">&quot; in &quot;</span><span class="s0">+</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">+=</span><span class="s3">&quot; while compiling ejs</span><span class="s1">\n\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">+=</span><span class="s3">&quot;If the above error is not helpful, you may want to try EJS-Lint:</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">+=</span><span class="s3">&quot;https://github.com/RyanZim/EJS-Lint&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">async</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">+=</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">+=</span><span class="s3">&quot;Or, if you meant to create an async function, pass `async: true` as an option.&quot;</span><span class="s0">}}</span><span class="s1">throw </span><span class="s2">e</span><span class="s0">}</span><span class="s1">var </span><span class="s2">returnedFn</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">client</span><span class="s0">?</span><span class="s2">fn</span><span class="s0">:</span><span class="s1">function </span><span class="s2">anonymous</span><span class="s0">(</span><span class="s2">data</span><span class="s0">){</span><span class="s1">var </span><span class="s2">include</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">includeData</span><span class="s0">){</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">shallowCopy</span><span class="s0">(</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">createNullProtoObjWherePossible</span><span class="s0">(),</span><span class="s2">data</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">includeData</span><span class="s0">){</span><span class="s2">d</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">shallowCopy</span><span class="s0">(</span><span class="s2">d</span><span class="s0">,</span><span class="s2">includeData</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">includeFile</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">opts</span><span class="s0">)(</span><span class="s2">d</span><span class="s0">)};</span><span class="s1">return </span><span class="s2">fn</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">context</span><span class="s0">,[</span><span class="s2">data</span><span class="s0">||</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">createNullProtoObjWherePossible</span><span class="s0">(),</span><span class="s2">escapeFn</span><span class="s0">,</span><span class="s2">include</span><span class="s0">,</span><span class="s2">rethrow</span><span class="s0">])};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">&amp;&amp;</span><span class="s1">typeof </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">===</span><span class="s3">&quot;function&quot;</span><span class="s0">){</span><span class="s1">var </span><span class="s2">filename</span><span class="s0">=</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">filename</span><span class="s0">;</span><span class="s1">var </span><span class="s2">basename</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">basename</span><span class="s0">(</span><span class="s2">filename</span><span class="s0">,</span><span class="s2">path</span><span class="s0">.</span><span class="s2">extname</span><span class="s0">(</span><span class="s2">filename</span><span class="s0">));</span><span class="s1">try</span><span class="s0">{</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">returnedFn</span><span class="s0">,</span><span class="s3">&quot;name&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">basename</span><span class="s0">,</span><span class="s2">writable</span><span class="s0">:</span><span class="s1">false</span><span class="s0">,</span><span class="s2">enumerable</span><span class="s0">:</span><span class="s1">false</span><span class="s0">,</span><span class="s2">configurable</span><span class="s0">:</span><span class="s1">true</span><span class="s0">})}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){}}</span><span class="s1">return </span><span class="s2">returnedFn</span><span class="s0">},</span><span class="s2">generateSource</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">opts</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">rmWhitespace</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">templateText</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">templateText</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/[\r\n]+/g</span><span class="s0">,</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/^\s+|\s+$/gm</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)}</span><span class="s1">this</span><span class="s0">.</span><span class="s2">templateText</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">templateText</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/[ \t]*&lt;%_/gm</span><span class="s0">,</span><span class="s3">&quot;&lt;%_&quot;</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/_%&gt;[ \t]*/gm</span><span class="s0">,</span><span class="s3">&quot;_%&gt;&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">self</span><span class="s0">=</span><span class="s1">this</span><span class="s0">;</span><span class="s1">var </span><span class="s2">matches</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">parseTemplateText</span><span class="s0">();</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">;</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">openDelimiter</span><span class="s0">;</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">closeDelimiter</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">matches</span><span class="s0">&amp;&amp;</span><span class="s2">matches</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s2">matches</span><span class="s0">.</span><span class="s2">forEach</span><span class="s0">(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">line</span><span class="s0">,</span><span class="s2">index</span><span class="s0">){</span><span class="s1">var </span><span class="s2">closing</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">line</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">)===</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">line</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s2">d</span><span class="s0">)!==</span><span class="s4">0</span><span class="s0">){</span><span class="s2">closing</span><span class="s0">=</span><span class="s2">matches</span><span class="s0">[</span><span class="s2">index</span><span class="s0">+</span><span class="s4">2</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(!(</span><span class="s2">closing</span><span class="s0">==</span><span class="s2">d</span><span class="s0">+</span><span class="s2">c</span><span class="s0">||</span><span class="s2">closing</span><span class="s0">==</span><span class="s3">&quot;-&quot;</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s2">c</span><span class="s0">||</span><span class="s2">closing</span><span class="s0">==</span><span class="s3">&quot;_&quot;</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s2">c</span><span class="s0">)){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not find matching close tag for &quot;'</span><span class="s0">+</span><span class="s2">line</span><span class="s0">+</span><span class="s3">'&quot;.'</span><span class="s0">)}}</span><span class="s2">self</span><span class="s0">.</span><span class="s2">scanLine</span><span class="s0">(</span><span class="s2">line</span><span class="s0">)})}},</span><span class="s2">parseTemplateText</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">str</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">templateText</span><span class="s0">;</span><span class="s1">var </span><span class="s2">pat</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">;</span><span class="s1">var </span><span class="s2">result</span><span class="s0">=</span><span class="s2">pat</span><span class="s0">.</span><span class="s2">exec</span><span class="s0">(</span><span class="s2">str</span><span class="s0">);</span><span class="s1">var </span><span class="s2">arr</span><span class="s0">=[];</span><span class="s1">var </span><span class="s2">firstPos</span><span class="s0">;</span><span class="s1">while</span><span class="s0">(</span><span class="s2">result</span><span class="s0">){</span><span class="s2">firstPos</span><span class="s0">=</span><span class="s2">result</span><span class="s0">.</span><span class="s2">index</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">firstPos</span><span class="s0">!==</span><span class="s4">0</span><span class="s0">){</span><span class="s2">arr</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">str</span><span class="s0">.</span><span class="s2">substring</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">firstPos</span><span class="s0">));</span><span class="s2">str</span><span class="s0">=</span><span class="s2">str</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">firstPos</span><span class="s0">)}</span><span class="s2">arr</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">result</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]);</span><span class="s2">str</span><span class="s0">=</span><span class="s2">str</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">result</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">length</span><span class="s0">);</span><span class="s2">result</span><span class="s0">=</span><span class="s2">pat</span><span class="s0">.</span><span class="s2">exec</span><span class="s0">(</span><span class="s2">str</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">str</span><span class="s0">){</span><span class="s2">arr</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">str</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">arr</span><span class="s0">},</span><span class="s2">_addOutput</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">line</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">){</span><span class="s2">line</span><span class="s0">=</span><span class="s2">line</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/^(?:\r\n|\r|\n)/</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">=</span><span class="s1">false</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">line</span><span class="s0">){</span><span class="s1">return </span><span class="s2">line</span><span class="s0">}</span><span class="s2">line</span><span class="s0">=</span><span class="s2">line</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/\\/g</span><span class="s0">,</span><span class="s3">&quot;</span><span class="s1">\\\\</span><span class="s3">&quot;</span><span class="s0">);</span><span class="s2">line</span><span class="s0">=</span><span class="s2">line</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/\n/g</span><span class="s0">,</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">n&quot;</span><span class="s0">);</span><span class="s2">line</span><span class="s0">=</span><span class="s2">line</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/\r/g</span><span class="s0">,</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">r&quot;</span><span class="s0">);</span><span class="s2">line</span><span class="s0">=</span><span class="s2">line</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/&quot;/g</span><span class="s0">,</span><span class="s3">'</span><span class="s1">\\</span><span class="s3">&quot;'</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">+=</span><span class="s3">'    ; __append(&quot;'</span><span class="s0">+</span><span class="s2">line</span><span class="s0">+</span><span class="s3">'&quot;)'</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">},</span><span class="s2">scanLine</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">line</span><span class="s0">){</span><span class="s1">var </span><span class="s2">self</span><span class="s0">=</span><span class="s1">this</span><span class="s0">;</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">;</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">openDelimiter</span><span class="s0">;</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">closeDelimiter</span><span class="s0">;</span><span class="s1">var </span><span class="s2">newLineCount</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">newLineCount</span><span class="s0">=</span><span class="s2">line</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">).</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">line</span><span class="s0">){</span><span class="s1">case </span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">:</span><span class="s1">case </span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s3">&quot;_&quot;</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">EVAL</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s3">&quot;=&quot;</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ESCAPED</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s3">&quot;-&quot;</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">RAW</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s3">&quot;#&quot;</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">COMMENT</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s2">d</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">LITERAL</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">+=</span><span class="s3">'    ; __append(&quot;'</span><span class="s0">+</span><span class="s2">line</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s2">d</span><span class="s0">,</span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">)+</span><span class="s3">'&quot;)'</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">d</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s2">c</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">LITERAL</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">+=</span><span class="s3">'    ; __append(&quot;'</span><span class="s0">+</span><span class="s2">line</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">d</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s2">c</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+</span><span class="s2">c</span><span class="s0">)+</span><span class="s3">'&quot;)'</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">d</span><span class="s0">+</span><span class="s2">c</span><span class="s0">:</span><span class="s1">case</span><span class="s3">&quot;-&quot;</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s2">c</span><span class="s0">:</span><span class="s1">case</span><span class="s3">&quot;_&quot;</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s2">c</span><span class="s0">:</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">==</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">LITERAL</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_addOutput</span><span class="s0">(</span><span class="s2">line</span><span class="s0">)}</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">=</span><span class="s2">line</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;-&quot;</span><span class="s0">)===</span><span class="s4">0</span><span class="s0">||</span><span class="s2">line</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;_&quot;</span><span class="s0">)===</span><span class="s4">0</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">){</span><span class="s1">switch</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">){</span><span class="s1">case </span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">EVAL</span><span class="s0">:</span><span class="s1">case </span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ESCAPED</span><span class="s0">:</span><span class="s1">case </span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">RAW</span><span class="s0">:</span><span class="s1">if</span><span class="s0">(</span><span class="s2">line</span><span class="s0">.</span><span class="s2">lastIndexOf</span><span class="s0">(</span><span class="s3">&quot;//&quot;</span><span class="s0">)&gt;</span><span class="s2">line</span><span class="s0">.</span><span class="s2">lastIndexOf</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">)){</span><span class="s2">line</span><span class="s0">+=</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">}}</span><span class="s1">switch</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">){</span><span class="s1">case </span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">EVAL</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">+=</span><span class="s3">&quot;    ; &quot;</span><span class="s0">+</span><span class="s2">line</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ESCAPED</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">+=</span><span class="s3">&quot;    ; __append(escapeFn(&quot;</span><span class="s0">+</span><span class="s2">stripSemi</span><span class="s0">(</span><span class="s2">line</span><span class="s0">)+</span><span class="s3">&quot;))&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">RAW</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">+=</span><span class="s3">&quot;    ; __append(&quot;</span><span class="s0">+</span><span class="s2">stripSemi</span><span class="s0">(</span><span class="s2">line</span><span class="s0">)+</span><span class="s3">&quot;)&quot;</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">COMMENT</span><span class="s0">:</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">Template</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">LITERAL</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_addOutput</span><span class="s0">(</span><span class="s2">line</span><span class="s0">);</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_addOutput</span><span class="s0">(</span><span class="s2">line</span><span class="s0">)}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">self</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">compileDebug</span><span class="s0">&amp;&amp;</span><span class="s2">newLineCount</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">currentLine</span><span class="s0">+=</span><span class="s2">newLineCount</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">+=</span><span class="s3">&quot;    ; __line = &quot;</span><span class="s0">+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">currentLine</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">}}};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">escapeXML</span><span class="s0">=</span><span class="s2">utils</span><span class="s0">.</span><span class="s2">escapeXML</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">__express</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">renderFile</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">VERSION</span><span class="s0">=</span><span class="s2">_VERSION_STRING</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">_NAME</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">window</span><span class="s0">!=</span><span class="s3">&quot;undefined&quot;</span><span class="s0">){</span><span class="s2">window</span><span class="s0">.</span><span class="s2">ejs</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">}},{</span><span class="s3">&quot;../package.json&quot;</span><span class="s0">:</span><span class="s4">6</span><span class="s0">,</span><span class="s3">&quot;./utils&quot;</span><span class="s0">:</span><span class="s4">2</span><span class="s0">,</span><span class="s2">fs</span><span class="s0">:</span><span class="s4">3</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s4">4</span><span class="s0">}],</span><span class="s4">2</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">regExpChars</span><span class="s0">=</span><span class="s5">/[|\\{}()[\]^$+*?.]/g</span><span class="s0">;</span><span class="s1">var </span><span class="s2">hasOwnProperty</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">hasOwnProperty</span><span class="s0">;</span><span class="s1">var </span><span class="s2">hasOwn</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">obj</span><span class="s0">,</span><span class="s2">key</span><span class="s0">){</span><span class="s1">return </span><span class="s2">hasOwnProperty</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s2">obj</span><span class="s0">,[</span><span class="s2">key</span><span class="s0">])};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">escapeRegExpChars</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">string</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">string</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;&quot;</span><span class="s0">}</span><span class="s1">return </span><span class="s2">String</span><span class="s0">(</span><span class="s2">string</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">regExpChars</span><span class="s0">,</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">$&amp;&quot;</span><span class="s0">)};</span><span class="s1">var </span><span class="s2">_ENCODE_HTML_RULES</span><span class="s0">={</span><span class="s3">&quot;&amp;&quot;</span><span class="s0">:</span><span class="s3">&quot;&amp;amp;&quot;</span><span class="s0">,</span><span class="s3">&quot;&lt;&quot;</span><span class="s0">:</span><span class="s3">&quot;&amp;lt;&quot;</span><span class="s0">,</span><span class="s3">&quot;&gt;&quot;</span><span class="s0">:</span><span class="s3">&quot;&amp;gt;&quot;</span><span class="s0">,</span><span class="s3">'&quot;'</span><span class="s0">:</span><span class="s3">&quot;&amp;#34;&quot;</span><span class="s0">,</span><span class="s3">&quot;'&quot;</span><span class="s0">:</span><span class="s3">&quot;&amp;#39;&quot;</span><span class="s0">};</span><span class="s1">var </span><span class="s2">_MATCH_HTML</span><span class="s0">=</span><span class="s5">/[&amp;&lt;&gt;'&quot;]/g</span><span class="s0">;</span><span class="s1">function </span><span class="s2">encode_char</span><span class="s0">(</span><span class="s2">c</span><span class="s0">){</span><span class="s1">return </span><span class="s2">_ENCODE_HTML_RULES</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]||</span><span class="s2">c</span><span class="s0">}</span><span class="s1">var </span><span class="s2">escapeFuncStr</span><span class="s0">=</span><span class="s3">&quot;var _ENCODE_HTML_RULES = {</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">'      &quot;&amp;&quot;: &quot;&amp;amp;&quot;</span><span class="s1">\n</span><span class="s3">'</span><span class="s0">+</span><span class="s3">'    , &quot;&lt;&quot;: &quot;&amp;lt;&quot;</span><span class="s1">\n</span><span class="s3">'</span><span class="s0">+</span><span class="s3">'    , &quot;&gt;&quot;: &quot;&amp;gt;&quot;</span><span class="s1">\n</span><span class="s3">'</span><span class="s0">+</span><span class="s3">'    , </span><span class="s1">\'</span><span class="s3">&quot;</span><span class="s1">\'</span><span class="s3">: &quot;&amp;#34;&quot;</span><span class="s1">\n</span><span class="s3">'</span><span class="s0">+</span><span class="s3">'    , &quot;</span><span class="s1">\'</span><span class="s3">&quot;: &quot;&amp;#39;&quot;</span><span class="s1">\n</span><span class="s3">'</span><span class="s0">+</span><span class="s3">&quot;    }</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">&quot;  , _MATCH_HTML = /[&amp;&lt;&gt;'</span><span class="s1">\&quot;</span><span class="s3">]/g;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">&quot;function encode_char(c) {</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">&quot;  return _ENCODE_HTML_RULES[c] || c;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s3">&quot;};</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">escapeXML</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">markup</span><span class="s0">){</span><span class="s1">return </span><span class="s2">markup</span><span class="s0">==</span><span class="s2">undefined</span><span class="s0">?</span><span class="s3">&quot;&quot;</span><span class="s0">:</span><span class="s2">String</span><span class="s0">(</span><span class="s2">markup</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">_MATCH_HTML</span><span class="s0">,</span><span class="s2">encode_char</span><span class="s0">)};</span><span class="s1">function </span><span class="s2">escapeXMLToString</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">Function</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">)+</span><span class="s3">&quot;;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s2">escapeFuncStr</span><span class="s0">}</span><span class="s1">try</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">===</span><span class="s3">&quot;function&quot;</span><span class="s0">){</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">escapeXML</span><span class="s0">,</span><span class="s3">&quot;toString&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">escapeXMLToString</span><span class="s0">})}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">escapeXML</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">=</span><span class="s2">escapeXMLToString</span><span class="s0">}}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">err</span><span class="s0">){</span><span class="s2">console</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s3">&quot;Unable to set escapeXML.toString (is the Function prototype frozen?)&quot;</span><span class="s0">)}</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">shallowCopy</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">to</span><span class="s0">,</span><span class="s2">from</span><span class="s0">){</span><span class="s2">from</span><span class="s0">=</span><span class="s2">from</span><span class="s0">||{};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">to</span><span class="s0">!==</span><span class="s1">null</span><span class="s0">&amp;&amp;</span><span class="s2">to</span><span class="s0">!==</span><span class="s2">undefined</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">p </span><span class="s1">in </span><span class="s2">from</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">hasOwn</span><span class="s0">(</span><span class="s2">from</span><span class="s0">,</span><span class="s2">p</span><span class="s0">)){</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">p</span><span class="s0">===</span><span class="s3">&quot;__proto__&quot;</span><span class="s0">||</span><span class="s2">p</span><span class="s0">===</span><span class="s3">&quot;constructor&quot;</span><span class="s0">){</span><span class="s1">continue</span><span class="s0">}</span><span class="s2">to</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]=</span><span class="s2">from</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]}}</span><span class="s1">return </span><span class="s2">to</span><span class="s0">};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">shallowCopyFromList</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">to</span><span class="s0">,</span><span class="s2">from</span><span class="s0">,</span><span class="s2">list</span><span class="s0">){</span><span class="s2">list</span><span class="s0">=</span><span class="s2">list</span><span class="s0">||[];</span><span class="s2">from</span><span class="s0">=</span><span class="s2">from</span><span class="s0">||{};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">to</span><span class="s0">!==</span><span class="s1">null</span><span class="s0">&amp;&amp;</span><span class="s2">to</span><span class="s0">!==</span><span class="s2">undefined</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">list</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">i</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">list</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">from</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]!=</span><span class="s3">&quot;undefined&quot;</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">hasOwn</span><span class="s0">(</span><span class="s2">from</span><span class="s0">,</span><span class="s2">p</span><span class="s0">)){</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">p</span><span class="s0">===</span><span class="s3">&quot;__proto__&quot;</span><span class="s0">||</span><span class="s2">p</span><span class="s0">===</span><span class="s3">&quot;constructor&quot;</span><span class="s0">){</span><span class="s1">continue</span><span class="s0">}</span><span class="s2">to</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]=</span><span class="s2">from</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]}}}</span><span class="s1">return </span><span class="s2">to</span><span class="s0">};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">={</span><span class="s2">_data</span><span class="s0">:{},</span><span class="s2">set</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">key</span><span class="s0">,</span><span class="s2">val</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_data</span><span class="s0">[</span><span class="s2">key</span><span class="s0">]=</span><span class="s2">val</span><span class="s0">},</span><span class="s2">get</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">key</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_data</span><span class="s0">[</span><span class="s2">key</span><span class="s0">]},</span><span class="s2">remove</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">key</span><span class="s0">){</span><span class="s1">delete this</span><span class="s0">.</span><span class="s2">_data</span><span class="s0">[</span><span class="s2">key</span><span class="s0">]},</span><span class="s2">reset</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_data</span><span class="s0">={}}};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">hyphenToCamel</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">str</span><span class="s0">){</span><span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/-[a-z]/g</span><span class="s0">,</span><span class="s1">function</span><span class="s0">(</span><span class="s2">match</span><span class="s0">){</span><span class="s1">return </span><span class="s2">match</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">toUpperCase</span><span class="s0">()})};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">createNullProtoObjWherePossible</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">==</span><span class="s3">&quot;function&quot;</span><span class="s0">){</span><span class="s1">return function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s1">null</span><span class="s0">)}}</span><span class="s1">if</span><span class="s0">(!({</span><span class="s2">__proto__</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}</span><span class="s1">instanceof </span><span class="s2">Object</span><span class="s0">)){</span><span class="s1">return function</span><span class="s0">(){</span><span class="s1">return</span><span class="s0">{</span><span class="s2">__proto__</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}}}</span><span class="s1">return function</span><span class="s0">(){</span><span class="s1">return</span><span class="s0">{}}}();</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">hasOwnOnlyObject</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">obj</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">createNullProtoObjWherePossible</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">p </span><span class="s1">in </span><span class="s2">obj</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">hasOwn</span><span class="s0">(</span><span class="s2">obj</span><span class="s0">,</span><span class="s2">p</span><span class="s0">)){</span><span class="s2">o</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]=</span><span class="s2">obj</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]}}</span><span class="s1">return </span><span class="s2">o</span><span class="s0">}},{}],</span><span class="s4">3</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){},{}],</span><span class="s4">4</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">process</span><span class="s0">){</span><span class="s1">function </span><span class="s2">normalizeArray</span><span class="s0">(</span><span class="s2">parts</span><span class="s0">,</span><span class="s2">allowAboveRoot</span><span class="s0">){</span><span class="s1">var </span><span class="s2">up</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">parts</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">--){</span><span class="s1">var </span><span class="s2">last</span><span class="s0">=</span><span class="s2">parts</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">last</span><span class="s0">===</span><span class="s3">&quot;.&quot;</span><span class="s0">){</span><span class="s2">parts</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s4">1</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">last</span><span class="s0">===</span><span class="s3">&quot;..&quot;</span><span class="s0">){</span><span class="s2">parts</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s4">1</span><span class="s0">);</span><span class="s2">up</span><span class="s0">++}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">up</span><span class="s0">){</span><span class="s2">parts</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s4">1</span><span class="s0">);</span><span class="s2">up</span><span class="s0">--}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">allowAboveRoot</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">up</span><span class="s0">--;</span><span class="s2">up</span><span class="s0">){</span><span class="s2">parts</span><span class="s0">.</span><span class="s2">unshift</span><span class="s0">(</span><span class="s3">&quot;..&quot;</span><span class="s0">)}}</span><span class="s1">return </span><span class="s2">parts</span><span class="s0">}</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">resolvedPath</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">resolvedAbsolute</span><span class="s0">=</span><span class="s1">false</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;=-</span><span class="s4">1</span><span class="s0">&amp;&amp;!</span><span class="s2">resolvedAbsolute</span><span class="s0">;</span><span class="s2">i</span><span class="s0">--){</span><span class="s1">var </span><span class="s2">path</span><span class="s0">=</span><span class="s2">i</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]:</span><span class="s2">process</span><span class="s0">.</span><span class="s2">cwd</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">path</span><span class="s0">!==</span><span class="s3">&quot;string&quot;</span><span class="s0">){</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">&quot;Arguments to path.resolve must be strings&quot;</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(!</span><span class="s2">path</span><span class="s0">){</span><span class="s1">continue</span><span class="s0">}</span><span class="s2">resolvedPath</span><span class="s0">=</span><span class="s2">path</span><span class="s0">+</span><span class="s3">&quot;/&quot;</span><span class="s0">+</span><span class="s2">resolvedPath</span><span class="s0">;</span><span class="s2">resolvedAbsolute</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)===</span><span class="s3">&quot;/&quot;</span><span class="s0">}</span><span class="s2">resolvedPath</span><span class="s0">=</span><span class="s2">normalizeArray</span><span class="s0">(</span><span class="s2">filter</span><span class="s0">(</span><span class="s2">resolvedPath</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">),</span><span class="s1">function</span><span class="s0">(</span><span class="s2">p</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!!</span><span class="s2">p</span><span class="s0">}),!</span><span class="s2">resolvedAbsolute</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">);</span><span class="s1">return</span><span class="s0">(</span><span class="s2">resolvedAbsolute</span><span class="s0">?</span><span class="s3">&quot;/&quot;</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">)+</span><span class="s2">resolvedPath</span><span class="s0">||</span><span class="s3">&quot;.&quot;</span><span class="s0">};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">normalize</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">path</span><span class="s0">){</span><span class="s1">var </span><span class="s2">isAbsolute</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">isAbsolute</span><span class="s0">(</span><span class="s2">path</span><span class="s0">),</span><span class="s2">trailingSlash</span><span class="s0">=</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">)===</span><span class="s3">&quot;/&quot;</span><span class="s0">;</span><span class="s2">path</span><span class="s0">=</span><span class="s2">normalizeArray</span><span class="s0">(</span><span class="s2">filter</span><span class="s0">(</span><span class="s2">path</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">),</span><span class="s1">function</span><span class="s0">(</span><span class="s2">p</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!!</span><span class="s2">p</span><span class="s0">}),!</span><span class="s2">isAbsolute</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">path</span><span class="s0">&amp;&amp;!</span><span class="s2">isAbsolute</span><span class="s0">){</span><span class="s2">path</span><span class="s0">=</span><span class="s3">&quot;.&quot;</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">path</span><span class="s0">&amp;&amp;</span><span class="s2">trailingSlash</span><span class="s0">){</span><span class="s2">path</span><span class="s0">+=</span><span class="s3">&quot;/&quot;</span><span class="s0">}</span><span class="s1">return</span><span class="s0">(</span><span class="s2">isAbsolute</span><span class="s0">?</span><span class="s3">&quot;/&quot;</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">)+</span><span class="s2">path</span><span class="s0">};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">isAbsolute</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">path</span><span class="s0">){</span><span class="s1">return </span><span class="s2">path</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)===</span><span class="s3">&quot;/&quot;</span><span class="s0">};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">join</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">paths</span><span class="s0">=</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">arguments</span><span class="s0">,</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return </span><span class="s2">exports</span><span class="s0">.</span><span class="s2">normalize</span><span class="s0">(</span><span class="s2">filter</span><span class="s0">(</span><span class="s2">paths</span><span class="s0">,</span><span class="s1">function</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s2">index</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">p</span><span class="s0">!==</span><span class="s3">&quot;string&quot;</span><span class="s0">){</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">&quot;Arguments to path.join must be strings&quot;</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">p</span><span class="s0">}).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">))};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">relative</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">from</span><span class="s0">,</span><span class="s2">to</span><span class="s0">){</span><span class="s2">from</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">from</span><span class="s0">).</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s2">to</span><span class="s0">=</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">to</span><span class="s0">).</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">function </span><span class="s2">trim</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">){</span><span class="s1">var </span><span class="s2">start</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">start</span><span class="s0">&lt;</span><span class="s2">arr</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">start</span><span class="s0">++){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">[</span><span class="s2">start</span><span class="s0">]!==</span><span class="s3">&quot;&quot;</span><span class="s0">)</span><span class="s1">break</span><span class="s0">}</span><span class="s1">var </span><span class="s2">end</span><span class="s0">=</span><span class="s2">arr</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">end</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">end</span><span class="s0">--){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">[</span><span class="s2">end</span><span class="s0">]!==</span><span class="s3">&quot;&quot;</span><span class="s0">)</span><span class="s1">break</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">start</span><span class="s0">&gt;</span><span class="s2">end</span><span class="s0">)</span><span class="s1">return</span><span class="s0">[];</span><span class="s1">return </span><span class="s2">arr</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">start</span><span class="s0">,</span><span class="s2">end</span><span class="s0">-</span><span class="s2">start</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)}</span><span class="s1">var </span><span class="s2">fromParts</span><span class="s0">=</span><span class="s2">trim</span><span class="s0">(</span><span class="s2">from</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">));</span><span class="s1">var </span><span class="s2">toParts</span><span class="s0">=</span><span class="s2">trim</span><span class="s0">(</span><span class="s2">to</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">));</span><span class="s1">var </span><span class="s2">length</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s2">fromParts</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">toParts</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span><span class="s1">var </span><span class="s2">samePartsLength</span><span class="s0">=</span><span class="s2">length</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">length</span><span class="s0">;</span><span class="s2">i</span><span class="s0">++){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">fromParts</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]!==</span><span class="s2">toParts</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]){</span><span class="s2">samePartsLength</span><span class="s0">=</span><span class="s2">i</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">var </span><span class="s2">outputParts</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">samePartsLength</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">fromParts</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">i</span><span class="s0">++){</span><span class="s2">outputParts</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;..&quot;</span><span class="s0">)}</span><span class="s2">outputParts</span><span class="s0">=</span><span class="s2">outputParts</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">toParts</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">samePartsLength</span><span class="s0">));</span><span class="s1">return </span><span class="s2">outputParts</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">)};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">sep</span><span class="s0">=</span><span class="s3">&quot;/&quot;</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">=</span><span class="s3">&quot;:&quot;</span><span class="s0">;</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">dirname</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">path</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">path</span><span class="s0">!==</span><span class="s3">&quot;string&quot;</span><span class="s0">)</span><span class="s2">path</span><span class="s0">=</span><span class="s2">path</span><span class="s0">+</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">===</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return</span><span class="s3">&quot;.&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">code</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">hasRoot</span><span class="s0">=</span><span class="s2">code</span><span class="s0">===</span><span class="s4">47</span><span class="s0">;</span><span class="s1">var </span><span class="s2">end</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">var </span><span class="s2">matchedSlash</span><span class="s0">=</span><span class="s1">true</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;=</span><span class="s4">1</span><span class="s0">;--</span><span class="s2">i</span><span class="s0">){</span><span class="s2">code</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">code</span><span class="s0">===</span><span class="s4">47</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">matchedSlash</span><span class="s0">){</span><span class="s2">end</span><span class="s0">=</span><span class="s2">i</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">matchedSlash</span><span class="s0">=</span><span class="s1">false</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">end</span><span class="s0">===-</span><span class="s4">1</span><span class="s0">)</span><span class="s1">return </span><span class="s2">hasRoot</span><span class="s0">?</span><span class="s3">&quot;/&quot;</span><span class="s0">:</span><span class="s3">&quot;.&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">hasRoot</span><span class="s0">&amp;&amp;</span><span class="s2">end</span><span class="s0">===</span><span class="s4">1</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;/&quot;</span><span class="s0">}</span><span class="s1">return </span><span class="s2">path</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">end</span><span class="s0">)};</span><span class="s1">function </span><span class="s2">basename</span><span class="s0">(</span><span class="s2">path</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">path</span><span class="s0">!==</span><span class="s3">&quot;string&quot;</span><span class="s0">)</span><span class="s2">path</span><span class="s0">=</span><span class="s2">path</span><span class="s0">+</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">start</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">var </span><span class="s2">end</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">var </span><span class="s2">matchedSlash</span><span class="s0">=</span><span class="s1">true</span><span class="s0">;</span><span class="s1">var </span><span class="s2">i</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">i</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">path</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)===</span><span class="s4">47</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">matchedSlash</span><span class="s0">){</span><span class="s2">start</span><span class="s0">=</span><span class="s2">i</span><span class="s0">+</span><span class="s4">1</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">end</span><span class="s0">===-</span><span class="s4">1</span><span class="s0">){</span><span class="s2">matchedSlash</span><span class="s0">=</span><span class="s1">false</span><span class="s0">;</span><span class="s2">end</span><span class="s0">=</span><span class="s2">i</span><span class="s0">+</span><span class="s4">1</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">end</span><span class="s0">===-</span><span class="s4">1</span><span class="s0">)</span><span class="s1">return</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">return </span><span class="s2">path</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">start</span><span class="s0">,</span><span class="s2">end</span><span class="s0">)}</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">basename</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">path</span><span class="s0">,</span><span class="s2">ext</span><span class="s0">){</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">basename</span><span class="s0">(</span><span class="s2">path</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">ext</span><span class="s0">&amp;&amp;</span><span class="s2">f</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">*</span><span class="s2">ext</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)===</span><span class="s2">ext</span><span class="s0">){</span><span class="s2">f</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s2">ext</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">f</span><span class="s0">};</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">extname</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">path</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">path</span><span class="s0">!==</span><span class="s3">&quot;string&quot;</span><span class="s0">)</span><span class="s2">path</span><span class="s0">=</span><span class="s2">path</span><span class="s0">+</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">startDot</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">var </span><span class="s2">startPart</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">var </span><span class="s2">end</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">var </span><span class="s2">matchedSlash</span><span class="s0">=</span><span class="s1">true</span><span class="s0">;</span><span class="s1">var </span><span class="s2">preDotState</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">i</span><span class="s0">){</span><span class="s1">var </span><span class="s2">code</span><span class="s0">=</span><span class="s2">path</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">code</span><span class="s0">===</span><span class="s4">47</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">matchedSlash</span><span class="s0">){</span><span class="s2">startPart</span><span class="s0">=</span><span class="s2">i</span><span class="s0">+</span><span class="s4">1</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">end</span><span class="s0">===-</span><span class="s4">1</span><span class="s0">){</span><span class="s2">matchedSlash</span><span class="s0">=</span><span class="s1">false</span><span class="s0">;</span><span class="s2">end</span><span class="s0">=</span><span class="s2">i</span><span class="s0">+</span><span class="s4">1</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">code</span><span class="s0">===</span><span class="s4">46</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">startDot</span><span class="s0">===-</span><span class="s4">1</span><span class="s0">)</span><span class="s2">startDot</span><span class="s0">=</span><span class="s2">i</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">preDotState</span><span class="s0">!==</span><span class="s4">1</span><span class="s0">)</span><span class="s2">preDotState</span><span class="s0">=</span><span class="s4">1</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">startDot</span><span class="s0">!==-</span><span class="s4">1</span><span class="s0">){</span><span class="s2">preDotState</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">startDot</span><span class="s0">===-</span><span class="s4">1</span><span class="s0">||</span><span class="s2">end</span><span class="s0">===-</span><span class="s4">1</span><span class="s0">||</span><span class="s2">preDotState</span><span class="s0">===</span><span class="s4">0</span><span class="s0">||</span><span class="s2">preDotState</span><span class="s0">===</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s2">startDot</span><span class="s0">===</span><span class="s2">end</span><span class="s0">-</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s2">startDot</span><span class="s0">===</span><span class="s2">startPart</span><span class="s0">+</span><span class="s4">1</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;&quot;</span><span class="s0">}</span><span class="s1">return </span><span class="s2">path</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">startDot</span><span class="s0">,</span><span class="s2">end</span><span class="s0">)};</span><span class="s1">function </span><span class="s2">filter</span><span class="s0">(</span><span class="s2">xs</span><span class="s0">,</span><span class="s2">f</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">xs</span><span class="s0">.</span><span class="s2">filter</span><span class="s0">)</span><span class="s1">return </span><span class="s2">xs</span><span class="s0">.</span><span class="s2">filter</span><span class="s0">(</span><span class="s2">f</span><span class="s0">);</span><span class="s1">var </span><span class="s2">res</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">xs</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">i</span><span class="s0">++){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">f</span><span class="s0">(</span><span class="s2">xs</span><span class="s0">[</span><span class="s2">i</span><span class="s0">],</span><span class="s2">i</span><span class="s0">,</span><span class="s2">xs</span><span class="s0">))</span><span class="s2">res</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">xs</span><span class="s0">[</span><span class="s2">i</span><span class="s0">])}</span><span class="s1">return </span><span class="s2">res</span><span class="s0">}</span><span class="s1">var </span><span class="s2">substr</span><span class="s0">=</span><span class="s3">&quot;ab&quot;</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">)===</span><span class="s3">&quot;b&quot;</span><span class="s0">?</span><span class="s1">function</span><span class="s0">(</span><span class="s2">str</span><span class="s0">,</span><span class="s2">start</span><span class="s0">,</span><span class="s2">len</span><span class="s0">){</span><span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">start</span><span class="s0">,</span><span class="s2">len</span><span class="s0">)}:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">str</span><span class="s0">,</span><span class="s2">start</span><span class="s0">,</span><span class="s2">len</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">start</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">)</span><span class="s2">start</span><span class="s0">=</span><span class="s2">str</span><span class="s0">.</span><span class="s2">length</span><span class="s0">+</span><span class="s2">start</span><span class="s0">;</span><span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">start</span><span class="s0">,</span><span class="s2">len</span><span class="s0">)}}).</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">require</span><span class="s0">(</span><span class="s3">&quot;_process&quot;</span><span class="s0">))},{</span><span class="s2">_process</span><span class="s0">:</span><span class="s4">5</span><span class="s0">}],</span><span class="s4">5</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span><span class="s1">var </span><span class="s2">process</span><span class="s0">=</span><span class="s2">module</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">={};</span><span class="s1">var </span><span class="s2">cachedSetTimeout</span><span class="s0">;</span><span class="s1">var </span><span class="s2">cachedClearTimeout</span><span class="s0">;</span><span class="s1">function </span><span class="s2">defaultSetTimout</span><span class="s0">(){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;setTimeout has not been defined&quot;</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">defaultClearTimeout</span><span class="s0">(){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;clearTimeout has not been defined&quot;</span><span class="s0">)}(</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">try</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">setTimeout</span><span class="s0">===</span><span class="s3">&quot;function&quot;</span><span class="s0">){</span><span class="s2">cachedSetTimeout</span><span class="s0">=</span><span class="s2">setTimeout</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">cachedSetTimeout</span><span class="s0">=</span><span class="s2">defaultSetTimout</span><span class="s0">}}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">cachedSetTimeout</span><span class="s0">=</span><span class="s2">defaultSetTimout</span><span class="s0">}</span><span class="s1">try</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">clearTimeout</span><span class="s0">===</span><span class="s3">&quot;function&quot;</span><span class="s0">){</span><span class="s2">cachedClearTimeout</span><span class="s0">=</span><span class="s2">clearTimeout</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">cachedClearTimeout</span><span class="s0">=</span><span class="s2">defaultClearTimeout</span><span class="s0">}}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">cachedClearTimeout</span><span class="s0">=</span><span class="s2">defaultClearTimeout</span><span class="s0">}})();</span><span class="s1">function </span><span class="s2">runTimeout</span><span class="s0">(</span><span class="s2">fun</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">cachedSetTimeout</span><span class="s0">===</span><span class="s2">setTimeout</span><span class="s0">){</span><span class="s1">return </span><span class="s2">setTimeout</span><span class="s0">(</span><span class="s2">fun</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">((</span><span class="s2">cachedSetTimeout</span><span class="s0">===</span><span class="s2">defaultSetTimout</span><span class="s0">||!</span><span class="s2">cachedSetTimeout</span><span class="s0">)&amp;&amp;</span><span class="s2">setTimeout</span><span class="s0">){</span><span class="s2">cachedSetTimeout</span><span class="s0">=</span><span class="s2">setTimeout</span><span class="s0">;</span><span class="s1">return </span><span class="s2">setTimeout</span><span class="s0">(</span><span class="s2">fun</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return </span><span class="s2">cachedSetTimeout</span><span class="s0">(</span><span class="s2">fun</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return </span><span class="s2">cachedSetTimeout</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">fun</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">cachedSetTimeout</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">fun</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)}}}</span><span class="s1">function </span><span class="s2">runClearTimeout</span><span class="s0">(</span><span class="s2">marker</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">cachedClearTimeout</span><span class="s0">===</span><span class="s2">clearTimeout</span><span class="s0">){</span><span class="s1">return </span><span class="s2">clearTimeout</span><span class="s0">(</span><span class="s2">marker</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">((</span><span class="s2">cachedClearTimeout</span><span class="s0">===</span><span class="s2">defaultClearTimeout</span><span class="s0">||!</span><span class="s2">cachedClearTimeout</span><span class="s0">)&amp;&amp;</span><span class="s2">clearTimeout</span><span class="s0">){</span><span class="s2">cachedClearTimeout</span><span class="s0">=</span><span class="s2">clearTimeout</span><span class="s0">;</span><span class="s1">return </span><span class="s2">clearTimeout</span><span class="s0">(</span><span class="s2">marker</span><span class="s0">)}</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return </span><span class="s2">cachedClearTimeout</span><span class="s0">(</span><span class="s2">marker</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return </span><span class="s2">cachedClearTimeout</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">marker</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">cachedClearTimeout</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">marker</span><span class="s0">)}}}</span><span class="s1">var </span><span class="s2">queue</span><span class="s0">=[];</span><span class="s1">var </span><span class="s2">draining</span><span class="s0">=</span><span class="s1">false</span><span class="s0">;</span><span class="s1">var </span><span class="s2">currentQueue</span><span class="s0">;</span><span class="s1">var </span><span class="s2">queueIndex</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">function </span><span class="s2">cleanUpNextTick</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">draining</span><span class="s0">||!</span><span class="s2">currentQueue</span><span class="s0">){</span><span class="s1">return</span><span class="s0">}</span><span class="s2">draining</span><span class="s0">=</span><span class="s1">false</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">currentQueue</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s2">queue</span><span class="s0">=</span><span class="s2">currentQueue</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">queue</span><span class="s0">)}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">queueIndex</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">queue</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s2">drainQueue</span><span class="s0">()}}</span><span class="s1">function </span><span class="s2">drainQueue</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">draining</span><span class="s0">){</span><span class="s1">return</span><span class="s0">}</span><span class="s1">var </span><span class="s2">timeout</span><span class="s0">=</span><span class="s2">runTimeout</span><span class="s0">(</span><span class="s2">cleanUpNextTick</span><span class="s0">);</span><span class="s2">draining</span><span class="s0">=</span><span class="s1">true</span><span class="s0">;</span><span class="s1">var </span><span class="s2">len</span><span class="s0">=</span><span class="s2">queue</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s1">while</span><span class="s0">(</span><span class="s2">len</span><span class="s0">){</span><span class="s2">currentQueue</span><span class="s0">=</span><span class="s2">queue</span><span class="s0">;</span><span class="s2">queue</span><span class="s0">=[];</span><span class="s1">while</span><span class="s0">(++</span><span class="s2">queueIndex</span><span class="s0">&lt;</span><span class="s2">len</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">currentQueue</span><span class="s0">){</span><span class="s2">currentQueue</span><span class="s0">[</span><span class="s2">queueIndex</span><span class="s0">].</span><span class="s2">run</span><span class="s0">()}}</span><span class="s2">queueIndex</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">len</span><span class="s0">=</span><span class="s2">queue</span><span class="s0">.</span><span class="s2">length</span><span class="s0">}</span><span class="s2">currentQueue</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s2">draining</span><span class="s0">=</span><span class="s1">false</span><span class="s0">;</span><span class="s2">runClearTimeout</span><span class="s0">(</span><span class="s2">timeout</span><span class="s0">)}</span><span class="s2">process</span><span class="s0">.</span><span class="s2">nextTick</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">fun</span><span class="s0">){</span><span class="s1">var </span><span class="s2">args</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">i</span><span class="s0">++){</span><span class="s2">args</span><span class="s0">[</span><span class="s2">i</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]}}</span><span class="s2">queue</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s1">new </span><span class="s2">Item</span><span class="s0">(</span><span class="s2">fun</span><span class="s0">,</span><span class="s2">args</span><span class="s0">));</span><span class="s1">if</span><span class="s0">(</span><span class="s2">queue</span><span class="s0">.</span><span class="s2">length</span><span class="s0">===</span><span class="s4">1</span><span class="s0">&amp;&amp;!</span><span class="s2">draining</span><span class="s0">){</span><span class="s2">runTimeout</span><span class="s0">(</span><span class="s2">drainQueue</span><span class="s0">)}};</span><span class="s1">function </span><span class="s2">Item</span><span class="s0">(</span><span class="s2">fun</span><span class="s0">,</span><span class="s2">array</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">fun</span><span class="s0">=</span><span class="s2">fun</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">array</span><span class="s0">=</span><span class="s2">array</span><span class="s0">}</span><span class="s2">Item</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">run</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">fun</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">array</span><span class="s0">)};</span><span class="s2">process</span><span class="s0">.</span><span class="s2">title</span><span class="s0">=</span><span class="s3">&quot;browser&quot;</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">browser</span><span class="s0">=</span><span class="s1">true</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">env</span><span class="s0">={};</span><span class="s2">process</span><span class="s0">.</span><span class="s2">argv</span><span class="s0">=[];</span><span class="s2">process</span><span class="s0">.</span><span class="s2">version</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">versions</span><span class="s0">={};</span><span class="s1">function </span><span class="s2">noop</span><span class="s0">(){}</span><span class="s2">process</span><span class="s0">.</span><span class="s2">on</span><span class="s0">=</span><span class="s2">noop</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">addListener</span><span class="s0">=</span><span class="s2">noop</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">once</span><span class="s0">=</span><span class="s2">noop</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">off</span><span class="s0">=</span><span class="s2">noop</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">removeListener</span><span class="s0">=</span><span class="s2">noop</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">removeAllListeners</span><span class="s0">=</span><span class="s2">noop</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">emit</span><span class="s0">=</span><span class="s2">noop</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">prependListener</span><span class="s0">=</span><span class="s2">noop</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">prependOnceListener</span><span class="s0">=</span><span class="s2">noop</span><span class="s0">;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">listeners</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">name</span><span class="s0">){</span><span class="s1">return</span><span class="s0">[]};</span><span class="s2">process</span><span class="s0">.</span><span class="s2">binding</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">name</span><span class="s0">){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;process.binding is not supported&quot;</span><span class="s0">)};</span><span class="s2">process</span><span class="s0">.</span><span class="s2">cwd</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return</span><span class="s3">&quot;/&quot;</span><span class="s0">};</span><span class="s2">process</span><span class="s0">.</span><span class="s2">chdir</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">dir</span><span class="s0">){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;process.chdir is not supported&quot;</span><span class="s0">)};</span><span class="s2">process</span><span class="s0">.</span><span class="s2">umask</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s4">0</span><span class="s0">}},{}],</span><span class="s4">6</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span><span class="s2">module</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;ejs&quot;</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s3">&quot;Embedded JavaScript templates&quot;</span><span class="s0">,</span><span class="s2">keywords</span><span class="s0">:[</span><span class="s3">&quot;template&quot;</span><span class="s0">,</span><span class="s3">&quot;engine&quot;</span><span class="s0">,</span><span class="s3">&quot;ejs&quot;</span><span class="s0">],</span><span class="s2">version</span><span class="s0">:</span><span class="s3">&quot;3.1.9&quot;</span><span class="s0">,</span><span class="s2">author</span><span class="s0">:</span><span class="s3">&quot;Matthew Eernisse &lt;mde@fleegix.org&gt; (http://fleegix.org)&quot;</span><span class="s0">,</span><span class="s2">license</span><span class="s0">:</span><span class="s3">&quot;Apache-2.0&quot;</span><span class="s0">,</span><span class="s2">bin</span><span class="s0">:{</span><span class="s2">ejs</span><span class="s0">:</span><span class="s3">&quot;./bin/cli.js&quot;</span><span class="s0">},</span><span class="s2">main</span><span class="s0">:</span><span class="s3">&quot;./lib/ejs.js&quot;</span><span class="s0">,</span><span class="s2">jsdelivr</span><span class="s0">:</span><span class="s3">&quot;ejs.min.js&quot;</span><span class="s0">,</span><span class="s2">unpkg</span><span class="s0">:</span><span class="s3">&quot;ejs.min.js&quot;</span><span class="s0">,</span><span class="s2">repository</span><span class="s0">:{</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;git&quot;</span><span class="s0">,</span><span class="s2">url</span><span class="s0">:</span><span class="s3">&quot;git://github.com/mde/ejs.git&quot;</span><span class="s0">},</span><span class="s2">bugs</span><span class="s0">:</span><span class="s3">&quot;https://github.com/mde/ejs/issues&quot;</span><span class="s0">,</span><span class="s2">homepage</span><span class="s0">:</span><span class="s3">&quot;https://github.com/mde/ejs&quot;</span><span class="s0">,</span><span class="s2">dependencies</span><span class="s0">:{</span><span class="s2">jake</span><span class="s0">:</span><span class="s3">&quot;^10.8.5&quot;</span><span class="s0">},</span><span class="s2">devDependencies</span><span class="s0">:{</span><span class="s2">browserify</span><span class="s0">:</span><span class="s3">&quot;^16.5.1&quot;</span><span class="s0">,</span><span class="s2">eslint</span><span class="s0">:</span><span class="s3">&quot;^6.8.0&quot;</span><span class="s0">,</span><span class="s3">&quot;git-directory-deploy&quot;</span><span class="s0">:</span><span class="s3">&quot;^1.5.1&quot;</span><span class="s0">,</span><span class="s2">jsdoc</span><span class="s0">:</span><span class="s3">&quot;^4.0.2&quot;</span><span class="s0">,</span><span class="s3">&quot;lru-cache&quot;</span><span class="s0">:</span><span class="s3">&quot;^4.0.1&quot;</span><span class="s0">,</span><span class="s2">mocha</span><span class="s0">:</span><span class="s3">&quot;^10.2.0&quot;</span><span class="s0">,</span><span class="s3">&quot;uglify-js&quot;</span><span class="s0">:</span><span class="s3">&quot;^3.3.16&quot;</span><span class="s0">},</span><span class="s2">engines</span><span class="s0">:{</span><span class="s2">node</span><span class="s0">:</span><span class="s3">&quot;&gt;=0.10.0&quot;</span><span class="s0">},</span><span class="s2">scripts</span><span class="s0">:{</span><span class="s2">test</span><span class="s0">:</span><span class="s3">&quot;npx jake test&quot;</span><span class="s0">}}},{}]},{},[</span><span class="s4">1</span><span class="s0">])(</span><span class="s4">1</span><span class="s0">)});</span>
</pre>
</body>
</html>