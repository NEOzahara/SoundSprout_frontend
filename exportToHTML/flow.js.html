<html>
<head>
<title>flow.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #6aab73;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #cf8e6d;}
.s4 { color: #7a7e85;}
.s5 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
flow.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">defineProperty</span><span class="s1">(</span><span class="s2">exports</span><span class="s1">, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, {</span><span class="s2">value</span><span class="s1">: </span><span class="s3">true</span><span class="s1">});</span><span class="s4">/* eslint max-len: 0 */</span>










<span class="s3">var </span><span class="s2">_index </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'../tokenizer/index'</span><span class="s1">);</span>
<span class="s3">var </span><span class="s2">_keywords </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'../tokenizer/keywords'</span><span class="s1">);</span>
<span class="s3">var </span><span class="s2">_types </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'../tokenizer/types'</span><span class="s1">);</span>
<span class="s3">var </span><span class="s2">_base </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'../traverser/base'</span><span class="s1">);</span>













<span class="s3">var </span><span class="s2">_expression </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'../traverser/expression'</span><span class="s1">);</span>








<span class="s3">var </span><span class="s2">_statement </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'../traverser/statement'</span><span class="s1">);</span>









<span class="s3">var </span><span class="s2">_util </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'../traverser/util'</span><span class="s1">);</span>

<span class="s3">function </span><span class="s2">isMaybeDefaultImport</span><span class="s1">(</span><span class="s2">lookahead</span><span class="s1">) {</span>
  <span class="s3">return </span><span class="s1">(</span>
    <span class="s1">(</span><span class="s2">lookahead</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name </span><span class="s1">|| !!(</span><span class="s2">lookahead</span><span class="s1">.</span><span class="s2">type </span><span class="s1">&amp; </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">IS_KEYWORD</span><span class="s1">)) &amp;&amp;</span>
    <span class="s2">lookahead</span><span class="s1">.</span><span class="s2">contextualKeyword </span><span class="s1">!== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_from</span>
  <span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseTypeInitialiser</span><span class="s1">(</span><span class="s2">tok</span><span class="s1">) {</span>
  <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">0</span><span class="s1">);</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">tok </span><span class="s1">|| </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">);</span>
  <span class="s2">flowParseType</span><span class="s1">();</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParsePredicate</span><span class="s1">() {</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">modulo</span><span class="s1">);</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expectContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_checks</span><span class="s1">);</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">)) {</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseExpression</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">);</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseTypeAndPredicateInitialiser</span><span class="s1">() {</span>
  <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">0</span><span class="s1">);</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">);</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">modulo</span><span class="s1">)) {</span>
    <span class="s2">flowParsePredicate</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">flowParseType</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">modulo</span><span class="s1">)) {</span>
      <span class="s2">flowParsePredicate</span><span class="s1">();</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseDeclareClass</span><span class="s1">() {</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s2">flowParseInterfaceish</span><span class="s1">(</span><span class="s4">/* isClass */ </span><span class="s3">true</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseDeclareFunction</span><span class="s1">() {</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">();</span>
  <span class="s1">}</span>

  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">);</span>
  <span class="s2">flowParseFunctionTypeParams</span><span class="s1">();</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">);</span>

  <span class="s2">flowParseTypeAndPredicateInitialiser</span><span class="s1">();</span>

  <span class="s2">_util</span><span class="s1">.</span><span class="s2">semicolon</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseDeclare</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_class</span><span class="s1">)) {</span>
    <span class="s2">flowParseDeclareClass</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_function</span><span class="s1">)) {</span>
    <span class="s2">flowParseDeclareFunction</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_var</span><span class="s1">)) {</span>
    <span class="s2">flowParseDeclareVariable</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">eatContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_module</span><span class="s1">)) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">dot</span><span class="s1">)) {</span>
      <span class="s2">flowParseDeclareModuleExports</span><span class="s1">();</span>
    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
      <span class="s2">flowParseDeclareModule</span><span class="s1">();</span>
    <span class="s1">}</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type</span><span class="s1">)) {</span>
    <span class="s2">flowParseDeclareTypeAlias</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_opaque</span><span class="s1">)) {</span>
    <span class="s2">flowParseDeclareOpaqueType</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_interface</span><span class="s1">)) {</span>
    <span class="s2">flowParseDeclareInterface</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_export</span><span class="s1">)) {</span>
    <span class="s2">flowParseDeclareExportDeclaration</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">unexpected</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseDeclareVariable</span><span class="s1">() {</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s2">flowParseTypeAnnotatableIdentifier</span><span class="s1">();</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">semicolon</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseDeclareModule</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">string</span><span class="s1">)) {</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseExprAtom</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>

  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceL</span><span class="s1">);</span>
  <span class="s3">while </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceR</span><span class="s1">) &amp;&amp; !</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_import</span><span class="s1">)) {</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
      <span class="s2">_statement</span><span class="s1">.</span><span class="s2">parseImport</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">unexpected</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceR</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseDeclareExportDeclaration</span><span class="s1">() {</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_export</span><span class="s1">);</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_default</span><span class="s1">)) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_function</span><span class="s1">) || </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_class</span><span class="s1">)) {</span>
      <span class="s4">// declare export default class ...</span>
      <span class="s4">// declare export default function ...</span>
      <span class="s2">flowParseDeclare</span><span class="s1">();</span>
    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
      <span class="s4">// declare export default [type];</span>
      <span class="s2">flowParseType</span><span class="s1">();</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">semicolon</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s1">}</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_var</span><span class="s1">) || </span><span class="s4">// declare export var ...</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_function</span><span class="s1">) || </span><span class="s4">// declare export function ...</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_class</span><span class="s1">) || </span><span class="s4">// declare export class ...</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_opaque</span><span class="s1">) </span><span class="s4">// declare export opaque ..</span>
  <span class="s1">) {</span>
    <span class="s2">flowParseDeclare</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">star</span><span class="s1">) || </span><span class="s4">// declare export * from ''</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceL</span><span class="s1">) || </span><span class="s4">// declare export {} ...</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_interface</span><span class="s1">) || </span><span class="s4">// declare export interface ...</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type</span><span class="s1">) || </span><span class="s4">// declare export type ...</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_opaque</span><span class="s1">) </span><span class="s4">// declare export opaque type ...</span>
  <span class="s1">) {</span>
    <span class="s2">_statement</span><span class="s1">.</span><span class="s2">parseExport</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">unexpected</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseDeclareModuleExports</span><span class="s1">() {</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expectContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_exports</span><span class="s1">);</span>
  <span class="s2">flowParseTypeAnnotation</span><span class="s1">();</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">semicolon</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseDeclareTypeAlias</span><span class="s1">() {</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s2">flowParseTypeAlias</span><span class="s1">();</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseDeclareOpaqueType</span><span class="s1">() {</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s2">flowParseOpaqueType</span><span class="s1">(</span><span class="s3">true</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseDeclareInterface</span><span class="s1">() {</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s2">flowParseInterfaceish</span><span class="s1">();</span>
<span class="s1">}</span>

<span class="s4">// Interfaces</span>

<span class="s3">function </span><span class="s2">flowParseInterfaceish</span><span class="s1">(</span><span class="s2">isClass </span><span class="s1">= </span><span class="s3">false</span><span class="s1">) {</span>
  <span class="s2">flowParseRestrictedIdentifier</span><span class="s1">();</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">();</span>
  <span class="s1">}</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_extends</span><span class="s1">)) {</span>
    <span class="s3">do </span><span class="s1">{</span>
      <span class="s2">flowParseInterfaceExtends</span><span class="s1">();</span>
    <span class="s1">} </span><span class="s3">while </span><span class="s1">(!</span><span class="s2">isClass </span><span class="s1">&amp;&amp; </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">));</span>
  <span class="s1">}</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_mixins</span><span class="s1">)) {</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s3">do </span><span class="s1">{</span>
      <span class="s2">flowParseInterfaceExtends</span><span class="s1">();</span>
    <span class="s1">} </span><span class="s3">while </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">));</span>
  <span class="s1">}</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_implements</span><span class="s1">)) {</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s3">do </span><span class="s1">{</span>
      <span class="s2">flowParseInterfaceExtends</span><span class="s1">();</span>
    <span class="s1">} </span><span class="s3">while </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">));</span>
  <span class="s1">}</span>

  <span class="s2">flowParseObjectType</span><span class="s1">(</span><span class="s2">isClass</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s2">isClass</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseInterfaceExtends</span><span class="s1">() {</span>
  <span class="s2">flowParseQualifiedTypeIdentifier</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeParameterInstantiation</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseInterface</span><span class="s1">() {</span>
  <span class="s2">flowParseInterfaceish</span><span class="s1">();</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseRestrictedIdentifier</span><span class="s1">() {</span>
  <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseTypeAlias</span><span class="s1">() {</span>
  <span class="s2">flowParseRestrictedIdentifier</span><span class="s1">();</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">();</span>
  <span class="s1">}</span>

  <span class="s2">flowParseTypeInitialiser</span><span class="s1">(</span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">eq</span><span class="s1">);</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">semicolon</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseOpaqueType</span><span class="s1">(</span><span class="s2">declare</span><span class="s1">) {</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expectContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type</span><span class="s1">);</span>
  <span class="s2">flowParseRestrictedIdentifier</span><span class="s1">();</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">();</span>
  <span class="s1">}</span>

  <span class="s4">// Parse the supertype</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeInitialiser</span><span class="s1">(</span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">);</span>
  <span class="s1">}</span>

  <span class="s3">if </span><span class="s1">(!</span><span class="s2">declare</span><span class="s1">) {</span>
    <span class="s2">flowParseTypeInitialiser</span><span class="s1">(</span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">eq</span><span class="s1">);</span>
  <span class="s1">}</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">semicolon</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseTypeParameter</span><span class="s1">() {</span>
  <span class="s2">flowParseVariance</span><span class="s1">();</span>
  <span class="s2">flowParseTypeAnnotatableIdentifier</span><span class="s1">();</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">eq</span><span class="s1">)) {</span>
    <span class="s2">flowParseType</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

 <span class="s3">function </span><span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">() {</span>
  <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">0</span><span class="s1">);</span>
  <span class="s4">// istanbul ignore else: this condition is already checked at all call sites</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">) || </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">typeParameterStart</span><span class="s1">)) {</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">unexpected</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>

  <span class="s3">do </span><span class="s1">{</span>
    <span class="s2">flowParseTypeParameter</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">greaterThan</span><span class="s1">)) {</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">);</span>
    <span class="s1">}</span>
  <span class="s1">} </span><span class="s3">while </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">greaterThan</span><span class="s1">) &amp;&amp; !</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">);</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">greaterThan</span><span class="s1">);</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseTypeParameterDeclaration </span><span class="s1">= </span><span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">;</span>

<span class="s3">function </span><span class="s2">flowParseTypeParameterInstantiation</span><span class="s1">() {</span>
  <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">0</span><span class="s1">);</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">);</span>
  <span class="s3">while </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">greaterThan</span><span class="s1">) &amp;&amp; !</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
    <span class="s2">flowParseType</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">greaterThan</span><span class="s1">)) {</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">);</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">greaterThan</span><span class="s1">);</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseInterfaceType</span><span class="s1">() {</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expectContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_interface</span><span class="s1">);</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_extends</span><span class="s1">)) {</span>
    <span class="s3">do </span><span class="s1">{</span>
      <span class="s2">flowParseInterfaceExtends</span><span class="s1">();</span>
    <span class="s1">} </span><span class="s3">while </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">));</span>
  <span class="s1">}</span>
  <span class="s2">flowParseObjectType</span><span class="s1">(</span><span class="s3">false</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s3">false</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseObjectPropertyKey</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">num</span><span class="s1">) || </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">string</span><span class="s1">)) {</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseExprAtom</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseObjectTypeIndexer</span><span class="s1">() {</span>
  <span class="s4">// Note: bracketL has already been consumed</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">lookaheadType</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, ) === </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">) {</span>
    <span class="s2">flowParseObjectPropertyKey</span><span class="s1">();</span>
    <span class="s2">flowParseTypeInitialiser</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">flowParseType</span><span class="s1">();</span>
  <span class="s1">}</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketR</span><span class="s1">);</span>
  <span class="s2">flowParseTypeInitialiser</span><span class="s1">();</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseObjectTypeInternalSlot</span><span class="s1">() {</span>
  <span class="s4">// Note: both bracketL have already been consumed</span>
  <span class="s2">flowParseObjectPropertyKey</span><span class="s1">();</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketR</span><span class="s1">);</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketR</span><span class="s1">);</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">) || </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">)) {</span>
    <span class="s2">flowParseObjectTypeMethodish</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">question</span><span class="s1">);</span>
    <span class="s2">flowParseTypeInitialiser</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseObjectTypeMethodish</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">();</span>
  <span class="s1">}</span>

  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">);</span>
  <span class="s3">while </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">) &amp;&amp; !</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">ellipsis</span><span class="s1">) &amp;&amp; !</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
    <span class="s2">flowParseFunctionTypeParam</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">)) {</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">);</span>
    <span class="s1">}</span>
  <span class="s1">}</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">ellipsis</span><span class="s1">)) {</span>
    <span class="s2">flowParseFunctionTypeParam</span><span class="s1">();</span>
  <span class="s1">}</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">);</span>
  <span class="s2">flowParseTypeInitialiser</span><span class="s1">();</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseObjectTypeCallProperty</span><span class="s1">() {</span>
  <span class="s2">flowParseObjectTypeMethodish</span><span class="s1">();</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseObjectType</span><span class="s1">(</span><span class="s2">allowStatic</span><span class="s1">, </span><span class="s2">allowExact</span><span class="s1">, </span><span class="s2">allowProto</span><span class="s1">) {</span>
  <span class="s3">let </span><span class="s2">endDelim</span><span class="s1">;</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">allowExact </span><span class="s1">&amp;&amp; </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceBarL</span><span class="s1">)) {</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceBarL</span><span class="s1">);</span>
    <span class="s2">endDelim </span><span class="s1">= </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceBarR</span><span class="s1">;</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceL</span><span class="s1">);</span>
    <span class="s2">endDelim </span><span class="s1">= </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceR</span><span class="s1">;</span>
  <span class="s1">}</span>

  <span class="s3">while </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">endDelim</span><span class="s1">) &amp;&amp; !</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">allowProto </span><span class="s1">&amp;&amp; </span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_proto</span><span class="s1">)) {</span>
      <span class="s3">const </span><span class="s2">lookahead </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">lookaheadType</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
      <span class="s3">if </span><span class="s1">(</span><span class="s2">lookahead </span><span class="s1">!== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon </span><span class="s1">&amp;&amp; </span><span class="s2">lookahead </span><span class="s1">!== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">question</span><span class="s1">) {</span>
        <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
        <span class="s2">allowStatic </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
      <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">allowStatic </span><span class="s1">&amp;&amp; </span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_static</span><span class="s1">)) {</span>
      <span class="s3">const </span><span class="s2">lookahead </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">lookaheadType</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
      <span class="s3">if </span><span class="s1">(</span><span class="s2">lookahead </span><span class="s1">!== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon </span><span class="s1">&amp;&amp; </span><span class="s2">lookahead </span><span class="s1">!== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">question</span><span class="s1">) {</span>
        <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
      <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s2">flowParseVariance</span><span class="s1">();</span>

    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketL</span><span class="s1">)) {</span>
      <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketL</span><span class="s1">)) {</span>
        <span class="s2">flowParseObjectTypeInternalSlot</span><span class="s1">();</span>
      <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
        <span class="s2">flowParseObjectTypeIndexer</span><span class="s1">();</span>
      <span class="s1">}</span>
    <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">) || </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
      <span class="s2">flowParseObjectTypeCallProperty</span><span class="s1">();</span>
    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
      <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_get</span><span class="s1">) || </span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_set</span><span class="s1">)) {</span>
        <span class="s3">const </span><span class="s2">lookahead </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">lookaheadType</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">lookahead </span><span class="s1">=== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name </span><span class="s1">|| </span><span class="s2">lookahead </span><span class="s1">=== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">string </span><span class="s1">|| </span><span class="s2">lookahead </span><span class="s1">=== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">num</span><span class="s1">) {</span>
          <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
        <span class="s1">}</span>
      <span class="s1">}</span>

      <span class="s2">flowParseObjectTypeProperty</span><span class="s1">();</span>
    <span class="s1">}</span>

    <span class="s2">flowObjectTypeSemicolon</span><span class="s1">();</span>
  <span class="s1">}</span>

  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">endDelim</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseObjectTypeProperty</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">ellipsis</span><span class="s1">)) {</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">ellipsis</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">)) {</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">semi</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">// Explicit inexact object syntax.</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceR</span><span class="s1">)) {</span>
      <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">flowParseType</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">flowParseObjectPropertyKey</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">) || </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">)) {</span>
      <span class="s4">// This is a method property</span>
      <span class="s2">flowParseObjectTypeMethodish</span><span class="s1">();</span>
    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">question</span><span class="s1">);</span>
      <span class="s2">flowParseTypeInitialiser</span><span class="s1">();</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowObjectTypeSemicolon</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">semi</span><span class="s1">) &amp;&amp; !</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">) &amp;&amp; !</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceR</span><span class="s1">) &amp;&amp; !</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceBarR</span><span class="s1">)) {</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">unexpected</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseQualifiedTypeIdentifier</span><span class="s1">(</span><span class="s2">initialIdAlreadyParsed</span><span class="s1">) {</span>
  <span class="s3">if </span><span class="s1">(!</span><span class="s2">initialIdAlreadyParsed</span><span class="s1">) {</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>
  <span class="s3">while </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">dot</span><span class="s1">)) {</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseGenericType</span><span class="s1">() {</span>
  <span class="s2">flowParseQualifiedTypeIdentifier</span><span class="s1">(</span><span class="s3">true</span><span class="s1">);</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeParameterInstantiation</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseTypeofType</span><span class="s1">() {</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_typeof</span><span class="s1">);</span>
  <span class="s2">flowParsePrimaryType</span><span class="s1">();</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseTupleType</span><span class="s1">() {</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketL</span><span class="s1">);</span>
  <span class="s4">// We allow trailing commas</span>
  <span class="s3">while </span><span class="s1">(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">pos </span><span class="s1">&lt; </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&amp;&amp; !</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketR</span><span class="s1">)) {</span>
    <span class="s2">flowParseType</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketR</span><span class="s1">)) {</span>
      <span class="s3">break</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">);</span>
  <span class="s1">}</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketR</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseFunctionTypeParam</span><span class="s1">() {</span>
  <span class="s3">const </span><span class="s2">lookahead </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">lookaheadType</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">lookahead </span><span class="s1">=== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon </span><span class="s1">|| </span><span class="s2">lookahead </span><span class="s1">=== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">question</span><span class="s1">) {</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">question</span><span class="s1">);</span>
    <span class="s2">flowParseTypeInitialiser</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">flowParseType</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseFunctionTypeParams</span><span class="s1">() {</span>
  <span class="s3">while </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">) &amp;&amp; !</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">ellipsis</span><span class="s1">) &amp;&amp; !</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
    <span class="s2">flowParseFunctionTypeParam</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">)) {</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">);</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">ellipsis</span><span class="s1">)) {</span>
    <span class="s2">flowParseFunctionTypeParam</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s4">// The parsing of types roughly parallels the parsing of expressions, and</span>
<span class="s4">// primary types are kind of like primary expressions...they're the</span>
<span class="s4">// primitives with which other types are constructed.</span>
<span class="s3">function </span><span class="s2">flowParsePrimaryType</span><span class="s1">() {</span>
  <span class="s3">let </span><span class="s2">isGroupedType </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
  <span class="s3">const </span><span class="s2">oldNoAnonFunctionType </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType</span><span class="s1">;</span>

  <span class="s3">switch </span><span class="s1">(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">type</span><span class="s1">) {</span>
    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name</span><span class="s1">: {</span>
      <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_interface</span><span class="s1">)) {</span>
        <span class="s2">flowParseInterfaceType</span><span class="s1">();</span>
        <span class="s3">return</span><span class="s1">;</span>
      <span class="s1">}</span>
      <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
      <span class="s2">flowParseGenericType</span><span class="s1">();</span>
      <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceL</span><span class="s1">:</span>
      <span class="s2">flowParseObjectType</span><span class="s1">(</span><span class="s3">false</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s3">false</span><span class="s1">);</span>
      <span class="s3">return</span><span class="s1">;</span>

    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceBarL</span><span class="s1">:</span>
      <span class="s2">flowParseObjectType</span><span class="s1">(</span><span class="s3">false</span><span class="s1">, </span><span class="s3">true</span><span class="s1">, </span><span class="s3">false</span><span class="s1">);</span>
      <span class="s3">return</span><span class="s1">;</span>

    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketL</span><span class="s1">:</span>
      <span class="s2">flowParseTupleType</span><span class="s1">();</span>
      <span class="s3">return</span><span class="s1">;</span>

    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">:</span>
      <span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">();</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">);</span>
      <span class="s2">flowParseFunctionTypeParams</span><span class="s1">();</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">);</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">arrow</span><span class="s1">);</span>
      <span class="s2">flowParseType</span><span class="s1">();</span>
      <span class="s3">return</span><span class="s1">;</span>

    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">:</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>

      <span class="s4">// Check to see if this is actually a grouped type</span>
      <span class="s3">if </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">) &amp;&amp; !</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">ellipsis</span><span class="s1">)) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name</span><span class="s1">)) {</span>
          <span class="s3">const </span><span class="s2">token </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">lookaheadType</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
          <span class="s2">isGroupedType </span><span class="s1">= </span><span class="s2">token </span><span class="s1">!== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">question </span><span class="s1">&amp;&amp; </span><span class="s2">token </span><span class="s1">!== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">;</span>
        <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
          <span class="s2">isGroupedType </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s1">}</span>
      <span class="s1">}</span>

      <span class="s3">if </span><span class="s1">(</span><span class="s2">isGroupedType</span><span class="s1">) {</span>
        <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s2">flowParseType</span><span class="s1">();</span>
        <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType </span><span class="s1">= </span><span class="s2">oldNoAnonFunctionType</span><span class="s1">;</span>

        <span class="s4">// A `,` or a `) =&gt;` means this is an anonymous function type</span>
        <span class="s3">if </span><span class="s1">(</span>
          <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType </span><span class="s1">||</span>
          <span class="s1">!(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">) || (</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">) &amp;&amp; </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">lookaheadType</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, ) === </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">arrow</span><span class="s1">))</span>
        <span class="s1">) {</span>
          <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">);</span>
          <span class="s3">return</span><span class="s1">;</span>
        <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
          <span class="s4">// Eat a comma if there is one</span>
          <span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">);</span>
        <span class="s1">}</span>
      <span class="s1">}</span>

      <span class="s2">flowParseFunctionTypeParams</span><span class="s1">();</span>

      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenR</span><span class="s1">);</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">arrow</span><span class="s1">);</span>
      <span class="s2">flowParseType</span><span class="s1">();</span>
      <span class="s3">return</span><span class="s1">;</span>

    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">minus</span><span class="s1">:</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
      <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseLiteral</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
      <span class="s3">return</span><span class="s1">;</span>

    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">string</span><span class="s1">:</span>
    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">num</span><span class="s1">:</span>
    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_true</span><span class="s1">:</span>
    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_false</span><span class="s1">:</span>
    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_null</span><span class="s1">:</span>
    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_this</span><span class="s1">:</span>
    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_void</span><span class="s1">:</span>
    <span class="s3">case </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">star</span><span class="s1">:</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
      <span class="s3">return</span><span class="s1">;</span>

    <span class="s3">default</span><span class="s1">:</span>
      <span class="s3">if </span><span class="s1">(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_typeof</span><span class="s1">) {</span>
        <span class="s2">flowParseTypeofType</span><span class="s1">();</span>
        <span class="s3">return</span><span class="s1">;</span>
      <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">type </span><span class="s1">&amp; </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">IS_KEYWORD</span><span class="s1">) {</span>
        <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
        <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s5">1</span><span class="s1">].</span><span class="s2">type </span><span class="s1">= </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name</span><span class="s1">;</span>
        <span class="s3">return</span><span class="s1">;</span>
      <span class="s1">}</span>
  <span class="s1">}</span>

  <span class="s2">_util</span><span class="s1">.</span><span class="s2">unexpected</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParsePostfixType</span><span class="s1">() {</span>
  <span class="s2">flowParsePrimaryType</span><span class="s1">();</span>
  <span class="s3">while </span><span class="s1">(!</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">canInsertSemicolon</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, ) &amp;&amp; (</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketL</span><span class="s1">) || </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">questionDot</span><span class="s1">))) {</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">questionDot</span><span class="s1">);</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketL</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketR</span><span class="s1">)) {</span>
      <span class="s4">// Array type</span>
    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
      <span class="s4">// Indexed access type</span>
      <span class="s2">flowParseType</span><span class="s1">();</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bracketR</span><span class="s1">);</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParsePrefixType</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">question</span><span class="s1">)) {</span>
    <span class="s2">flowParsePrefixType</span><span class="s1">();</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">flowParsePostfixType</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseAnonFunctionWithoutParens</span><span class="s1">() {</span>
  <span class="s2">flowParsePrefixType</span><span class="s1">();</span>
  <span class="s3">if </span><span class="s1">(!</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType </span><span class="s1">&amp;&amp; </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">arrow</span><span class="s1">)) {</span>
    <span class="s2">flowParseType</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseIntersectionType</span><span class="s1">() {</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bitwiseAND</span><span class="s1">);</span>
  <span class="s2">flowParseAnonFunctionWithoutParens</span><span class="s1">();</span>
  <span class="s3">while </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bitwiseAND</span><span class="s1">)) {</span>
    <span class="s2">flowParseAnonFunctionWithoutParens</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseUnionType</span><span class="s1">() {</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bitwiseOR</span><span class="s1">);</span>
  <span class="s2">flowParseIntersectionType</span><span class="s1">();</span>
  <span class="s3">while </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">bitwiseOR</span><span class="s1">)) {</span>
    <span class="s2">flowParseIntersectionType</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseType</span><span class="s1">() {</span>
  <span class="s2">flowParseUnionType</span><span class="s1">();</span>
<span class="s1">}</span>

 <span class="s3">function </span><span class="s2">flowParseTypeAnnotation</span><span class="s1">() {</span>
  <span class="s2">flowParseTypeInitialiser</span><span class="s1">();</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseTypeAnnotation </span><span class="s1">= </span><span class="s2">flowParseTypeAnnotation</span><span class="s1">;</span>

<span class="s3">function </span><span class="s2">flowParseTypeAnnotatableIdentifier</span><span class="s1">() {</span>
  <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeAnnotation</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">}</span>

 <span class="s3">function </span><span class="s2">flowParseVariance</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">plus</span><span class="s1">) || </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">minus</span><span class="s1">)) {</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s5">1</span><span class="s1">].</span><span class="s2">isType </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseVariance </span><span class="s1">= </span><span class="s2">flowParseVariance</span><span class="s1">;</span>

<span class="s4">// ==================================</span>
<span class="s4">// Overrides</span>
<span class="s4">// ==================================</span>

 <span class="s3">function </span><span class="s2">flowParseFunctionBodyAndFinish</span><span class="s1">(</span><span class="s2">funcContextId</span><span class="s1">) {</span>
  <span class="s4">// For arrow functions, `parseArrow` handles the return type itself.</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeAndPredicateInitialiser</span><span class="s1">();</span>
  <span class="s1">}</span>

  <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseFunctionBody</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s2">funcContextId</span><span class="s1">);</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseFunctionBodyAndFinish </span><span class="s1">= </span><span class="s2">flowParseFunctionBodyAndFinish</span><span class="s1">;</span>

 <span class="s3">function </span><span class="s2">flowParseSubscript</span><span class="s1">(</span>
  <span class="s2">startTokenIndex</span><span class="s1">,</span>
  <span class="s2">noCalls</span><span class="s1">,</span>
  <span class="s2">stopState</span><span class="s1">,</span>
<span class="s1">) {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">questionDot</span><span class="s1">) &amp;&amp; </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">lookaheadType</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, ) === </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">noCalls</span><span class="s1">) {</span>
      <span class="s2">stopState</span><span class="s1">.</span><span class="s2">stop </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
      <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s2">flowParseTypeParameterInstantiation</span><span class="s1">();</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">);</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseCallExpressionArguments</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s3">return</span><span class="s1">;</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(!</span><span class="s2">noCalls </span><span class="s1">&amp;&amp; </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">snapshot </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">snapshot</span><span class="s1">();</span>
    <span class="s2">flowParseTypeParameterInstantiation</span><span class="s1">();</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">);</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseCallExpressionArguments</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
      <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">restoreFromSnapshot</span><span class="s1">(</span><span class="s2">snapshot</span><span class="s1">);</span>
    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
      <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
  <span class="s2">_expression</span><span class="s1">.</span><span class="s2">baseParseSubscript</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">startTokenIndex</span><span class="s1">, </span><span class="s2">noCalls</span><span class="s1">, </span><span class="s2">stopState</span><span class="s1">);</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseSubscript </span><span class="s1">= </span><span class="s2">flowParseSubscript</span><span class="s1">;</span>

 <span class="s3">function </span><span class="s2">flowStartParseNewArguments</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">snapshot </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">snapshot</span><span class="s1">();</span>
    <span class="s2">flowParseTypeParameterInstantiation</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
      <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">restoreFromSnapshot</span><span class="s1">(</span><span class="s2">snapshot</span><span class="s1">);</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowStartParseNewArguments </span><span class="s1">= </span><span class="s2">flowStartParseNewArguments</span><span class="s1">;</span>

<span class="s4">// interfaces</span>
 <span class="s3">function </span><span class="s2">flowTryParseStatement</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name</span><span class="s1">) &amp;&amp; </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_interface</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">0</span><span class="s1">);</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s2">flowParseInterface</span><span class="s1">();</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
    <span class="s3">return true</span><span class="s1">;</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_enum</span><span class="s1">)) {</span>
    <span class="s2">flowParseEnumDeclaration</span><span class="s1">();</span>
    <span class="s3">return true</span><span class="s1">;</span>
  <span class="s1">}</span>
  <span class="s3">return false</span><span class="s1">;</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowTryParseStatement </span><span class="s1">= </span><span class="s2">flowTryParseStatement</span><span class="s1">;</span>

 <span class="s3">function </span><span class="s2">flowTryParseExportDefaultExpression</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_enum</span><span class="s1">)) {</span>
    <span class="s2">flowParseEnumDeclaration</span><span class="s1">();</span>
    <span class="s3">return true</span><span class="s1">;</span>
  <span class="s1">}</span>
  <span class="s3">return false</span><span class="s1">;</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowTryParseExportDefaultExpression </span><span class="s1">= </span><span class="s2">flowTryParseExportDefaultExpression</span><span class="s1">;</span>

<span class="s4">// declares, interfaces and type aliases</span>
 <span class="s3">function </span><span class="s2">flowParseIdentifierStatement</span><span class="s1">(</span><span class="s2">contextualKeyword</span><span class="s1">) {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_declare</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_class</span><span class="s1">) ||</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name</span><span class="s1">) ||</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_function</span><span class="s1">) ||</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_var</span><span class="s1">) ||</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_export</span><span class="s1">)</span>
    <span class="s1">) {</span>
      <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">1</span><span class="s1">);</span>
      <span class="s2">flowParseDeclare</span><span class="s1">();</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
    <span class="s1">}</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name</span><span class="s1">)) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_interface</span><span class="s1">) {</span>
      <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">1</span><span class="s1">);</span>
      <span class="s2">flowParseInterface</span><span class="s1">();</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
    <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type</span><span class="s1">) {</span>
      <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">1</span><span class="s1">);</span>
      <span class="s2">flowParseTypeAlias</span><span class="s1">();</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
    <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_opaque</span><span class="s1">) {</span>
      <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">1</span><span class="s1">);</span>
      <span class="s2">flowParseOpaqueType</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">semicolon</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseIdentifierStatement </span><span class="s1">= </span><span class="s2">flowParseIdentifierStatement</span><span class="s1">;</span>

<span class="s4">// export type</span>
 <span class="s3">function </span><span class="s2">flowShouldParseExportDeclaration</span><span class="s1">() {</span>
  <span class="s3">return </span><span class="s1">(</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type</span><span class="s1">) ||</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_interface</span><span class="s1">) ||</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_opaque</span><span class="s1">) ||</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_enum</span><span class="s1">)</span>
  <span class="s1">);</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowShouldParseExportDeclaration </span><span class="s1">= </span><span class="s2">flowShouldParseExportDeclaration</span><span class="s1">;</span>

 <span class="s3">function </span><span class="s2">flowShouldDisallowExportDefaultSpecifier</span><span class="s1">() {</span>
  <span class="s3">return </span><span class="s1">(</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name</span><span class="s1">) &amp;&amp;</span>
    <span class="s1">(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type </span><span class="s1">||</span>
      <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_interface </span><span class="s1">||</span>
      <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_opaque </span><span class="s1">||</span>
      <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_enum</span><span class="s1">)</span>
  <span class="s1">);</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowShouldDisallowExportDefaultSpecifier </span><span class="s1">= </span><span class="s2">flowShouldDisallowExportDefaultSpecifier</span><span class="s1">;</span>

 <span class="s3">function </span><span class="s2">flowParseExportDeclaration</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">1</span><span class="s1">);</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>

    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceL</span><span class="s1">)) {</span>
      <span class="s4">// export type { foo, bar };</span>
      <span class="s2">_statement</span><span class="s1">.</span><span class="s2">parseExportSpecifiers</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
      <span class="s2">_statement</span><span class="s1">.</span><span class="s2">parseExportFrom</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
      <span class="s4">// export type Foo = Bar;</span>
      <span class="s2">flowParseTypeAlias</span><span class="s1">();</span>
    <span class="s1">}</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_opaque</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">1</span><span class="s1">);</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s4">// export opaque type Foo = Bar;</span>
    <span class="s2">flowParseOpaqueType</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_interface</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">1</span><span class="s1">);</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s2">flowParseInterface</span><span class="s1">();</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">_statement</span><span class="s1">.</span><span class="s2">parseStatement</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseExportDeclaration </span><span class="s1">= </span><span class="s2">flowParseExportDeclaration</span><span class="s1">;</span>

 <span class="s3">function </span><span class="s2">flowShouldParseExportStar</span><span class="s1">() {</span>
  <span class="s3">return </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">star</span><span class="s1">) || (</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type</span><span class="s1">) &amp;&amp; </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">lookaheadType</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, ) === </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">star</span><span class="s1">);</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowShouldParseExportStar </span><span class="s1">= </span><span class="s2">flowShouldParseExportStar</span><span class="s1">;</span>

 <span class="s3">function </span><span class="s2">flowParseExportStar</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">eatContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">2</span><span class="s1">);</span>
    <span class="s2">_statement</span><span class="s1">.</span><span class="s2">baseParseExportStar</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">_statement</span><span class="s1">.</span><span class="s2">baseParseExportStar</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseExportStar </span><span class="s1">= </span><span class="s2">flowParseExportStar</span><span class="s1">;</span>

<span class="s4">// parse a the super class type parameters and implements</span>
 <span class="s3">function </span><span class="s2">flowAfterParseClassSuper</span><span class="s1">(</span><span class="s2">hasSuper</span><span class="s1">) {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">hasSuper </span><span class="s1">&amp;&amp; </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeParameterInstantiation</span><span class="s1">();</span>
  <span class="s1">}</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_implements</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">0</span><span class="s1">);</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s5">1</span><span class="s1">].</span><span class="s2">type </span><span class="s1">= </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_implements</span><span class="s1">;</span>
    <span class="s3">do </span><span class="s1">{</span>
      <span class="s2">flowParseRestrictedIdentifier</span><span class="s1">();</span>
      <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
        <span class="s2">flowParseTypeParameterInstantiation</span><span class="s1">();</span>
      <span class="s1">}</span>
    <span class="s1">} </span><span class="s3">while </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">));</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowAfterParseClassSuper </span><span class="s1">= </span><span class="s2">flowAfterParseClassSuper</span><span class="s1">;</span>

<span class="s4">// parse type parameters for object method shorthand</span>
 <span class="s3">function </span><span class="s2">flowStartParseObjPropValue</span><span class="s1">() {</span>
  <span class="s4">// method shorthand</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">parenL</span><span class="s1">)) </span><span class="s2">_util</span><span class="s1">.</span><span class="s2">unexpected</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowStartParseObjPropValue </span><span class="s1">= </span><span class="s2">flowStartParseObjPropValue</span><span class="s1">;</span>

 <span class="s3">function </span><span class="s2">flowParseAssignableListItemTypes</span><span class="s1">() {</span>
  <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">0</span><span class="s1">);</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">question</span><span class="s1">);</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeAnnotation</span><span class="s1">();</span>
  <span class="s1">}</span>
  <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseAssignableListItemTypes </span><span class="s1">= </span><span class="s2">flowParseAssignableListItemTypes</span><span class="s1">;</span>

<span class="s4">// parse typeof and type imports</span>
 <span class="s3">function </span><span class="s2">flowStartParseImportSpecifiers</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_typeof</span><span class="s1">) || </span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">lh </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">lookaheadTypeAndKeyword</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isMaybeDefaultImport</span><span class="s1">(</span><span class="s2">lh</span><span class="s1">) || </span><span class="s2">lh</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceL </span><span class="s1">|| </span><span class="s2">lh</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">star</span><span class="s1">) {</span>
      <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowStartParseImportSpecifiers </span><span class="s1">= </span><span class="s2">flowStartParseImportSpecifiers</span><span class="s1">;</span>

<span class="s4">// parse import-type/typeof shorthand</span>
 <span class="s3">function </span><span class="s2">flowParseImportSpecifier</span><span class="s1">() {</span>
  <span class="s3">const </span><span class="s2">isTypeKeyword </span><span class="s1">=</span>
    <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_type </span><span class="s1">|| </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_typeof</span><span class="s1">;</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">isTypeKeyword</span><span class="s1">) {</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_as</span><span class="s1">) &amp;&amp; !</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">isLookaheadContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_as</span><span class="s1">)) {</span>
    <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isTypeKeyword </span><span class="s1">&amp;&amp; !</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name</span><span class="s1">) &amp;&amp; !(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">type </span><span class="s1">&amp; </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">IS_KEYWORD</span><span class="s1">)) {</span>
      <span class="s4">// `import {type as ,` or `import {type as }`</span>
    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
      <span class="s4">// `import {type as foo`</span>
      <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s1">}</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isTypeKeyword </span><span class="s1">&amp;&amp; (</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">name</span><span class="s1">) || !!(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">type </span><span class="s1">&amp; </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">IS_KEYWORD</span><span class="s1">))) {</span>
      <span class="s4">// `import {type foo`</span>
      <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">eatContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_as</span><span class="s1">)) {</span>
      <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseImportSpecifier </span><span class="s1">= </span><span class="s2">flowParseImportSpecifier</span><span class="s1">;</span>

<span class="s4">// parse function type parameters - function foo&lt;T&gt;() {}</span>
 <span class="s3">function </span><span class="s2">flowStartParseFunctionParams</span><span class="s1">() {</span>
  <span class="s4">// Originally this checked if the method is a getter/setter, but if it was, we'd crash soon</span>
  <span class="s4">// anyway, so don't try to propagate that information.</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">0</span><span class="s1">);</span>
    <span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">();</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowStartParseFunctionParams </span><span class="s1">= </span><span class="s2">flowStartParseFunctionParams</span><span class="s1">;</span>

<span class="s4">// parse flow type annotations on variable declarator heads - let foo: string = bar</span>
 <span class="s3">function </span><span class="s2">flowAfterParseVarHead</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">)) {</span>
    <span class="s2">flowParseTypeAnnotation</span><span class="s1">();</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowAfterParseVarHead </span><span class="s1">= </span><span class="s2">flowAfterParseVarHead</span><span class="s1">;</span>

<span class="s4">// parse the return type of an async arrow function - let foo = (async (): number =&gt; {});</span>
 <span class="s3">function </span><span class="s2">flowStartParseAsyncArrowFromCallExpression</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">oldNoAnonFunctionType </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType</span><span class="s1">;</span>
    <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s2">flowParseTypeAnnotation</span><span class="s1">();</span>
    <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType </span><span class="s1">= </span><span class="s2">oldNoAnonFunctionType</span><span class="s1">;</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowStartParseAsyncArrowFromCallExpression </span><span class="s1">= </span><span class="s2">flowStartParseAsyncArrowFromCallExpression</span><span class="s1">;</span>

<span class="s4">// We need to support type parameter declarations for arrow functions. This</span>
<span class="s4">// is tricky. There are three situations we need to handle</span>
<span class="s4">//</span>
<span class="s4">// 1. This is either JSX or an arrow function. We'll try JSX first. If that</span>
<span class="s4">//    fails, we'll try an arrow function. If that fails, we'll throw the JSX</span>
<span class="s4">//    error.</span>
<span class="s4">// 2. This is an arrow function. We'll parse the type parameter declaration,</span>
<span class="s4">//    parse the rest, make sure the rest is an arrow function, and go from</span>
<span class="s4">//    there</span>
<span class="s4">// 3. This is neither. Just call the super method</span>
 <span class="s3">function </span><span class="s2">flowParseMaybeAssign</span><span class="s1">(</span><span class="s2">noIn</span><span class="s1">, </span><span class="s2">isWithinParens</span><span class="s1">) {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">snapshot </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">snapshot</span><span class="s1">();</span>
    <span class="s3">let </span><span class="s2">wasArrow </span><span class="s1">= </span><span class="s2">_expression</span><span class="s1">.</span><span class="s2">baseParseMaybeAssign</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">noIn</span><span class="s1">, </span><span class="s2">isWithinParens</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
      <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">restoreFromSnapshot</span><span class="s1">(</span><span class="s2">snapshot</span><span class="s1">);</span>
      <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">type </span><span class="s1">= </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">typeParameterStart</span><span class="s1">;</span>
    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
      <span class="s3">return </span><span class="s2">wasArrow</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">0</span><span class="s1">);</span>
    <span class="s2">flowParseTypeParameterDeclaration</span><span class="s1">();</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
    <span class="s2">wasArrow </span><span class="s1">= </span><span class="s2">_expression</span><span class="s1">.</span><span class="s2">baseParseMaybeAssign</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">noIn</span><span class="s1">, </span><span class="s2">isWithinParens</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">wasArrow</span><span class="s1">) {</span>
      <span class="s3">return true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">_util</span><span class="s1">.</span><span class="s2">unexpected</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>

  <span class="s3">return </span><span class="s2">_expression</span><span class="s1">.</span><span class="s2">baseParseMaybeAssign</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">noIn</span><span class="s1">, </span><span class="s2">isWithinParens</span><span class="s1">);</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseMaybeAssign </span><span class="s1">= </span><span class="s2">flowParseMaybeAssign</span><span class="s1">;</span>

<span class="s4">// handle return types for arrow functions</span>
 <span class="s3">function </span><span class="s2">flowParseArrow</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">colon</span><span class="s1">)) {</span>
    <span class="s3">const </span><span class="s2">oldIsType </span><span class="s1">= </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">pushTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s5">0</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">snapshot </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">snapshot</span><span class="s1">();</span>

    <span class="s3">const </span><span class="s2">oldNoAnonFunctionType </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType</span><span class="s1">;</span>
    <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s2">flowParseTypeAndPredicateInitialiser</span><span class="s1">();</span>
    <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">noAnonFunctionType </span><span class="s1">= </span><span class="s2">oldNoAnonFunctionType</span><span class="s1">;</span>

    <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">canInsertSemicolon</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, )) </span><span class="s2">_util</span><span class="s1">.</span><span class="s2">unexpected</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">arrow</span><span class="s1">)) </span><span class="s2">_util</span><span class="s1">.</span><span class="s2">unexpected</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>

    <span class="s3">if </span><span class="s1">(</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
      <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">restoreFromSnapshot</span><span class="s1">(</span><span class="s2">snapshot</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">popTypeContext</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">oldIsType</span><span class="s1">);</span>
  <span class="s1">}</span>
  <span class="s3">return </span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">arrow</span><span class="s1">);</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseArrow </span><span class="s1">= </span><span class="s2">flowParseArrow</span><span class="s1">;</span>

 <span class="s3">function </span><span class="s2">flowParseSubscripts</span><span class="s1">(</span><span class="s2">startTokenIndex</span><span class="s1">, </span><span class="s2">noCalls </span><span class="s1">= </span><span class="s3">false</span><span class="s1">) {</span>
  <span class="s3">if </span><span class="s1">(</span>
    <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s5">1</span><span class="s1">].</span><span class="s2">contextualKeyword </span><span class="s1">=== </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_async </span><span class="s1">&amp;&amp;</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">lessThan</span><span class="s1">)</span>
  <span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">snapshot </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">snapshot</span><span class="s1">();</span>
    <span class="s3">const </span><span class="s2">wasArrow </span><span class="s1">= </span><span class="s2">parseAsyncArrowWithTypeParameters</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">wasArrow </span><span class="s1">&amp;&amp; !</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
      <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">restoreFromSnapshot</span><span class="s1">(</span><span class="s2">snapshot</span><span class="s1">);</span>
  <span class="s1">}</span>

  <span class="s2">_expression</span><span class="s1">.</span><span class="s2">baseParseSubscripts</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">startTokenIndex</span><span class="s1">, </span><span class="s2">noCalls</span><span class="s1">);</span>
<span class="s1">} </span><span class="s2">exports</span><span class="s1">.</span><span class="s2">flowParseSubscripts </span><span class="s1">= </span><span class="s2">flowParseSubscripts</span><span class="s1">;</span>

<span class="s4">// Returns true if there was an arrow function here.</span>
<span class="s3">function </span><span class="s2">parseAsyncArrowWithTypeParameters</span><span class="s1">() {</span>
  <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">scopeDepth</span><span class="s1">++;</span>
  <span class="s3">const </span><span class="s2">startTokenIndex </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
  <span class="s2">_statement</span><span class="s1">.</span><span class="s2">parseFunctionParams</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s3">if </span><span class="s1">(!</span><span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseArrow</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, )) {</span>
    <span class="s3">return false</span><span class="s1">;</span>
  <span class="s1">}</span>
  <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseArrowExpression</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">startTokenIndex</span><span class="s1">);</span>
  <span class="s3">return true</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseEnumDeclaration</span><span class="s1">() {</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expectContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_enum</span><span class="s1">);</span>
  <span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s5">1</span><span class="s1">].</span><span class="s2">type </span><span class="s1">= </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">_enum</span><span class="s1">;</span>
  <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s2">flowParseEnumBody</span><span class="s1">();</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseEnumBody</span><span class="s1">() {</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_util</span><span class="s1">.</span><span class="s2">eatContextual</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_keywords</span><span class="s1">.</span><span class="s2">ContextualKeyword</span><span class="s1">.</span><span class="s2">_of</span><span class="s1">)) {</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceL</span><span class="s1">);</span>
  <span class="s2">flowParseEnumMembers</span><span class="s1">();</span>
  <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceR</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseEnumMembers</span><span class="s1">() {</span>
  <span class="s3">while </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceR</span><span class="s1">) &amp;&amp; !</span><span class="s2">_base</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">ellipsis</span><span class="s1">)) {</span>
      <span class="s3">break</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">flowParseEnumMember</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">match</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">braceR</span><span class="s1">)) {</span>
      <span class="s2">_util</span><span class="s1">.</span><span class="s2">expect</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">comma</span><span class="s1">);</span>
    <span class="s1">}</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">flowParseEnumMember</span><span class="s1">() {</span>
  <span class="s2">_expression</span><span class="s1">.</span><span class="s2">parseIdentifier</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s3">if </span><span class="s1">(</span><span class="s2">_index</span><span class="s1">.</span><span class="s2">eat</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, </span><span class="s2">_types</span><span class="s1">.</span><span class="s2">TokenType</span><span class="s1">.</span><span class="s2">eq</span><span class="s1">)) {</span>
    <span class="s4">// Flow enum values are always just one token (a string, number, or boolean literal).</span>
    <span class="s2">_index</span><span class="s1">.</span><span class="s2">next</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">void </span><span class="s5">0</span><span class="s1">, );</span>
  <span class="s1">}</span>
<span class="s1">}</span>
</pre>
</body>
</html>