<html>
<head>
<title>formatter.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #6aab73;}
.s3 { color: #bcbec4;}
.s4 { color: #cf8e6d;}
.s5 { color: #7a7e85;}
.s6 { color: #2aacb8;}
.s7 { color: #42c3d4;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
formatter.js</font>
</center></td></tr></table>
<pre><span class="s0">/**</span>
 <span class="s0">* class HelpFormatter</span>
 <span class="s0">*</span>
 <span class="s0">* Formatter for generating usage messages and argument help strings. Only the</span>
 <span class="s0">* name of this class is considered a public API. All the methods provided by</span>
 <span class="s0">* the class are considered an implementation detail.</span>
 <span class="s0">*</span>
 <span class="s0">* Do not call in your code, use this class only for inherits your own forvatter</span>
 <span class="s0">*</span>
 <span class="s0">* ToDo add [additonal formatters][1]</span>
 <span class="s0">*</span>
 <span class="s0">* [1]:http://docs.python.org/dev/library/argparse.html#formatter-class</span>
 <span class="s0">**/</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s4">var </span><span class="s1">sprintf </span><span class="s3">= </span><span class="s1">require</span><span class="s3">(</span><span class="s2">'sprintf-js'</span><span class="s3">).</span><span class="s1">sprintf</span><span class="s3">;</span>

<span class="s5">// Constants</span>
<span class="s4">var </span><span class="s1">c </span><span class="s3">= </span><span class="s1">require</span><span class="s3">(</span><span class="s2">'../const'</span><span class="s3">);</span>

<span class="s4">var </span><span class="s1">$$ </span><span class="s3">= </span><span class="s1">require</span><span class="s3">(</span><span class="s2">'../utils'</span><span class="s3">);</span>


<span class="s5">/*:nodoc:* internal 
 * new Support(parent, heding) 
 * - parent (object): parent section 
 * - heading (string): header string 
 * 
 **/</span>
<span class="s4">function </span><span class="s1">Section</span><span class="s3">(</span><span class="s1">parent</span><span class="s3">, </span><span class="s1">heading</span><span class="s3">) {</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_parent </span><span class="s3">= </span><span class="s1">parent</span><span class="s3">;</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_heading </span><span class="s3">= </span><span class="s1">heading</span><span class="s3">;</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_items </span><span class="s3">= [];</span>
<span class="s3">}</span>

<span class="s5">/*:nodoc:* internal 
 * Section#addItem(callback) -&gt; Void 
 * - callback (array): tuple with function and args 
 * 
 * Add function for single element 
 **/</span>
<span class="s1">Section</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">addItem </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">callback</span><span class="s3">) {</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_items</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">callback</span><span class="s3">);</span>
<span class="s3">};</span>

<span class="s5">/*:nodoc:* internal 
 * Section#formatHelp(formatter) -&gt; string 
 * - formatter (HelpFormatter): current formatter 
 * 
 * Form help section string 
 * 
 **/</span>
<span class="s1">Section</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">formatHelp </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">formatter</span><span class="s3">) {</span>
  <span class="s4">var </span><span class="s1">itemHelp</span><span class="s3">, </span><span class="s1">heading</span><span class="s3">;</span>

  <span class="s5">// format the indented section</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_parent</span><span class="s3">) {</span>
    <span class="s1">formatter</span><span class="s3">.</span><span class="s1">_indent</span><span class="s3">();</span>
  <span class="s3">}</span>

  <span class="s1">itemHelp </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_items</span><span class="s3">.</span><span class="s1">map</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">item</span><span class="s3">) {</span>
    <span class="s4">var </span><span class="s1">obj</span><span class="s3">, </span><span class="s1">func</span><span class="s3">, </span><span class="s1">args</span><span class="s3">;</span>

    <span class="s1">obj </span><span class="s3">= </span><span class="s1">formatter</span><span class="s3">;</span>
    <span class="s1">func </span><span class="s3">= </span><span class="s1">item</span><span class="s3">[</span><span class="s6">0</span><span class="s3">];</span>
    <span class="s1">args </span><span class="s3">= </span><span class="s1">item</span><span class="s3">[</span><span class="s6">1</span><span class="s3">];</span>
    <span class="s4">return </span><span class="s1">func</span><span class="s3">.</span><span class="s1">apply</span><span class="s3">(</span><span class="s1">obj</span><span class="s3">, </span><span class="s1">args</span><span class="s3">);</span>
  <span class="s3">});</span>
  <span class="s1">itemHelp </span><span class="s3">= </span><span class="s1">formatter</span><span class="s3">.</span><span class="s1">_joinParts</span><span class="s3">(</span><span class="s1">itemHelp</span><span class="s3">);</span>

  <span class="s4">if </span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_parent</span><span class="s3">) {</span>
    <span class="s1">formatter</span><span class="s3">.</span><span class="s1">_dedent</span><span class="s3">();</span>
  <span class="s3">}</span>

  <span class="s5">// return nothing if the section was empty</span>
  <span class="s4">if </span><span class="s3">(!</span><span class="s1">itemHelp</span><span class="s3">) {</span>
    <span class="s4">return </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s3">}</span>

  <span class="s5">// add the heading if the section was non-empty</span>
  <span class="s1">heading </span><span class="s3">= </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_heading </span><span class="s3">&amp;&amp; </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_heading </span><span class="s3">!== </span><span class="s1">c</span><span class="s3">.</span><span class="s1">SUPPRESS</span><span class="s3">) {</span>
    <span class="s4">var </span><span class="s1">currentIndent </span><span class="s3">= </span><span class="s1">formatter</span><span class="s3">.</span><span class="s1">currentIndent</span><span class="s3">;</span>
    <span class="s1">heading </span><span class="s3">= </span><span class="s1">$$</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">, </span><span class="s1">currentIndent</span><span class="s3">) + </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_heading </span><span class="s3">+ </span><span class="s2">':' </span><span class="s3">+ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">;</span>
  <span class="s3">}</span>

  <span class="s5">// join the section-initialize newline, the heading and the help</span>
  <span class="s4">return </span><span class="s1">formatter</span><span class="s3">.</span><span class="s1">_joinParts</span><span class="s3">([ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">, </span><span class="s1">heading</span><span class="s3">, </span><span class="s1">itemHelp</span><span class="s3">, </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL </span><span class="s3">]);</span>
<span class="s3">};</span>

<span class="s0">/**</span>
 <span class="s0">* new HelpFormatter(options)</span>
 <span class="s0">*</span>
 <span class="s0">* #### Options:</span>
 <span class="s0">* - `prog`: program name</span>
 <span class="s0">* - `indentIncriment`: indent step, default value 2</span>
 <span class="s0">* - `maxHelpPosition`: max help position, default value = 24</span>
 <span class="s0">* - `width`: line width</span>
 <span class="s0">*</span>
 <span class="s0">**/</span>
<span class="s4">var </span><span class="s1">HelpFormatter </span><span class="s3">= </span><span class="s1">module</span><span class="s3">.</span><span class="s1">exports </span><span class="s3">= </span><span class="s4">function </span><span class="s1">HelpFormatter</span><span class="s3">(</span><span class="s1">options</span><span class="s3">) {</span>
  <span class="s1">options </span><span class="s3">= </span><span class="s1">options </span><span class="s3">|| {};</span>

  <span class="s4">this</span><span class="s3">.</span><span class="s1">_prog </span><span class="s3">= </span><span class="s1">options</span><span class="s3">.</span><span class="s1">prog</span><span class="s3">;</span>

  <span class="s4">this</span><span class="s3">.</span><span class="s1">_maxHelpPosition </span><span class="s3">= </span><span class="s1">options</span><span class="s3">.</span><span class="s1">maxHelpPosition </span><span class="s3">|| </span><span class="s6">24</span><span class="s3">;</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_width </span><span class="s3">= (</span><span class="s1">options</span><span class="s3">.</span><span class="s1">width </span><span class="s3">|| ((</span><span class="s1">process</span><span class="s3">.</span><span class="s1">env</span><span class="s3">.</span><span class="s1">COLUMNS </span><span class="s3">|| </span><span class="s6">80</span><span class="s3">) - </span><span class="s6">2</span><span class="s3">));</span>

  <span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent </span><span class="s3">= </span><span class="s6">0</span><span class="s3">;</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_indentIncriment </span><span class="s3">= </span><span class="s1">options</span><span class="s3">.</span><span class="s1">indentIncriment </span><span class="s3">|| </span><span class="s6">2</span><span class="s3">;</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_level </span><span class="s3">= </span><span class="s6">0</span><span class="s3">;</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_actionMaxLength </span><span class="s3">= </span><span class="s6">0</span><span class="s3">;</span>

  <span class="s4">this</span><span class="s3">.</span><span class="s1">_rootSection </span><span class="s3">= </span><span class="s4">new </span><span class="s1">Section</span><span class="s3">(</span><span class="s4">null</span><span class="s3">);</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_currentSection </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_rootSection</span><span class="s3">;</span>

  <span class="s4">this</span><span class="s3">.</span><span class="s1">_whitespaceMatcher </span><span class="s3">= </span><span class="s4">new </span><span class="s1">RegExp</span><span class="s3">(</span><span class="s2">'</span><span class="s4">\\</span><span class="s2">s+'</span><span class="s3">, </span><span class="s2">'g'</span><span class="s3">);</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_longBreakMatcher </span><span class="s3">= </span><span class="s4">new </span><span class="s1">RegExp</span><span class="s3">(</span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL </span><span class="s3">+ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL </span><span class="s3">+ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL </span><span class="s3">+ </span><span class="s2">'+'</span><span class="s3">, </span><span class="s2">'g'</span><span class="s3">);</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_indent </span><span class="s3">= </span><span class="s4">function </span><span class="s3">() {</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent </span><span class="s3">+= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_indentIncriment</span><span class="s3">;</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_level </span><span class="s3">+= </span><span class="s6">1</span><span class="s3">;</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_dedent </span><span class="s3">= </span><span class="s4">function </span><span class="s3">() {</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent </span><span class="s3">-= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_indentIncriment</span><span class="s3">;</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_level </span><span class="s3">-= </span><span class="s6">1</span><span class="s3">;</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">) {</span>
    <span class="s4">throw new </span><span class="s1">Error</span><span class="s3">(</span><span class="s2">'Indent decreased below 0.'</span><span class="s3">);</span>
  <span class="s3">}</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_addItem </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">func</span><span class="s3">, </span><span class="s1">args</span><span class="s3">) {</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_currentSection</span><span class="s3">.</span><span class="s1">addItem</span><span class="s3">([ </span><span class="s1">func</span><span class="s3">, </span><span class="s1">args </span><span class="s3">]);</span>
<span class="s3">};</span>

<span class="s5">//</span>
<span class="s5">// Message building methods</span>
<span class="s5">//</span>

<span class="s0">/**</span>
 <span class="s0">* HelpFormatter#startSection(heading) -&gt; Void</span>
 <span class="s0">* - heading (string): header string</span>
 <span class="s0">*</span>
 <span class="s0">* Start new help section</span>
 <span class="s0">*</span>
 <span class="s0">* See alse [code example][1]</span>
 <span class="s0">*</span>
 <span class="s0">* ##### Example</span>
 <span class="s0">*</span>
 <span class="s0">*      formatter.startSection(actionGroup.title);</span>
 <span class="s0">*      formatter.addText(actionGroup.description);</span>
 <span class="s0">*      formatter.addArguments(actionGroup._groupActions);</span>
 <span class="s0">*      formatter.endSection();</span>
 <span class="s0">*</span>
 <span class="s0">**/</span>
<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">startSection </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">heading</span><span class="s3">) {</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_indent</span><span class="s3">();</span>
  <span class="s4">var </span><span class="s1">section </span><span class="s3">= </span><span class="s4">new </span><span class="s1">Section</span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentSection</span><span class="s3">, </span><span class="s1">heading</span><span class="s3">);</span>
  <span class="s4">var </span><span class="s1">func </span><span class="s3">= </span><span class="s1">section</span><span class="s3">.</span><span class="s1">formatHelp</span><span class="s3">.</span><span class="s1">bind</span><span class="s3">(</span><span class="s1">section</span><span class="s3">);</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_addItem</span><span class="s3">(</span><span class="s1">func</span><span class="s3">, [ </span><span class="s4">this </span><span class="s3">]);</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_currentSection </span><span class="s3">= </span><span class="s1">section</span><span class="s3">;</span>
<span class="s3">};</span>

<span class="s0">/**</span>
 <span class="s0">* HelpFormatter#endSection -&gt; Void</span>
 <span class="s0">*</span>
 <span class="s0">* End help section</span>
 <span class="s0">*</span>
 <span class="s0">* ##### Example</span>
 <span class="s0">*</span>
 <span class="s0">*      formatter.startSection(actionGroup.title);</span>
 <span class="s0">*      formatter.addText(actionGroup.description);</span>
 <span class="s0">*      formatter.addArguments(actionGroup._groupActions);</span>
 <span class="s0">*      formatter.endSection();</span>
 <span class="s0">**/</span>
<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">endSection </span><span class="s3">= </span><span class="s4">function </span><span class="s3">() {</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_currentSection </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentSection</span><span class="s3">.</span><span class="s1">_parent</span><span class="s3">;</span>
  <span class="s4">this</span><span class="s3">.</span><span class="s1">_dedent</span><span class="s3">();</span>
<span class="s3">};</span>

<span class="s0">/**</span>
 <span class="s0">* HelpFormatter#addText(text) -&gt; Void</span>
 <span class="s0">* - text (string): plain text</span>
 <span class="s0">*</span>
 <span class="s0">* Add plain text into current section</span>
 <span class="s0">*</span>
 <span class="s0">* ##### Example</span>
 <span class="s0">*</span>
 <span class="s0">*      formatter.startSection(actionGroup.title);</span>
 <span class="s0">*      formatter.addText(actionGroup.description);</span>
 <span class="s0">*      formatter.addArguments(actionGroup._groupActions);</span>
 <span class="s0">*      formatter.endSection();</span>
 <span class="s0">*</span>
 <span class="s0">**/</span>
<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">addText </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">text</span><span class="s3">) {</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s1">text </span><span class="s3">&amp;&amp; </span><span class="s1">text </span><span class="s3">!== </span><span class="s1">c</span><span class="s3">.</span><span class="s1">SUPPRESS</span><span class="s3">) {</span>
    <span class="s4">this</span><span class="s3">.</span><span class="s1">_addItem</span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_formatText</span><span class="s3">, [ </span><span class="s1">text </span><span class="s3">]);</span>
  <span class="s3">}</span>
<span class="s3">};</span>

<span class="s0">/**</span>
 <span class="s0">* HelpFormatter#addUsage(usage, actions, groups, prefix) -&gt; Void</span>
 <span class="s0">* - usage (string): usage text</span>
 <span class="s0">* - actions (array): actions list</span>
 <span class="s0">* - groups (array): groups list</span>
 <span class="s0">* - prefix (string): usage prefix</span>
 <span class="s0">*</span>
 <span class="s0">* Add usage data into current section</span>
 <span class="s0">*</span>
 <span class="s0">* ##### Example</span>
 <span class="s0">*</span>
 <span class="s0">*      formatter.addUsage(this.usage, this._actions, []);</span>
 <span class="s0">*      return formatter.formatHelp();</span>
 <span class="s0">*</span>
 <span class="s0">**/</span>
<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">addUsage </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">usage</span><span class="s3">, </span><span class="s1">actions</span><span class="s3">, </span><span class="s1">groups</span><span class="s3">, </span><span class="s1">prefix</span><span class="s3">) {</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s1">usage </span><span class="s3">!== </span><span class="s1">c</span><span class="s3">.</span><span class="s1">SUPPRESS</span><span class="s3">) {</span>
    <span class="s4">this</span><span class="s3">.</span><span class="s1">_addItem</span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_formatUsage</span><span class="s3">, [ </span><span class="s1">usage</span><span class="s3">, </span><span class="s1">actions</span><span class="s3">, </span><span class="s1">groups</span><span class="s3">, </span><span class="s1">prefix </span><span class="s3">]);</span>
  <span class="s3">}</span>
<span class="s3">};</span>

<span class="s0">/**</span>
 <span class="s0">* HelpFormatter#addArgument(action) -&gt; Void</span>
 <span class="s0">* - action (object): action</span>
 <span class="s0">*</span>
 <span class="s0">* Add argument into current section</span>
 <span class="s0">*</span>
 <span class="s0">* Single variant of [[HelpFormatter#addArguments]]</span>
 <span class="s0">**/</span>
<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">addArgument </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">) {</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">help </span><span class="s3">!== </span><span class="s1">c</span><span class="s3">.</span><span class="s1">SUPPRESS</span><span class="s3">) {</span>
    <span class="s4">var </span><span class="s1">self </span><span class="s3">= </span><span class="s4">this</span><span class="s3">;</span>

    <span class="s5">// find all invocations</span>
    <span class="s4">var </span><span class="s1">invocations </span><span class="s3">= [ </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_formatActionInvocation</span><span class="s3">(</span><span class="s1">action</span><span class="s3">) ];</span>
    <span class="s4">var </span><span class="s1">invocationLength </span><span class="s3">= </span><span class="s1">invocations</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">length</span><span class="s3">;</span>

    <span class="s4">var </span><span class="s1">actionLength</span><span class="s3">;</span>

    <span class="s4">if </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">_getSubactions</span><span class="s3">) {</span>
      <span class="s4">this</span><span class="s3">.</span><span class="s1">_indent</span><span class="s3">();</span>
      <span class="s1">action</span><span class="s3">.</span><span class="s1">_getSubactions</span><span class="s3">().</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">subaction</span><span class="s3">) {</span>

        <span class="s4">var </span><span class="s1">invocationNew </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_formatActionInvocation</span><span class="s3">(</span><span class="s1">subaction</span><span class="s3">);</span>
        <span class="s1">invocations</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">invocationNew</span><span class="s3">);</span>
        <span class="s1">invocationLength </span><span class="s3">= </span><span class="s1">Math</span><span class="s3">.</span><span class="s1">max</span><span class="s3">(</span><span class="s1">invocationLength</span><span class="s3">, </span><span class="s1">invocationNew</span><span class="s3">.</span><span class="s1">length</span><span class="s3">);</span>

      <span class="s3">});</span>
      <span class="s4">this</span><span class="s3">.</span><span class="s1">_dedent</span><span class="s3">();</span>
    <span class="s3">}</span>

    <span class="s5">// update the maximum item length</span>
    <span class="s1">actionLength </span><span class="s3">= </span><span class="s1">invocationLength </span><span class="s3">+ </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent</span><span class="s3">;</span>
    <span class="s4">this</span><span class="s3">.</span><span class="s1">_actionMaxLength </span><span class="s3">= </span><span class="s1">Math</span><span class="s3">.</span><span class="s1">max</span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_actionMaxLength</span><span class="s3">, </span><span class="s1">actionLength</span><span class="s3">);</span>

    <span class="s5">// add the item to the list</span>
    <span class="s4">this</span><span class="s3">.</span><span class="s1">_addItem</span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_formatAction</span><span class="s3">, [ </span><span class="s1">action </span><span class="s3">]);</span>
  <span class="s3">}</span>
<span class="s3">};</span>

<span class="s0">/**</span>
 <span class="s0">* HelpFormatter#addArguments(actions) -&gt; Void</span>
 <span class="s0">* - actions (array): actions list</span>
 <span class="s0">*</span>
 <span class="s0">* Mass add arguments into current section</span>
 <span class="s0">*</span>
 <span class="s0">* ##### Example</span>
 <span class="s0">*</span>
 <span class="s0">*      formatter.startSection(actionGroup.title);</span>
 <span class="s0">*      formatter.addText(actionGroup.description);</span>
 <span class="s0">*      formatter.addArguments(actionGroup._groupActions);</span>
 <span class="s0">*      formatter.endSection();</span>
 <span class="s0">*</span>
 <span class="s0">**/</span>
<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">addArguments </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">actions</span><span class="s3">) {</span>
  <span class="s4">var </span><span class="s1">self </span><span class="s3">= </span><span class="s4">this</span><span class="s3">;</span>
  <span class="s1">actions</span><span class="s3">.</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">) {</span>
    <span class="s1">self</span><span class="s3">.</span><span class="s1">addArgument</span><span class="s3">(</span><span class="s1">action</span><span class="s3">);</span>
  <span class="s3">});</span>
<span class="s3">};</span>

<span class="s5">//</span>
<span class="s5">// Help-formatting methods</span>
<span class="s5">//</span>

<span class="s0">/**</span>
 <span class="s0">* HelpFormatter#formatHelp -&gt; string</span>
 <span class="s0">*</span>
 <span class="s0">* Format help</span>
 <span class="s0">*</span>
 <span class="s0">* ##### Example</span>
 <span class="s0">*</span>
 <span class="s0">*      formatter.addText(this.epilog);</span>
 <span class="s0">*      return formatter.formatHelp();</span>
 <span class="s0">*</span>
 <span class="s0">**/</span>
<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">formatHelp </span><span class="s3">= </span><span class="s4">function </span><span class="s3">() {</span>
  <span class="s4">var </span><span class="s1">help </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_rootSection</span><span class="s3">.</span><span class="s1">formatHelp</span><span class="s3">(</span><span class="s4">this</span><span class="s3">);</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s1">help</span><span class="s3">) {</span>
    <span class="s1">help </span><span class="s3">= </span><span class="s1">help</span><span class="s3">.</span><span class="s1">replace</span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_longBreakMatcher</span><span class="s3">, </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL </span><span class="s3">+ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">);</span>
    <span class="s1">help </span><span class="s3">= </span><span class="s1">$$</span><span class="s3">.</span><span class="s1">trimChars</span><span class="s3">(</span><span class="s1">help</span><span class="s3">, </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">) + </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">;</span>
  <span class="s3">}</span>
  <span class="s4">return </span><span class="s1">help</span><span class="s3">;</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_joinParts </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">partStrings</span><span class="s3">) {</span>
  <span class="s4">return </span><span class="s1">partStrings</span><span class="s3">.</span><span class="s1">filter</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">part</span><span class="s3">) {</span>
    <span class="s4">return </span><span class="s3">(</span><span class="s1">part </span><span class="s3">&amp;&amp; </span><span class="s1">part </span><span class="s3">!== </span><span class="s1">c</span><span class="s3">.</span><span class="s1">SUPPRESS</span><span class="s3">);</span>
  <span class="s3">}).</span><span class="s1">join</span><span class="s3">(</span><span class="s2">''</span><span class="s3">);</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_formatUsage </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">usage</span><span class="s3">, </span><span class="s1">actions</span><span class="s3">, </span><span class="s1">groups</span><span class="s3">, </span><span class="s1">prefix</span><span class="s3">) {</span>
  <span class="s4">if </span><span class="s3">(!</span><span class="s1">prefix </span><span class="s3">&amp;&amp; </span><span class="s4">typeof </span><span class="s1">prefix </span><span class="s3">!== </span><span class="s2">'string'</span><span class="s3">) {</span>
    <span class="s1">prefix </span><span class="s3">= </span><span class="s2">'usage: '</span><span class="s3">;</span>
  <span class="s3">}</span>

  <span class="s1">actions </span><span class="s3">= </span><span class="s1">actions </span><span class="s3">|| [];</span>
  <span class="s1">groups </span><span class="s3">= </span><span class="s1">groups </span><span class="s3">|| [];</span>


  <span class="s5">// if usage is specified, use that</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s1">usage</span><span class="s3">) {</span>
    <span class="s1">usage </span><span class="s3">= </span><span class="s1">sprintf</span><span class="s3">(</span><span class="s1">usage</span><span class="s3">, { </span><span class="s1">prog</span><span class="s3">: </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_prog </span><span class="s3">});</span>

    <span class="s5">// if no optionals or positionals are available, usage is just prog</span>
  <span class="s3">} </span><span class="s4">else if </span><span class="s3">(!</span><span class="s1">usage </span><span class="s3">&amp;&amp; </span><span class="s1">actions</span><span class="s3">.</span><span class="s1">length </span><span class="s3">=== </span><span class="s6">0</span><span class="s3">) {</span>
    <span class="s1">usage </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_prog</span><span class="s3">;</span>

    <span class="s5">// if optionals and positionals are available, calculate usage</span>
  <span class="s3">} </span><span class="s4">else if </span><span class="s3">(!</span><span class="s1">usage</span><span class="s3">) {</span>
    <span class="s4">var </span><span class="s1">prog </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_prog</span><span class="s3">;</span>
    <span class="s4">var </span><span class="s1">optionals </span><span class="s3">= [];</span>
    <span class="s4">var </span><span class="s1">positionals </span><span class="s3">= [];</span>
    <span class="s4">var </span><span class="s1">actionUsage</span><span class="s3">;</span>
    <span class="s4">var </span><span class="s1">textWidth</span><span class="s3">;</span>

    <span class="s5">// split optionals from positionals</span>
    <span class="s1">actions</span><span class="s3">.</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">) {</span>
      <span class="s4">if </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">isOptional</span><span class="s3">()) {</span>
        <span class="s1">optionals</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">action</span><span class="s3">);</span>
      <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
        <span class="s1">positionals</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">action</span><span class="s3">);</span>
      <span class="s3">}</span>
    <span class="s3">});</span>

    <span class="s5">// build full usage string</span>
    <span class="s1">actionUsage </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_formatActionsUsage</span><span class="s3">([].</span><span class="s1">concat</span><span class="s3">(</span><span class="s1">optionals</span><span class="s3">, </span><span class="s1">positionals</span><span class="s3">), </span><span class="s1">groups</span><span class="s3">);</span>
    <span class="s1">usage </span><span class="s3">= [ </span><span class="s1">prog</span><span class="s3">, </span><span class="s1">actionUsage </span><span class="s3">].</span><span class="s1">join</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">);</span>

    <span class="s5">// wrap the usage parts if it's too long</span>
    <span class="s1">textWidth </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_width </span><span class="s3">- </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent</span><span class="s3">;</span>
    <span class="s4">if </span><span class="s3">((</span><span class="s1">prefix</span><span class="s3">.</span><span class="s1">length </span><span class="s3">+ </span><span class="s1">usage</span><span class="s3">.</span><span class="s1">length</span><span class="s3">) &gt; </span><span class="s1">textWidth</span><span class="s3">) {</span>

      <span class="s5">// break usage into wrappable parts</span>
      <span class="s4">var </span><span class="s1">regexpPart </span><span class="s3">= </span><span class="s4">new </span><span class="s1">RegExp</span><span class="s3">(</span><span class="s2">'</span><span class="s4">\\</span><span class="s2">(.*?</span><span class="s4">\\</span><span class="s2">)+|</span><span class="s4">\\</span><span class="s2">[.*?</span><span class="s4">\\</span><span class="s2">]+|</span><span class="s4">\\</span><span class="s2">S+'</span><span class="s3">, </span><span class="s2">'g'</span><span class="s3">);</span>
      <span class="s4">var </span><span class="s1">optionalUsage </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_formatActionsUsage</span><span class="s3">(</span><span class="s1">optionals</span><span class="s3">, </span><span class="s1">groups</span><span class="s3">);</span>
      <span class="s4">var </span><span class="s1">positionalUsage </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_formatActionsUsage</span><span class="s3">(</span><span class="s1">positionals</span><span class="s3">, </span><span class="s1">groups</span><span class="s3">);</span>


      <span class="s4">var </span><span class="s1">optionalParts </span><span class="s3">= </span><span class="s1">optionalUsage</span><span class="s3">.</span><span class="s1">match</span><span class="s3">(</span><span class="s1">regexpPart</span><span class="s3">);</span>
      <span class="s4">var </span><span class="s1">positionalParts </span><span class="s3">= </span><span class="s1">positionalUsage</span><span class="s3">.</span><span class="s1">match</span><span class="s3">(</span><span class="s1">regexpPart</span><span class="s3">) || [];</span>

      <span class="s4">if </span><span class="s3">(</span><span class="s1">optionalParts</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">) !== </span><span class="s1">optionalUsage</span><span class="s3">) {</span>
        <span class="s4">throw new </span><span class="s1">Error</span><span class="s3">(</span><span class="s2">'assert &quot;optionalParts.join(</span><span class="s4">\' \'</span><span class="s2">) === optionalUsage&quot;'</span><span class="s3">);</span>
      <span class="s3">}</span>
      <span class="s4">if </span><span class="s3">(</span><span class="s1">positionalParts</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">) !== </span><span class="s1">positionalUsage</span><span class="s3">) {</span>
        <span class="s4">throw new </span><span class="s1">Error</span><span class="s3">(</span><span class="s2">'assert &quot;positionalParts.join(</span><span class="s4">\' \'</span><span class="s2">) === positionalUsage&quot;'</span><span class="s3">);</span>
      <span class="s3">}</span>

      <span class="s5">// helper for wrapping lines</span>
      <span class="s5">/*eslint-disable func-style*/ // node 0.10 compat</span>
      <span class="s4">var </span><span class="s1">_getLines </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">parts</span><span class="s3">, </span><span class="s1">indent</span><span class="s3">, </span><span class="s1">prefix</span><span class="s3">) {</span>
        <span class="s4">var </span><span class="s1">lines </span><span class="s3">= [];</span>
        <span class="s4">var </span><span class="s1">line </span><span class="s3">= [];</span>

        <span class="s4">var </span><span class="s1">lineLength </span><span class="s3">= </span><span class="s1">prefix </span><span class="s3">? </span><span class="s1">prefix</span><span class="s3">.</span><span class="s1">length </span><span class="s3">- </span><span class="s6">1 </span><span class="s3">: </span><span class="s1">indent</span><span class="s3">.</span><span class="s1">length </span><span class="s3">- </span><span class="s6">1</span><span class="s3">;</span>

        <span class="s1">parts</span><span class="s3">.</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">part</span><span class="s3">) {</span>
          <span class="s4">if </span><span class="s3">(</span><span class="s1">lineLength </span><span class="s3">+ </span><span class="s6">1 </span><span class="s3">+ </span><span class="s1">part</span><span class="s3">.</span><span class="s1">length </span><span class="s3">&gt; </span><span class="s1">textWidth</span><span class="s3">) {</span>
            <span class="s1">lines</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">indent </span><span class="s3">+ </span><span class="s1">line</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">));</span>
            <span class="s1">line </span><span class="s3">= [];</span>
            <span class="s1">lineLength </span><span class="s3">= </span><span class="s1">indent</span><span class="s3">.</span><span class="s1">length </span><span class="s3">- </span><span class="s6">1</span><span class="s3">;</span>
          <span class="s3">}</span>
          <span class="s1">line</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">part</span><span class="s3">);</span>
          <span class="s1">lineLength </span><span class="s3">+= </span><span class="s1">part</span><span class="s3">.</span><span class="s1">length </span><span class="s3">+ </span><span class="s6">1</span><span class="s3">;</span>
        <span class="s3">});</span>

        <span class="s4">if </span><span class="s3">(</span><span class="s1">line</span><span class="s3">) {</span>
          <span class="s1">lines</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">indent </span><span class="s3">+ </span><span class="s1">line</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">));</span>
        <span class="s3">}</span>
        <span class="s4">if </span><span class="s3">(</span><span class="s1">prefix</span><span class="s3">) {</span>
          <span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">] = </span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">substr</span><span class="s3">(</span><span class="s1">indent</span><span class="s3">.</span><span class="s1">length</span><span class="s3">);</span>
        <span class="s3">}</span>
        <span class="s4">return </span><span class="s1">lines</span><span class="s3">;</span>
      <span class="s3">};</span>

      <span class="s4">var </span><span class="s1">lines</span><span class="s3">, </span><span class="s1">indent</span><span class="s3">, </span><span class="s1">parts</span><span class="s3">;</span>
      <span class="s5">// if prog is short, follow it with optionals or positionals</span>
      <span class="s4">if </span><span class="s3">(</span><span class="s1">prefix</span><span class="s3">.</span><span class="s1">length </span><span class="s3">+ </span><span class="s1">prog</span><span class="s3">.</span><span class="s1">length </span><span class="s3">&lt;= </span><span class="s6">0.75 </span><span class="s3">* </span><span class="s1">textWidth</span><span class="s3">) {</span>
        <span class="s1">indent </span><span class="s3">= </span><span class="s1">$$</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">, (</span><span class="s1">prefix</span><span class="s3">.</span><span class="s1">length </span><span class="s3">+ </span><span class="s1">prog</span><span class="s3">.</span><span class="s1">length </span><span class="s3">+ </span><span class="s6">1</span><span class="s3">));</span>
        <span class="s4">if </span><span class="s3">(</span><span class="s1">optionalParts</span><span class="s3">) {</span>
          <span class="s1">lines </span><span class="s3">= [].</span><span class="s1">concat</span><span class="s3">(</span>
            <span class="s1">_getLines</span><span class="s3">([ </span><span class="s1">prog </span><span class="s3">].</span><span class="s1">concat</span><span class="s3">(</span><span class="s1">optionalParts</span><span class="s3">), </span><span class="s1">indent</span><span class="s3">, </span><span class="s1">prefix</span><span class="s3">),</span>
            <span class="s1">_getLines</span><span class="s3">(</span><span class="s1">positionalParts</span><span class="s3">, </span><span class="s1">indent</span><span class="s3">)</span>
          <span class="s3">);</span>
        <span class="s3">} </span><span class="s4">else if </span><span class="s3">(</span><span class="s1">positionalParts</span><span class="s3">) {</span>
          <span class="s1">lines </span><span class="s3">= </span><span class="s1">_getLines</span><span class="s3">([ </span><span class="s1">prog </span><span class="s3">].</span><span class="s1">concat</span><span class="s3">(</span><span class="s1">positionalParts</span><span class="s3">), </span><span class="s1">indent</span><span class="s3">, </span><span class="s1">prefix</span><span class="s3">);</span>
        <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
          <span class="s1">lines </span><span class="s3">= [ </span><span class="s1">prog </span><span class="s3">];</span>
        <span class="s3">}</span>

        <span class="s5">// if prog is long, put it on its own line</span>
      <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
        <span class="s1">indent </span><span class="s3">= </span><span class="s1">$$</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">, </span><span class="s1">prefix</span><span class="s3">.</span><span class="s1">length</span><span class="s3">);</span>
        <span class="s1">parts </span><span class="s3">= </span><span class="s1">optionalParts</span><span class="s3">.</span><span class="s1">concat</span><span class="s3">(</span><span class="s1">positionalParts</span><span class="s3">);</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">_getLines</span><span class="s3">(</span><span class="s1">parts</span><span class="s3">, </span><span class="s1">indent</span><span class="s3">);</span>
        <span class="s4">if </span><span class="s3">(</span><span class="s1">lines</span><span class="s3">.</span><span class="s1">length </span><span class="s3">&gt; </span><span class="s6">1</span><span class="s3">) {</span>
          <span class="s1">lines </span><span class="s3">= [].</span><span class="s1">concat</span><span class="s3">(</span>
            <span class="s1">_getLines</span><span class="s3">(</span><span class="s1">optionalParts</span><span class="s3">, </span><span class="s1">indent</span><span class="s3">),</span>
            <span class="s1">_getLines</span><span class="s3">(</span><span class="s1">positionalParts</span><span class="s3">, </span><span class="s1">indent</span><span class="s3">)</span>
          <span class="s3">);</span>
        <span class="s3">}</span>
        <span class="s1">lines </span><span class="s3">= [ </span><span class="s1">prog </span><span class="s3">].</span><span class="s1">concat</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">);</span>
      <span class="s3">}</span>
      <span class="s5">// join lines into usage</span>
      <span class="s1">usage </span><span class="s3">= </span><span class="s1">lines</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">);</span>
    <span class="s3">}</span>
  <span class="s3">}</span>

  <span class="s5">// prefix with 'usage:'</span>
  <span class="s4">return </span><span class="s1">prefix </span><span class="s3">+ </span><span class="s1">usage </span><span class="s3">+ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL </span><span class="s3">+ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">;</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_formatActionsUsage </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">actions</span><span class="s3">, </span><span class="s1">groups</span><span class="s3">) {</span>
  <span class="s5">// find group indices and identify actions in groups</span>
  <span class="s4">var </span><span class="s1">groupActions </span><span class="s3">= [];</span>
  <span class="s4">var </span><span class="s1">inserts </span><span class="s3">= [];</span>
  <span class="s4">var </span><span class="s1">self </span><span class="s3">= </span><span class="s4">this</span><span class="s3">;</span>

  <span class="s1">groups</span><span class="s3">.</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">group</span><span class="s3">) {</span>
    <span class="s4">var </span><span class="s1">end</span><span class="s3">;</span>
    <span class="s4">var </span><span class="s1">i</span><span class="s3">;</span>

    <span class="s4">var </span><span class="s1">start </span><span class="s3">= </span><span class="s1">actions</span><span class="s3">.</span><span class="s1">indexOf</span><span class="s3">(</span><span class="s1">group</span><span class="s3">.</span><span class="s1">_groupActions</span><span class="s3">[</span><span class="s6">0</span><span class="s3">]);</span>
    <span class="s4">if </span><span class="s3">(</span><span class="s1">start </span><span class="s3">&gt;= </span><span class="s6">0</span><span class="s3">) {</span>
      <span class="s1">end </span><span class="s3">= </span><span class="s1">start </span><span class="s3">+ </span><span class="s1">group</span><span class="s3">.</span><span class="s1">_groupActions</span><span class="s3">.</span><span class="s1">length</span><span class="s3">;</span>

      <span class="s5">//if (actions.slice(start, end) === group._groupActions) {</span>
      <span class="s4">if </span><span class="s3">(</span><span class="s1">$$</span><span class="s3">.</span><span class="s1">arrayEqual</span><span class="s3">(</span><span class="s1">actions</span><span class="s3">.</span><span class="s1">slice</span><span class="s3">(</span><span class="s1">start</span><span class="s3">, </span><span class="s1">end</span><span class="s3">), </span><span class="s1">group</span><span class="s3">.</span><span class="s1">_groupActions</span><span class="s3">)) {</span>
        <span class="s1">group</span><span class="s3">.</span><span class="s1">_groupActions</span><span class="s3">.</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">) {</span>
          <span class="s1">groupActions</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">action</span><span class="s3">);</span>
        <span class="s3">});</span>

        <span class="s4">if </span><span class="s3">(!</span><span class="s1">group</span><span class="s3">.</span><span class="s1">required</span><span class="s3">) {</span>
          <span class="s4">if </span><span class="s3">(</span><span class="s1">inserts</span><span class="s3">[</span><span class="s1">start</span><span class="s3">]) {</span>
            <span class="s1">inserts</span><span class="s3">[</span><span class="s1">start</span><span class="s3">] += </span><span class="s2">' ['</span><span class="s3">;</span>
          <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
            <span class="s1">inserts</span><span class="s3">[</span><span class="s1">start</span><span class="s3">] = </span><span class="s2">'['</span><span class="s3">;</span>
          <span class="s3">}</span>
          <span class="s1">inserts</span><span class="s3">[</span><span class="s1">end</span><span class="s3">] = </span><span class="s2">']'</span><span class="s3">;</span>
        <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
          <span class="s4">if </span><span class="s3">(</span><span class="s1">inserts</span><span class="s3">[</span><span class="s1">start</span><span class="s3">]) {</span>
            <span class="s1">inserts</span><span class="s3">[</span><span class="s1">start</span><span class="s3">] += </span><span class="s2">' ('</span><span class="s3">;</span>
          <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
            <span class="s1">inserts</span><span class="s3">[</span><span class="s1">start</span><span class="s3">] = </span><span class="s2">'('</span><span class="s3">;</span>
          <span class="s3">}</span>
          <span class="s1">inserts</span><span class="s3">[</span><span class="s1">end</span><span class="s3">] = </span><span class="s2">')'</span><span class="s3">;</span>
        <span class="s3">}</span>
        <span class="s4">for </span><span class="s3">(</span><span class="s1">i </span><span class="s3">= </span><span class="s1">start </span><span class="s3">+ </span><span class="s6">1</span><span class="s3">; </span><span class="s1">i </span><span class="s3">&lt; </span><span class="s1">end</span><span class="s3">; </span><span class="s1">i </span><span class="s3">+= </span><span class="s6">1</span><span class="s3">) {</span>
          <span class="s1">inserts</span><span class="s3">[</span><span class="s1">i</span><span class="s3">] = </span><span class="s2">'|'</span><span class="s3">;</span>
        <span class="s3">}</span>
      <span class="s3">}</span>
    <span class="s3">}</span>
  <span class="s3">});</span>

  <span class="s5">// collect all actions format strings</span>
  <span class="s4">var </span><span class="s1">parts </span><span class="s3">= [];</span>

  <span class="s1">actions</span><span class="s3">.</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">, </span><span class="s1">actionIndex</span><span class="s3">) {</span>
    <span class="s4">var </span><span class="s1">part</span><span class="s3">;</span>
    <span class="s4">var </span><span class="s1">optionString</span><span class="s3">;</span>
    <span class="s4">var </span><span class="s1">argsDefault</span><span class="s3">;</span>
    <span class="s4">var </span><span class="s1">argsString</span><span class="s3">;</span>

    <span class="s5">// suppressed arguments are marked with None</span>
    <span class="s5">// remove | separators for suppressed arguments</span>
    <span class="s4">if </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">help </span><span class="s3">=== </span><span class="s1">c</span><span class="s3">.</span><span class="s1">SUPPRESS</span><span class="s3">) {</span>
      <span class="s1">parts</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s4">null</span><span class="s3">);</span>
      <span class="s4">if </span><span class="s3">(</span><span class="s1">inserts</span><span class="s3">[</span><span class="s1">actionIndex</span><span class="s3">] === </span><span class="s2">'|'</span><span class="s3">) {</span>
        <span class="s1">inserts</span><span class="s3">.</span><span class="s1">splice</span><span class="s3">(</span><span class="s1">actionIndex</span><span class="s3">, </span><span class="s1">actionIndex</span><span class="s3">);</span>
      <span class="s3">} </span><span class="s4">else if </span><span class="s3">(</span><span class="s1">inserts</span><span class="s3">[</span><span class="s1">actionIndex </span><span class="s3">+ </span><span class="s6">1</span><span class="s3">] === </span><span class="s2">'|'</span><span class="s3">) {</span>
        <span class="s1">inserts</span><span class="s3">.</span><span class="s1">splice</span><span class="s3">(</span><span class="s1">actionIndex </span><span class="s3">+ </span><span class="s6">1</span><span class="s3">, </span><span class="s1">actionIndex </span><span class="s3">+ </span><span class="s6">1</span><span class="s3">);</span>
      <span class="s3">}</span>

      <span class="s5">// produce all arg strings</span>
    <span class="s3">} </span><span class="s4">else if </span><span class="s3">(!</span><span class="s1">action</span><span class="s3">.</span><span class="s1">isOptional</span><span class="s3">()) {</span>
      <span class="s1">part </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_formatArgs</span><span class="s3">(</span><span class="s1">action</span><span class="s3">, </span><span class="s1">action</span><span class="s3">.</span><span class="s1">dest</span><span class="s3">);</span>

      <span class="s5">// if it's in a group, strip the outer []</span>
      <span class="s4">if </span><span class="s3">(</span><span class="s1">groupActions</span><span class="s3">.</span><span class="s1">indexOf</span><span class="s3">(</span><span class="s1">action</span><span class="s3">) &gt;= </span><span class="s6">0</span><span class="s3">) {</span>
        <span class="s4">if </span><span class="s3">(</span><span class="s1">part</span><span class="s3">[</span><span class="s6">0</span><span class="s3">] === </span><span class="s2">'[' </span><span class="s3">&amp;&amp; </span><span class="s1">part</span><span class="s3">[</span><span class="s1">part</span><span class="s3">.</span><span class="s1">length </span><span class="s3">- </span><span class="s6">1</span><span class="s3">] === </span><span class="s2">']'</span><span class="s3">) {</span>
          <span class="s1">part </span><span class="s3">= </span><span class="s1">part</span><span class="s3">.</span><span class="s1">slice</span><span class="s3">(</span><span class="s6">1</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">);</span>
        <span class="s3">}</span>
      <span class="s3">}</span>
      <span class="s5">// add the action string to the list</span>
      <span class="s1">parts</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">part</span><span class="s3">);</span>

    <span class="s5">// produce the first way to invoke the option in brackets</span>
    <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
      <span class="s1">optionString </span><span class="s3">= </span><span class="s1">action</span><span class="s3">.</span><span class="s1">optionStrings</span><span class="s3">[</span><span class="s6">0</span><span class="s3">];</span>

      <span class="s5">// if the Optional doesn't take a value, format is: -s or --long</span>
      <span class="s4">if </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">nargs </span><span class="s3">=== </span><span class="s6">0</span><span class="s3">) {</span>
        <span class="s1">part </span><span class="s3">= </span><span class="s2">'' </span><span class="s3">+ </span><span class="s1">optionString</span><span class="s3">;</span>

      <span class="s5">// if the Optional takes a value, format is: -s ARGS or --long ARGS</span>
      <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
        <span class="s1">argsDefault </span><span class="s3">= </span><span class="s1">action</span><span class="s3">.</span><span class="s1">dest</span><span class="s3">.</span><span class="s1">toUpperCase</span><span class="s3">();</span>
        <span class="s1">argsString </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_formatArgs</span><span class="s3">(</span><span class="s1">action</span><span class="s3">, </span><span class="s1">argsDefault</span><span class="s3">);</span>
        <span class="s1">part </span><span class="s3">= </span><span class="s1">optionString </span><span class="s3">+ </span><span class="s2">' ' </span><span class="s3">+ </span><span class="s1">argsString</span><span class="s3">;</span>
      <span class="s3">}</span>
      <span class="s5">// make it look optional if it's not required or in a group</span>
      <span class="s4">if </span><span class="s3">(!</span><span class="s1">action</span><span class="s3">.</span><span class="s1">required </span><span class="s3">&amp;&amp; </span><span class="s1">groupActions</span><span class="s3">.</span><span class="s1">indexOf</span><span class="s3">(</span><span class="s1">action</span><span class="s3">) &lt; </span><span class="s6">0</span><span class="s3">) {</span>
        <span class="s1">part </span><span class="s3">= </span><span class="s2">'[' </span><span class="s3">+ </span><span class="s1">part </span><span class="s3">+ </span><span class="s2">']'</span><span class="s3">;</span>
      <span class="s3">}</span>
      <span class="s5">// add the action string to the list</span>
      <span class="s1">parts</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">part</span><span class="s3">);</span>
    <span class="s3">}</span>
  <span class="s3">});</span>

  <span class="s5">// insert things at the necessary indices</span>
  <span class="s4">for </span><span class="s3">(</span><span class="s4">var </span><span class="s1">i </span><span class="s3">= </span><span class="s1">inserts</span><span class="s3">.</span><span class="s1">length </span><span class="s3">- </span><span class="s6">1</span><span class="s3">; </span><span class="s1">i </span><span class="s3">&gt;= </span><span class="s6">0</span><span class="s3">; --</span><span class="s1">i</span><span class="s3">) {</span>
    <span class="s4">if </span><span class="s3">(</span><span class="s1">inserts</span><span class="s3">[</span><span class="s1">i</span><span class="s3">] !== </span><span class="s4">null</span><span class="s3">) {</span>
      <span class="s1">parts</span><span class="s3">.</span><span class="s1">splice</span><span class="s3">(</span><span class="s1">i</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s1">inserts</span><span class="s3">[</span><span class="s1">i</span><span class="s3">]);</span>
    <span class="s3">}</span>
  <span class="s3">}</span>

  <span class="s5">// join all the action items with spaces</span>
  <span class="s4">var </span><span class="s1">text </span><span class="s3">= </span><span class="s1">parts</span><span class="s3">.</span><span class="s1">filter</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">part</span><span class="s3">) {</span>
    <span class="s4">return </span><span class="s3">!!</span><span class="s1">part</span><span class="s3">;</span>
  <span class="s3">}).</span><span class="s1">join</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">);</span>

  <span class="s5">// clean up separators for mutually exclusive groups</span>
  <span class="s1">text </span><span class="s3">= </span><span class="s1">text</span><span class="s3">.</span><span class="s1">replace</span><span class="s3">(</span><span class="s7">/([\[(]) /g</span><span class="s3">, </span><span class="s2">'$1'</span><span class="s3">); </span><span class="s5">// remove spaces</span>
  <span class="s1">text </span><span class="s3">= </span><span class="s1">text</span><span class="s3">.</span><span class="s1">replace</span><span class="s3">(</span><span class="s7">/ ([\])])/g</span><span class="s3">, </span><span class="s2">'$1'</span><span class="s3">);</span>
  <span class="s1">text </span><span class="s3">= </span><span class="s1">text</span><span class="s3">.</span><span class="s1">replace</span><span class="s3">(</span><span class="s7">/\[ *\]/g</span><span class="s3">, </span><span class="s2">''</span><span class="s3">); </span><span class="s5">// remove empty groups</span>
  <span class="s1">text </span><span class="s3">= </span><span class="s1">text</span><span class="s3">.</span><span class="s1">replace</span><span class="s3">(</span><span class="s7">/\( *\)/g</span><span class="s3">, </span><span class="s2">''</span><span class="s3">);</span>
  <span class="s1">text </span><span class="s3">= </span><span class="s1">text</span><span class="s3">.</span><span class="s1">replace</span><span class="s3">(</span><span class="s7">/\(([^|]*)\)/g</span><span class="s3">, </span><span class="s2">'$1'</span><span class="s3">); </span><span class="s5">// remove () from single action groups</span>

  <span class="s1">text </span><span class="s3">= </span><span class="s1">text</span><span class="s3">.</span><span class="s1">trim</span><span class="s3">();</span>

  <span class="s5">// return the text</span>
  <span class="s4">return </span><span class="s1">text</span><span class="s3">;</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_formatText </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">text</span><span class="s3">) {</span>
  <span class="s1">text </span><span class="s3">= </span><span class="s1">sprintf</span><span class="s3">(</span><span class="s1">text</span><span class="s3">, { </span><span class="s1">prog</span><span class="s3">: </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_prog </span><span class="s3">});</span>
  <span class="s4">var </span><span class="s1">textWidth </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_width </span><span class="s3">- </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent</span><span class="s3">;</span>
  <span class="s4">var </span><span class="s1">indentIncriment </span><span class="s3">= </span><span class="s1">$$</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">, </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent</span><span class="s3">);</span>
  <span class="s4">return this</span><span class="s3">.</span><span class="s1">_fillText</span><span class="s3">(</span><span class="s1">text</span><span class="s3">, </span><span class="s1">textWidth</span><span class="s3">, </span><span class="s1">indentIncriment</span><span class="s3">) + </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL </span><span class="s3">+ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">;</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_formatAction </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">) {</span>
  <span class="s4">var </span><span class="s1">self </span><span class="s3">= </span><span class="s4">this</span><span class="s3">;</span>

  <span class="s4">var </span><span class="s1">helpText</span><span class="s3">;</span>
  <span class="s4">var </span><span class="s1">helpLines</span><span class="s3">;</span>
  <span class="s4">var </span><span class="s1">parts</span><span class="s3">;</span>
  <span class="s4">var </span><span class="s1">indentFirst</span><span class="s3">;</span>

  <span class="s5">// determine the required width and the entry label</span>
  <span class="s4">var </span><span class="s1">helpPosition </span><span class="s3">= </span><span class="s1">Math</span><span class="s3">.</span><span class="s1">min</span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_actionMaxLength </span><span class="s3">+ </span><span class="s6">2</span><span class="s3">, </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_maxHelpPosition</span><span class="s3">);</span>
  <span class="s4">var </span><span class="s1">helpWidth </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_width </span><span class="s3">- </span><span class="s1">helpPosition</span><span class="s3">;</span>
  <span class="s4">var </span><span class="s1">actionWidth </span><span class="s3">= </span><span class="s1">helpPosition </span><span class="s3">- </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent </span><span class="s3">- </span><span class="s6">2</span><span class="s3">;</span>
  <span class="s4">var </span><span class="s1">actionHeader </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_formatActionInvocation</span><span class="s3">(</span><span class="s1">action</span><span class="s3">);</span>

  <span class="s5">// no help; start on same line and add a final newline</span>
  <span class="s4">if </span><span class="s3">(!</span><span class="s1">action</span><span class="s3">.</span><span class="s1">help</span><span class="s3">) {</span>
    <span class="s1">actionHeader </span><span class="s3">= </span><span class="s1">$$</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">, </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent</span><span class="s3">) + </span><span class="s1">actionHeader </span><span class="s3">+ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">;</span>

  <span class="s5">// short action name; start on the same line and pad two spaces</span>
  <span class="s3">} </span><span class="s4">else if </span><span class="s3">(</span><span class="s1">actionHeader</span><span class="s3">.</span><span class="s1">length </span><span class="s3">&lt;= </span><span class="s1">actionWidth</span><span class="s3">) {</span>
    <span class="s1">actionHeader </span><span class="s3">= </span><span class="s1">$$</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">, </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent</span><span class="s3">) +</span>
        <span class="s1">actionHeader </span><span class="s3">+</span>
        <span class="s2">'  ' </span><span class="s3">+</span>
        <span class="s1">$$</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">, </span><span class="s1">actionWidth </span><span class="s3">- </span><span class="s1">actionHeader</span><span class="s3">.</span><span class="s1">length</span><span class="s3">);</span>
    <span class="s1">indentFirst </span><span class="s3">= </span><span class="s6">0</span><span class="s3">;</span>

  <span class="s5">// long action name; start on the next line</span>
  <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
    <span class="s1">actionHeader </span><span class="s3">= </span><span class="s1">$$</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">, </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_currentIndent</span><span class="s3">) + </span><span class="s1">actionHeader </span><span class="s3">+ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">;</span>
    <span class="s1">indentFirst </span><span class="s3">= </span><span class="s1">helpPosition</span><span class="s3">;</span>
  <span class="s3">}</span>

  <span class="s5">// collect the pieces of the action help</span>
  <span class="s1">parts </span><span class="s3">= [ </span><span class="s1">actionHeader </span><span class="s3">];</span>

  <span class="s5">// if there was help for the action, add lines of help text</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">help</span><span class="s3">) {</span>
    <span class="s1">helpText </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_expandHelp</span><span class="s3">(</span><span class="s1">action</span><span class="s3">);</span>
    <span class="s1">helpLines </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_splitLines</span><span class="s3">(</span><span class="s1">helpText</span><span class="s3">, </span><span class="s1">helpWidth</span><span class="s3">);</span>
    <span class="s1">parts</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">$$</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">, </span><span class="s1">indentFirst</span><span class="s3">) + </span><span class="s1">helpLines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">] + </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">);</span>
    <span class="s1">helpLines</span><span class="s3">.</span><span class="s1">slice</span><span class="s3">(</span><span class="s6">1</span><span class="s3">).</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">line</span><span class="s3">) {</span>
      <span class="s1">parts</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">$$</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">, </span><span class="s1">helpPosition</span><span class="s3">) + </span><span class="s1">line </span><span class="s3">+ </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">);</span>
    <span class="s3">});</span>

  <span class="s5">// or add a newline if the description doesn't end with one</span>
  <span class="s3">} </span><span class="s4">else if </span><span class="s3">(</span><span class="s1">actionHeader</span><span class="s3">.</span><span class="s1">charAt</span><span class="s3">(</span><span class="s1">actionHeader</span><span class="s3">.</span><span class="s1">length </span><span class="s3">- </span><span class="s6">1</span><span class="s3">) !== </span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">) {</span>
    <span class="s1">parts</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">);</span>
  <span class="s3">}</span>
  <span class="s5">// if there are any sub-actions, add their help as well</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">_getSubactions</span><span class="s3">) {</span>
    <span class="s4">this</span><span class="s3">.</span><span class="s1">_indent</span><span class="s3">();</span>
    <span class="s1">action</span><span class="s3">.</span><span class="s1">_getSubactions</span><span class="s3">().</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">subaction</span><span class="s3">) {</span>
      <span class="s1">parts</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">_formatAction</span><span class="s3">(</span><span class="s1">subaction</span><span class="s3">));</span>
    <span class="s3">});</span>
    <span class="s4">this</span><span class="s3">.</span><span class="s1">_dedent</span><span class="s3">();</span>
  <span class="s3">}</span>
  <span class="s5">// return a single string</span>
  <span class="s4">return this</span><span class="s3">.</span><span class="s1">_joinParts</span><span class="s3">(</span><span class="s1">parts</span><span class="s3">);</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_formatActionInvocation </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">) {</span>
  <span class="s4">if </span><span class="s3">(!</span><span class="s1">action</span><span class="s3">.</span><span class="s1">isOptional</span><span class="s3">()) {</span>
    <span class="s4">var </span><span class="s1">format_func </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_metavarFormatter</span><span class="s3">(</span><span class="s1">action</span><span class="s3">, </span><span class="s1">action</span><span class="s3">.</span><span class="s1">dest</span><span class="s3">);</span>
    <span class="s4">var </span><span class="s1">metavars </span><span class="s3">= </span><span class="s1">format_func</span><span class="s3">(</span><span class="s6">1</span><span class="s3">);</span>
    <span class="s4">return </span><span class="s1">metavars</span><span class="s3">[</span><span class="s6">0</span><span class="s3">];</span>
  <span class="s3">}</span>

  <span class="s4">var </span><span class="s1">parts </span><span class="s3">= [];</span>
  <span class="s4">var </span><span class="s1">argsDefault</span><span class="s3">;</span>
  <span class="s4">var </span><span class="s1">argsString</span><span class="s3">;</span>

  <span class="s5">// if the Optional doesn't take a value, format is: -s, --long</span>
  <span class="s4">if </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">nargs </span><span class="s3">=== </span><span class="s6">0</span><span class="s3">) {</span>
    <span class="s1">parts </span><span class="s3">= </span><span class="s1">parts</span><span class="s3">.</span><span class="s1">concat</span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">optionStrings</span><span class="s3">);</span>

  <span class="s5">// if the Optional takes a value, format is: -s ARGS, --long ARGS</span>
  <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
    <span class="s1">argsDefault </span><span class="s3">= </span><span class="s1">action</span><span class="s3">.</span><span class="s1">dest</span><span class="s3">.</span><span class="s1">toUpperCase</span><span class="s3">();</span>
    <span class="s1">argsString </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_formatArgs</span><span class="s3">(</span><span class="s1">action</span><span class="s3">, </span><span class="s1">argsDefault</span><span class="s3">);</span>
    <span class="s1">action</span><span class="s3">.</span><span class="s1">optionStrings</span><span class="s3">.</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">optionString</span><span class="s3">) {</span>
      <span class="s1">parts</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">optionString </span><span class="s3">+ </span><span class="s2">' ' </span><span class="s3">+ </span><span class="s1">argsString</span><span class="s3">);</span>
    <span class="s3">});</span>
  <span class="s3">}</span>
  <span class="s4">return </span><span class="s1">parts</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s2">', '</span><span class="s3">);</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_metavarFormatter </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">, </span><span class="s1">metavarDefault</span><span class="s3">) {</span>
  <span class="s4">var </span><span class="s1">result</span><span class="s3">;</span>

  <span class="s4">if </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">metavar </span><span class="s3">|| </span><span class="s1">action</span><span class="s3">.</span><span class="s1">metavar </span><span class="s3">=== </span><span class="s2">''</span><span class="s3">) {</span>
    <span class="s1">result </span><span class="s3">= </span><span class="s1">action</span><span class="s3">.</span><span class="s1">metavar</span><span class="s3">;</span>
  <span class="s3">} </span><span class="s4">else if </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">choices</span><span class="s3">) {</span>
    <span class="s4">var </span><span class="s1">choices </span><span class="s3">= </span><span class="s1">action</span><span class="s3">.</span><span class="s1">choices</span><span class="s3">;</span>

    <span class="s4">if </span><span class="s3">(</span><span class="s4">typeof </span><span class="s1">choices </span><span class="s3">=== </span><span class="s2">'string'</span><span class="s3">) {</span>
      <span class="s1">choices </span><span class="s3">= </span><span class="s1">choices</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s2">''</span><span class="s3">).</span><span class="s1">join</span><span class="s3">(</span><span class="s2">', '</span><span class="s3">);</span>
    <span class="s3">} </span><span class="s4">else if </span><span class="s3">(</span><span class="s1">Array</span><span class="s3">.</span><span class="s1">isArray</span><span class="s3">(</span><span class="s1">choices</span><span class="s3">)) {</span>
      <span class="s1">choices </span><span class="s3">= </span><span class="s1">choices</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s2">','</span><span class="s3">);</span>
    <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
      <span class="s1">choices </span><span class="s3">= </span><span class="s1">Object</span><span class="s3">.</span><span class="s1">keys</span><span class="s3">(</span><span class="s1">choices</span><span class="s3">).</span><span class="s1">join</span><span class="s3">(</span><span class="s2">','</span><span class="s3">);</span>
    <span class="s3">}</span>
    <span class="s1">result </span><span class="s3">= </span><span class="s2">'{' </span><span class="s3">+ </span><span class="s1">choices </span><span class="s3">+ </span><span class="s2">'}'</span><span class="s3">;</span>
  <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
    <span class="s1">result </span><span class="s3">= </span><span class="s1">metavarDefault</span><span class="s3">;</span>
  <span class="s3">}</span>

  <span class="s4">return function </span><span class="s3">(</span><span class="s1">size</span><span class="s3">) {</span>
    <span class="s4">if </span><span class="s3">(</span><span class="s1">Array</span><span class="s3">.</span><span class="s1">isArray</span><span class="s3">(</span><span class="s1">result</span><span class="s3">)) {</span>
      <span class="s4">return </span><span class="s1">result</span><span class="s3">;</span>
    <span class="s3">}</span>

    <span class="s4">var </span><span class="s1">metavars </span><span class="s3">= [];</span>
    <span class="s4">for </span><span class="s3">(</span><span class="s4">var </span><span class="s1">i </span><span class="s3">= </span><span class="s6">0</span><span class="s3">; </span><span class="s1">i </span><span class="s3">&lt; </span><span class="s1">size</span><span class="s3">; </span><span class="s1">i </span><span class="s3">+= </span><span class="s6">1</span><span class="s3">) {</span>
      <span class="s1">metavars</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">result</span><span class="s3">);</span>
    <span class="s3">}</span>
    <span class="s4">return </span><span class="s1">metavars</span><span class="s3">;</span>
  <span class="s3">};</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_formatArgs </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">, </span><span class="s1">metavarDefault</span><span class="s3">) {</span>
  <span class="s4">var </span><span class="s1">result</span><span class="s3">;</span>
  <span class="s4">var </span><span class="s1">metavars</span><span class="s3">;</span>

  <span class="s4">var </span><span class="s1">buildMetavar </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_metavarFormatter</span><span class="s3">(</span><span class="s1">action</span><span class="s3">, </span><span class="s1">metavarDefault</span><span class="s3">);</span>

  <span class="s4">switch </span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">nargs</span><span class="s3">) {</span>
    <span class="s5">/*eslint-disable no-undefined*/</span>
    <span class="s4">case </span><span class="s1">undefined</span><span class="s3">:</span>
    <span class="s4">case null</span><span class="s3">:</span>
      <span class="s1">metavars </span><span class="s3">= </span><span class="s1">buildMetavar</span><span class="s3">(</span><span class="s6">1</span><span class="s3">);</span>
      <span class="s1">result </span><span class="s3">= </span><span class="s2">'' </span><span class="s3">+ </span><span class="s1">metavars</span><span class="s3">[</span><span class="s6">0</span><span class="s3">];</span>
      <span class="s4">break</span><span class="s3">;</span>
    <span class="s4">case </span><span class="s1">c</span><span class="s3">.</span><span class="s1">OPTIONAL</span><span class="s3">:</span>
      <span class="s1">metavars </span><span class="s3">= </span><span class="s1">buildMetavar</span><span class="s3">(</span><span class="s6">1</span><span class="s3">);</span>
      <span class="s1">result </span><span class="s3">= </span><span class="s2">'[' </span><span class="s3">+ </span><span class="s1">metavars</span><span class="s3">[</span><span class="s6">0</span><span class="s3">] + </span><span class="s2">']'</span><span class="s3">;</span>
      <span class="s4">break</span><span class="s3">;</span>
    <span class="s4">case </span><span class="s1">c</span><span class="s3">.</span><span class="s1">ZERO_OR_MORE</span><span class="s3">:</span>
      <span class="s1">metavars </span><span class="s3">= </span><span class="s1">buildMetavar</span><span class="s3">(</span><span class="s6">2</span><span class="s3">);</span>
      <span class="s1">result </span><span class="s3">= </span><span class="s2">'[' </span><span class="s3">+ </span><span class="s1">metavars</span><span class="s3">[</span><span class="s6">0</span><span class="s3">] + </span><span class="s2">' [' </span><span class="s3">+ </span><span class="s1">metavars</span><span class="s3">[</span><span class="s6">1</span><span class="s3">] + </span><span class="s2">' ...]]'</span><span class="s3">;</span>
      <span class="s4">break</span><span class="s3">;</span>
    <span class="s4">case </span><span class="s1">c</span><span class="s3">.</span><span class="s1">ONE_OR_MORE</span><span class="s3">:</span>
      <span class="s1">metavars </span><span class="s3">= </span><span class="s1">buildMetavar</span><span class="s3">(</span><span class="s6">2</span><span class="s3">);</span>
      <span class="s1">result </span><span class="s3">= </span><span class="s2">'' </span><span class="s3">+ </span><span class="s1">metavars</span><span class="s3">[</span><span class="s6">0</span><span class="s3">] + </span><span class="s2">' [' </span><span class="s3">+ </span><span class="s1">metavars</span><span class="s3">[</span><span class="s6">1</span><span class="s3">] + </span><span class="s2">' ...]'</span><span class="s3">;</span>
      <span class="s4">break</span><span class="s3">;</span>
    <span class="s4">case </span><span class="s1">c</span><span class="s3">.</span><span class="s1">REMAINDER</span><span class="s3">:</span>
      <span class="s1">result </span><span class="s3">= </span><span class="s2">'...'</span><span class="s3">;</span>
      <span class="s4">break</span><span class="s3">;</span>
    <span class="s4">case </span><span class="s1">c</span><span class="s3">.</span><span class="s1">PARSER</span><span class="s3">:</span>
      <span class="s1">metavars </span><span class="s3">= </span><span class="s1">buildMetavar</span><span class="s3">(</span><span class="s6">1</span><span class="s3">);</span>
      <span class="s1">result </span><span class="s3">= </span><span class="s1">metavars</span><span class="s3">[</span><span class="s6">0</span><span class="s3">] + </span><span class="s2">' ...'</span><span class="s3">;</span>
      <span class="s4">break</span><span class="s3">;</span>
    <span class="s4">default</span><span class="s3">:</span>
      <span class="s1">metavars </span><span class="s3">= </span><span class="s1">buildMetavar</span><span class="s3">(</span><span class="s1">action</span><span class="s3">.</span><span class="s1">nargs</span><span class="s3">);</span>
      <span class="s1">result </span><span class="s3">= </span><span class="s1">metavars</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s2">' '</span><span class="s3">);</span>
  <span class="s3">}</span>
  <span class="s4">return </span><span class="s1">result</span><span class="s3">;</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_expandHelp </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">) {</span>
  <span class="s4">var </span><span class="s1">params </span><span class="s3">= { </span><span class="s1">prog</span><span class="s3">: </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_prog </span><span class="s3">};</span>

  <span class="s1">Object</span><span class="s3">.</span><span class="s1">keys</span><span class="s3">(</span><span class="s1">action</span><span class="s3">).</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">actionProperty</span><span class="s3">) {</span>
    <span class="s4">var </span><span class="s1">actionValue </span><span class="s3">= </span><span class="s1">action</span><span class="s3">[</span><span class="s1">actionProperty</span><span class="s3">];</span>

    <span class="s4">if </span><span class="s3">(</span><span class="s1">actionValue </span><span class="s3">!== </span><span class="s1">c</span><span class="s3">.</span><span class="s1">SUPPRESS</span><span class="s3">) {</span>
      <span class="s1">params</span><span class="s3">[</span><span class="s1">actionProperty</span><span class="s3">] = </span><span class="s1">actionValue</span><span class="s3">;</span>
    <span class="s3">}</span>
  <span class="s3">});</span>

  <span class="s4">if </span><span class="s3">(</span><span class="s1">params</span><span class="s3">.</span><span class="s1">choices</span><span class="s3">) {</span>
    <span class="s4">if </span><span class="s3">(</span><span class="s4">typeof </span><span class="s1">params</span><span class="s3">.</span><span class="s1">choices </span><span class="s3">=== </span><span class="s2">'string'</span><span class="s3">) {</span>
      <span class="s1">params</span><span class="s3">.</span><span class="s1">choices </span><span class="s3">= </span><span class="s1">params</span><span class="s3">.</span><span class="s1">choices</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s2">''</span><span class="s3">).</span><span class="s1">join</span><span class="s3">(</span><span class="s2">', '</span><span class="s3">);</span>
    <span class="s3">} </span><span class="s4">else if </span><span class="s3">(</span><span class="s1">Array</span><span class="s3">.</span><span class="s1">isArray</span><span class="s3">(</span><span class="s1">params</span><span class="s3">.</span><span class="s1">choices</span><span class="s3">)) {</span>
      <span class="s1">params</span><span class="s3">.</span><span class="s1">choices </span><span class="s3">= </span><span class="s1">params</span><span class="s3">.</span><span class="s1">choices</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s2">', '</span><span class="s3">);</span>
    <span class="s3">} </span><span class="s4">else </span><span class="s3">{</span>
      <span class="s1">params</span><span class="s3">.</span><span class="s1">choices </span><span class="s3">= </span><span class="s1">Object</span><span class="s3">.</span><span class="s1">keys</span><span class="s3">(</span><span class="s1">params</span><span class="s3">.</span><span class="s1">choices</span><span class="s3">).</span><span class="s1">join</span><span class="s3">(</span><span class="s2">', '</span><span class="s3">);</span>
    <span class="s3">}</span>
  <span class="s3">}</span>

  <span class="s4">return </span><span class="s1">sprintf</span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_getHelpString</span><span class="s3">(</span><span class="s1">action</span><span class="s3">), </span><span class="s1">params</span><span class="s3">);</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_splitLines </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">text</span><span class="s3">, </span><span class="s1">width</span><span class="s3">) {</span>
  <span class="s4">var </span><span class="s1">lines </span><span class="s3">= [];</span>
  <span class="s4">var </span><span class="s1">delimiters </span><span class="s3">= [ </span><span class="s2">' '</span><span class="s3">, </span><span class="s2">'.'</span><span class="s3">, </span><span class="s2">','</span><span class="s3">, </span><span class="s2">'!'</span><span class="s3">, </span><span class="s2">'?' </span><span class="s3">];</span>
  <span class="s4">var </span><span class="s1">re </span><span class="s3">= </span><span class="s4">new </span><span class="s1">RegExp</span><span class="s3">(</span><span class="s2">'[' </span><span class="s3">+ </span><span class="s1">delimiters</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s2">''</span><span class="s3">) + </span><span class="s2">'][^' </span><span class="s3">+ </span><span class="s1">delimiters</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s2">''</span><span class="s3">) + </span><span class="s2">']*$'</span><span class="s3">);</span>

  <span class="s1">text </span><span class="s3">= </span><span class="s1">text</span><span class="s3">.</span><span class="s1">replace</span><span class="s3">(</span><span class="s7">/[\n\|\t]/g</span><span class="s3">, </span><span class="s2">' '</span><span class="s3">);</span>

  <span class="s1">text </span><span class="s3">= </span><span class="s1">text</span><span class="s3">.</span><span class="s1">trim</span><span class="s3">();</span>
  <span class="s1">text </span><span class="s3">= </span><span class="s1">text</span><span class="s3">.</span><span class="s1">replace</span><span class="s3">(</span><span class="s4">this</span><span class="s3">.</span><span class="s1">_whitespaceMatcher</span><span class="s3">, </span><span class="s2">' '</span><span class="s3">);</span>

  <span class="s5">// Wraps the single paragraph in text (a string) so every line</span>
  <span class="s5">// is at most width characters long.</span>
  <span class="s1">text</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">).</span><span class="s1">forEach</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">line</span><span class="s3">) {</span>
    <span class="s4">if </span><span class="s3">(</span><span class="s1">width </span><span class="s3">&gt;= </span><span class="s1">line</span><span class="s3">.</span><span class="s1">length</span><span class="s3">) {</span>
      <span class="s1">lines</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">line</span><span class="s3">);</span>
      <span class="s4">return</span><span class="s3">;</span>
    <span class="s3">}</span>

    <span class="s4">var </span><span class="s1">wrapStart </span><span class="s3">= </span><span class="s6">0</span><span class="s3">;</span>
    <span class="s4">var </span><span class="s1">wrapEnd </span><span class="s3">= </span><span class="s1">width</span><span class="s3">;</span>
    <span class="s4">var </span><span class="s1">delimiterIndex </span><span class="s3">= </span><span class="s6">0</span><span class="s3">;</span>
    <span class="s4">while </span><span class="s3">(</span><span class="s1">wrapEnd </span><span class="s3">&lt;= </span><span class="s1">line</span><span class="s3">.</span><span class="s1">length</span><span class="s3">) {</span>
      <span class="s4">if </span><span class="s3">(</span><span class="s1">wrapEnd </span><span class="s3">!== </span><span class="s1">line</span><span class="s3">.</span><span class="s1">length </span><span class="s3">&amp;&amp; </span><span class="s1">delimiters</span><span class="s3">.</span><span class="s1">indexOf</span><span class="s3">(</span><span class="s1">line</span><span class="s3">[</span><span class="s1">wrapEnd</span><span class="s3">] &lt; -</span><span class="s6">1</span><span class="s3">)) {</span>
        <span class="s1">delimiterIndex </span><span class="s3">= (</span><span class="s1">re</span><span class="s3">.</span><span class="s1">exec</span><span class="s3">(</span><span class="s1">line</span><span class="s3">.</span><span class="s1">substring</span><span class="s3">(</span><span class="s1">wrapStart</span><span class="s3">, </span><span class="s1">wrapEnd</span><span class="s3">)) || {}).</span><span class="s1">index</span><span class="s3">;</span>
        <span class="s1">wrapEnd </span><span class="s3">= </span><span class="s1">wrapStart </span><span class="s3">+ </span><span class="s1">delimiterIndex </span><span class="s3">+ </span><span class="s6">1</span><span class="s3">;</span>
      <span class="s3">}</span>
      <span class="s1">lines</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">line</span><span class="s3">.</span><span class="s1">substring</span><span class="s3">(</span><span class="s1">wrapStart</span><span class="s3">, </span><span class="s1">wrapEnd</span><span class="s3">));</span>
      <span class="s1">wrapStart </span><span class="s3">= </span><span class="s1">wrapEnd</span><span class="s3">;</span>
      <span class="s1">wrapEnd </span><span class="s3">+= </span><span class="s1">width</span><span class="s3">;</span>
    <span class="s3">}</span>
    <span class="s4">if </span><span class="s3">(</span><span class="s1">wrapStart </span><span class="s3">&lt; </span><span class="s1">line</span><span class="s3">.</span><span class="s1">length</span><span class="s3">) {</span>
      <span class="s1">lines</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">line</span><span class="s3">.</span><span class="s1">substring</span><span class="s3">(</span><span class="s1">wrapStart</span><span class="s3">, </span><span class="s1">wrapEnd</span><span class="s3">));</span>
    <span class="s3">}</span>
  <span class="s3">});</span>

  <span class="s4">return </span><span class="s1">lines</span><span class="s3">;</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_fillText </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">text</span><span class="s3">, </span><span class="s1">width</span><span class="s3">, </span><span class="s1">indent</span><span class="s3">) {</span>
  <span class="s4">var </span><span class="s1">lines </span><span class="s3">= </span><span class="s4">this</span><span class="s3">.</span><span class="s1">_splitLines</span><span class="s3">(</span><span class="s1">text</span><span class="s3">, </span><span class="s1">width</span><span class="s3">);</span>
  <span class="s1">lines </span><span class="s3">= </span><span class="s1">lines</span><span class="s3">.</span><span class="s1">map</span><span class="s3">(</span><span class="s4">function </span><span class="s3">(</span><span class="s1">line</span><span class="s3">) {</span>
    <span class="s4">return </span><span class="s1">indent </span><span class="s3">+ </span><span class="s1">line</span><span class="s3">;</span>
  <span class="s3">});</span>
  <span class="s4">return </span><span class="s1">lines</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">c</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">);</span>
<span class="s3">};</span>

<span class="s1">HelpFormatter</span><span class="s3">.</span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">_getHelpString </span><span class="s3">= </span><span class="s4">function </span><span class="s3">(</span><span class="s1">action</span><span class="s3">) {</span>
  <span class="s4">return </span><span class="s1">action</span><span class="s3">.</span><span class="s1">help</span><span class="s3">;</span>
<span class="s3">};</span>
</pre>
</body>
</html>