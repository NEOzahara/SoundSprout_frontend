<html>
<head>
<title>indent-legacy.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #67a37c; font-style: italic;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #bcbec4;}
.s5 { color: #7a7e85;}
.s6 { color: #cf8e6d;}
.s7 { color: #2aacb8;}
.s8 { color: #42c3d4;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
indent-legacy.js</font>
</center></td></tr></table>
<pre><span class="s0">/**</span>
 <span class="s0">* </span><span class="s1">@fileoverview </span><span class="s0">This option sets a specific tab width for your code</span>
 <span class="s0">*</span>
 <span class="s0">* This rule has been ported and modified from nodeca.</span>
 <span class="s0">* </span><span class="s1">@author </span><span class="s0">Vitaly Puzrin</span>
 <span class="s0">* </span><span class="s1">@author </span><span class="s0">Gyandeep Singh</span>
 <span class="s0">* </span><span class="s1">@deprecated </span><span class="s0">in ESLint v4.0.0</span>
 <span class="s0">*/</span>

<span class="s3">&quot;use strict&quot;</span><span class="s4">;</span>

<span class="s5">//------------------------------------------------------------------------------</span>
<span class="s5">// Requirements</span>
<span class="s5">//------------------------------------------------------------------------------</span>

<span class="s6">const </span><span class="s2">astUtils </span><span class="s4">= </span><span class="s2">require</span><span class="s4">(</span><span class="s3">&quot;./utils/ast-utils&quot;</span><span class="s4">);</span>

<span class="s5">//------------------------------------------------------------------------------</span>
<span class="s5">// Rule Definition</span>
<span class="s5">//------------------------------------------------------------------------------</span>
<span class="s5">// this rule has known coverage issues, but it's deprecated and shouldn't be updated in the future anyway.</span>
<span class="s5">/* c8 ignore next */</span>
<span class="s0">/** </span><span class="s1">@type </span><span class="s0">{import('../shared/types').Rule} */</span>
<span class="s2">module</span><span class="s4">.</span><span class="s2">exports </span><span class="s4">= {</span>
    <span class="s2">meta</span><span class="s4">: {</span>
        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;layout&quot;</span><span class="s4">,</span>

        <span class="s2">docs</span><span class="s4">: {</span>
            <span class="s2">description</span><span class="s4">: </span><span class="s3">&quot;Enforce consistent indentation&quot;</span><span class="s4">,</span>
            <span class="s2">recommended</span><span class="s4">: </span><span class="s6">false</span><span class="s4">,</span>
            <span class="s2">url</span><span class="s4">: </span><span class="s3">&quot;https://eslint.org/docs/latest/rules/indent-legacy&quot;</span>
        <span class="s4">},</span>

        <span class="s2">deprecated</span><span class="s4">: </span><span class="s6">true</span><span class="s4">,</span>

        <span class="s2">replacedBy</span><span class="s4">: [</span><span class="s3">&quot;indent&quot;</span><span class="s4">],</span>

        <span class="s2">fixable</span><span class="s4">: </span><span class="s3">&quot;whitespace&quot;</span><span class="s4">,</span>

        <span class="s2">schema</span><span class="s4">: [</span>
            <span class="s4">{</span>
                <span class="s2">oneOf</span><span class="s4">: [</span>
                    <span class="s4">{</span>
                        <span class="s6">enum</span><span class="s4">: [</span><span class="s3">&quot;tab&quot;</span><span class="s4">]</span>
                    <span class="s4">},</span>
                    <span class="s4">{</span>
                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                        <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                    <span class="s4">}</span>
                <span class="s4">]</span>
            <span class="s4">},</span>
            <span class="s4">{</span>
                <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;object&quot;</span><span class="s4">,</span>
                <span class="s2">properties</span><span class="s4">: {</span>
                    <span class="s2">SwitchCase</span><span class="s4">: {</span>
                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                        <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                    <span class="s4">},</span>
                    <span class="s2">VariableDeclarator</span><span class="s4">: {</span>
                        <span class="s2">oneOf</span><span class="s4">: [</span>
                            <span class="s4">{</span>
                                <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                            <span class="s4">},</span>
                            <span class="s4">{</span>
                                <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;object&quot;</span><span class="s4">,</span>
                                <span class="s2">properties</span><span class="s4">: {</span>
                                    <span class="s6">var</span><span class="s4">: {</span>
                                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                        <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                                    <span class="s4">},</span>
                                    <span class="s6">let</span><span class="s4">: {</span>
                                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                        <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                                    <span class="s4">},</span>
                                    <span class="s6">const</span><span class="s4">: {</span>
                                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                        <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                                    <span class="s4">}</span>
                                <span class="s4">}</span>
                            <span class="s4">}</span>
                        <span class="s4">]</span>
                    <span class="s4">},</span>
                    <span class="s2">outerIIFEBody</span><span class="s4">: {</span>
                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                        <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                    <span class="s4">},</span>
                    <span class="s2">MemberExpression</span><span class="s4">: {</span>
                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                        <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                    <span class="s4">},</span>
                    <span class="s2">FunctionDeclaration</span><span class="s4">: {</span>
                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;object&quot;</span><span class="s4">,</span>
                        <span class="s2">properties</span><span class="s4">: {</span>
                            <span class="s2">parameters</span><span class="s4">: {</span>
                                <span class="s2">oneOf</span><span class="s4">: [</span>
                                    <span class="s4">{</span>
                                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                        <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                                    <span class="s4">},</span>
                                    <span class="s4">{</span>
                                        <span class="s6">enum</span><span class="s4">: [</span><span class="s3">&quot;first&quot;</span><span class="s4">]</span>
                                    <span class="s4">}</span>
                                <span class="s4">]</span>
                            <span class="s4">},</span>
                            <span class="s2">body</span><span class="s4">: {</span>
                                <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                            <span class="s4">}</span>
                        <span class="s4">}</span>
                    <span class="s4">},</span>
                    <span class="s2">FunctionExpression</span><span class="s4">: {</span>
                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;object&quot;</span><span class="s4">,</span>
                        <span class="s2">properties</span><span class="s4">: {</span>
                            <span class="s2">parameters</span><span class="s4">: {</span>
                                <span class="s2">oneOf</span><span class="s4">: [</span>
                                    <span class="s4">{</span>
                                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                        <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                                    <span class="s4">},</span>
                                    <span class="s4">{</span>
                                        <span class="s6">enum</span><span class="s4">: [</span><span class="s3">&quot;first&quot;</span><span class="s4">]</span>
                                    <span class="s4">}</span>
                                <span class="s4">]</span>
                            <span class="s4">},</span>
                            <span class="s2">body</span><span class="s4">: {</span>
                                <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                            <span class="s4">}</span>
                        <span class="s4">}</span>
                    <span class="s4">},</span>
                    <span class="s2">CallExpression</span><span class="s4">: {</span>
                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;object&quot;</span><span class="s4">,</span>
                        <span class="s2">properties</span><span class="s4">: {</span>
                            <span class="s2">parameters</span><span class="s4">: {</span>
                                <span class="s2">oneOf</span><span class="s4">: [</span>
                                    <span class="s4">{</span>
                                        <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                        <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                                    <span class="s4">},</span>
                                    <span class="s4">{</span>
                                        <span class="s6">enum</span><span class="s4">: [</span><span class="s3">&quot;first&quot;</span><span class="s4">]</span>
                                    <span class="s4">}</span>
                                <span class="s4">]</span>
                            <span class="s4">}</span>
                        <span class="s4">}</span>
                    <span class="s4">},</span>
                    <span class="s2">ArrayExpression</span><span class="s4">: {</span>
                        <span class="s2">oneOf</span><span class="s4">: [</span>
                            <span class="s4">{</span>
                                <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                            <span class="s4">},</span>
                            <span class="s4">{</span>
                                <span class="s6">enum</span><span class="s4">: [</span><span class="s3">&quot;first&quot;</span><span class="s4">]</span>
                            <span class="s4">}</span>
                        <span class="s4">]</span>
                    <span class="s4">},</span>
                    <span class="s2">ObjectExpression</span><span class="s4">: {</span>
                        <span class="s2">oneOf</span><span class="s4">: [</span>
                            <span class="s4">{</span>
                                <span class="s2">type</span><span class="s4">: </span><span class="s3">&quot;integer&quot;</span><span class="s4">,</span>
                                <span class="s2">minimum</span><span class="s4">: </span><span class="s7">0</span>
                            <span class="s4">},</span>
                            <span class="s4">{</span>
                                <span class="s6">enum</span><span class="s4">: [</span><span class="s3">&quot;first&quot;</span><span class="s4">]</span>
                            <span class="s4">}</span>
                        <span class="s4">]</span>
                    <span class="s4">}</span>
                <span class="s4">},</span>
                <span class="s2">additionalProperties</span><span class="s4">: </span><span class="s6">false</span>
            <span class="s4">}</span>
        <span class="s4">],</span>
        <span class="s2">messages</span><span class="s4">: {</span>
            <span class="s2">expected</span><span class="s4">: </span><span class="s3">&quot;Expected indentation of {{expected}} but found {{actual}}.&quot;</span>
        <span class="s4">}</span>
    <span class="s4">},</span>

    <span class="s2">create</span><span class="s4">(</span><span class="s2">context</span><span class="s4">) {</span>
        <span class="s6">const </span><span class="s2">DEFAULT_VARIABLE_INDENT </span><span class="s4">= </span><span class="s7">1</span><span class="s4">;</span>
        <span class="s6">const </span><span class="s2">DEFAULT_PARAMETER_INDENT </span><span class="s4">= </span><span class="s6">null</span><span class="s4">; </span><span class="s5">// For backwards compatibility, don't check parameter indentation unless specified in the config</span>
        <span class="s6">const </span><span class="s2">DEFAULT_FUNCTION_BODY_INDENT </span><span class="s4">= </span><span class="s7">1</span><span class="s4">;</span>

        <span class="s6">let </span><span class="s2">indentType </span><span class="s4">= </span><span class="s3">&quot;space&quot;</span><span class="s4">;</span>
        <span class="s6">let </span><span class="s2">indentSize </span><span class="s4">= </span><span class="s7">4</span><span class="s4">;</span>
        <span class="s6">const </span><span class="s2">options </span><span class="s4">= {</span>
            <span class="s2">SwitchCase</span><span class="s4">: </span><span class="s7">0</span><span class="s4">,</span>
            <span class="s2">VariableDeclarator</span><span class="s4">: {</span>
                <span class="s6">var</span><span class="s4">: </span><span class="s2">DEFAULT_VARIABLE_INDENT</span><span class="s4">,</span>
                <span class="s6">let</span><span class="s4">: </span><span class="s2">DEFAULT_VARIABLE_INDENT</span><span class="s4">,</span>
                <span class="s6">const</span><span class="s4">: </span><span class="s2">DEFAULT_VARIABLE_INDENT</span>
            <span class="s4">},</span>
            <span class="s2">outerIIFEBody</span><span class="s4">: </span><span class="s6">null</span><span class="s4">,</span>
            <span class="s2">FunctionDeclaration</span><span class="s4">: {</span>
                <span class="s2">parameters</span><span class="s4">: </span><span class="s2">DEFAULT_PARAMETER_INDENT</span><span class="s4">,</span>
                <span class="s2">body</span><span class="s4">: </span><span class="s2">DEFAULT_FUNCTION_BODY_INDENT</span>
            <span class="s4">},</span>
            <span class="s2">FunctionExpression</span><span class="s4">: {</span>
                <span class="s2">parameters</span><span class="s4">: </span><span class="s2">DEFAULT_PARAMETER_INDENT</span><span class="s4">,</span>
                <span class="s2">body</span><span class="s4">: </span><span class="s2">DEFAULT_FUNCTION_BODY_INDENT</span>
            <span class="s4">},</span>
            <span class="s2">CallExpression</span><span class="s4">: {</span>
                <span class="s2">arguments</span><span class="s4">: </span><span class="s2">DEFAULT_PARAMETER_INDENT</span>
            <span class="s4">},</span>
            <span class="s2">ArrayExpression</span><span class="s4">: </span><span class="s7">1</span><span class="s4">,</span>
            <span class="s2">ObjectExpression</span><span class="s4">: </span><span class="s7">1</span>
        <span class="s4">};</span>

        <span class="s6">const </span><span class="s2">sourceCode </span><span class="s4">= </span><span class="s2">context</span><span class="s4">.</span><span class="s2">sourceCode</span><span class="s4">;</span>

        <span class="s6">if </span><span class="s4">(</span><span class="s2">context</span><span class="s4">.</span><span class="s2">options</span><span class="s4">.</span><span class="s2">length</span><span class="s4">) {</span>
            <span class="s6">if </span><span class="s4">(</span><span class="s2">context</span><span class="s4">.</span><span class="s2">options</span><span class="s4">[</span><span class="s7">0</span><span class="s4">] === </span><span class="s3">&quot;tab&quot;</span><span class="s4">) {</span>
                <span class="s2">indentSize </span><span class="s4">= </span><span class="s7">1</span><span class="s4">;</span>
                <span class="s2">indentType </span><span class="s4">= </span><span class="s3">&quot;tab&quot;</span><span class="s4">;</span>
            <span class="s4">} </span><span class="s6">else </span><span class="s5">/* c8 ignore start */ </span><span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">context</span><span class="s4">.</span><span class="s2">options</span><span class="s4">[</span><span class="s7">0</span><span class="s4">] === </span><span class="s3">&quot;number&quot;</span><span class="s4">) {</span>
                <span class="s2">indentSize </span><span class="s4">= </span><span class="s2">context</span><span class="s4">.</span><span class="s2">options</span><span class="s4">[</span><span class="s7">0</span><span class="s4">];</span>
                <span class="s2">indentType </span><span class="s4">= </span><span class="s3">&quot;space&quot;</span><span class="s4">;</span>
            <span class="s4">}</span><span class="s5">/* c8 ignore stop */</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">context</span><span class="s4">.</span><span class="s2">options</span><span class="s4">[</span><span class="s7">1</span><span class="s4">]) {</span>
                <span class="s6">const </span><span class="s2">opts </span><span class="s4">= </span><span class="s2">context</span><span class="s4">.</span><span class="s2">options</span><span class="s4">[</span><span class="s7">1</span><span class="s4">];</span>

                <span class="s2">options</span><span class="s4">.</span><span class="s2">SwitchCase </span><span class="s4">= </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">SwitchCase </span><span class="s4">|| </span><span class="s7">0</span><span class="s4">;</span>
                <span class="s6">const </span><span class="s2">variableDeclaratorRules </span><span class="s4">= </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">VariableDeclarator</span><span class="s4">;</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">variableDeclaratorRules </span><span class="s4">=== </span><span class="s3">&quot;number&quot;</span><span class="s4">) {</span>
                    <span class="s2">options</span><span class="s4">.</span><span class="s2">VariableDeclarator </span><span class="s4">= {</span>
                        <span class="s6">var</span><span class="s4">: </span><span class="s2">variableDeclaratorRules</span><span class="s4">,</span>
                        <span class="s6">let</span><span class="s4">: </span><span class="s2">variableDeclaratorRules</span><span class="s4">,</span>
                        <span class="s6">const</span><span class="s4">: </span><span class="s2">variableDeclaratorRules</span>
                    <span class="s4">};</span>
                <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">variableDeclaratorRules </span><span class="s4">=== </span><span class="s3">&quot;object&quot;</span><span class="s4">) {</span>
                    <span class="s2">Object</span><span class="s4">.</span><span class="s2">assign</span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">VariableDeclarator</span><span class="s4">, </span><span class="s2">variableDeclaratorRules</span><span class="s4">);</span>
                <span class="s4">}</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">outerIIFEBody </span><span class="s4">=== </span><span class="s3">&quot;number&quot;</span><span class="s4">) {</span>
                    <span class="s2">options</span><span class="s4">.</span><span class="s2">outerIIFEBody </span><span class="s4">= </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">outerIIFEBody</span><span class="s4">;</span>
                <span class="s4">}</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">MemberExpression </span><span class="s4">=== </span><span class="s3">&quot;number&quot;</span><span class="s4">) {</span>
                    <span class="s2">options</span><span class="s4">.</span><span class="s2">MemberExpression </span><span class="s4">= </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">MemberExpression</span><span class="s4">;</span>
                <span class="s4">}</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">FunctionDeclaration </span><span class="s4">=== </span><span class="s3">&quot;object&quot;</span><span class="s4">) {</span>
                    <span class="s2">Object</span><span class="s4">.</span><span class="s2">assign</span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">FunctionDeclaration</span><span class="s4">, </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">FunctionDeclaration</span><span class="s4">);</span>
                <span class="s4">}</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">FunctionExpression </span><span class="s4">=== </span><span class="s3">&quot;object&quot;</span><span class="s4">) {</span>
                    <span class="s2">Object</span><span class="s4">.</span><span class="s2">assign</span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">FunctionExpression</span><span class="s4">, </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">FunctionExpression</span><span class="s4">);</span>
                <span class="s4">}</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">CallExpression </span><span class="s4">=== </span><span class="s3">&quot;object&quot;</span><span class="s4">) {</span>
                    <span class="s2">Object</span><span class="s4">.</span><span class="s2">assign</span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">CallExpression</span><span class="s4">, </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">CallExpression</span><span class="s4">);</span>
                <span class="s4">}</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">ArrayExpression </span><span class="s4">=== </span><span class="s3">&quot;number&quot; </span><span class="s4">|| </span><span class="s6">typeof </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">ArrayExpression </span><span class="s4">=== </span><span class="s3">&quot;string&quot;</span><span class="s4">) {</span>
                    <span class="s2">options</span><span class="s4">.</span><span class="s2">ArrayExpression </span><span class="s4">= </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">ArrayExpression</span><span class="s4">;</span>
                <span class="s4">}</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">ObjectExpression </span><span class="s4">=== </span><span class="s3">&quot;number&quot; </span><span class="s4">|| </span><span class="s6">typeof </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">ObjectExpression </span><span class="s4">=== </span><span class="s3">&quot;string&quot;</span><span class="s4">) {</span>
                    <span class="s2">options</span><span class="s4">.</span><span class="s2">ObjectExpression </span><span class="s4">= </span><span class="s2">opts</span><span class="s4">.</span><span class="s2">ObjectExpression</span><span class="s4">;</span>
                <span class="s4">}</span>
            <span class="s4">}</span>
        <span class="s4">}</span>

        <span class="s6">const </span><span class="s2">caseIndentStore </span><span class="s4">= {};</span>

        <span class="s0">/**</span>
         <span class="s0">* Creates an error message for a line, given the expected/actual indentation.</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} expectedAmount The expected amount of indentation characters for this line</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} actualSpaces The actual number of indentation spaces that were found on this line</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} actualTabs The actual number of indentation tabs that were found on this line</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{string} An error message for this line</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">createErrorMessageData</span><span class="s4">(</span><span class="s2">expectedAmount</span><span class="s4">, </span><span class="s2">actualSpaces</span><span class="s4">, </span><span class="s2">actualTabs</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">expectedStatement </span><span class="s4">= </span><span class="s3">`</span><span class="s2">$</span><span class="s4">{</span><span class="s2">expectedAmount</span><span class="s4">} </span><span class="s2">$</span><span class="s4">{</span><span class="s2">indentType</span><span class="s4">}</span><span class="s2">$</span><span class="s4">{</span><span class="s2">expectedAmount </span><span class="s4">=== </span><span class="s7">1 </span><span class="s4">? </span><span class="s3">&quot;&quot; </span><span class="s4">: </span><span class="s3">&quot;s&quot;</span><span class="s4">}</span><span class="s3">`</span><span class="s4">; </span><span class="s5">// e.g. &quot;2 tabs&quot;</span>
            <span class="s6">const </span><span class="s2">foundSpacesWord </span><span class="s4">= </span><span class="s3">`space</span><span class="s2">$</span><span class="s4">{</span><span class="s2">actualSpaces </span><span class="s4">=== </span><span class="s7">1 </span><span class="s4">? </span><span class="s3">&quot;&quot; </span><span class="s4">: </span><span class="s3">&quot;s&quot;</span><span class="s4">}</span><span class="s3">`</span><span class="s4">; </span><span class="s5">// e.g. &quot;space&quot;</span>
            <span class="s6">const </span><span class="s2">foundTabsWord </span><span class="s4">= </span><span class="s3">`tab</span><span class="s2">$</span><span class="s4">{</span><span class="s2">actualTabs </span><span class="s4">=== </span><span class="s7">1 </span><span class="s4">? </span><span class="s3">&quot;&quot; </span><span class="s4">: </span><span class="s3">&quot;s&quot;</span><span class="s4">}</span><span class="s3">`</span><span class="s4">; </span><span class="s5">// e.g. &quot;tabs&quot;</span>
            <span class="s6">let </span><span class="s2">foundStatement</span><span class="s4">;</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">actualSpaces </span><span class="s4">&gt; </span><span class="s7">0 </span><span class="s4">&amp;&amp; </span><span class="s2">actualTabs </span><span class="s4">&gt; </span><span class="s7">0</span><span class="s4">) {</span>
                <span class="s2">foundStatement </span><span class="s4">= </span><span class="s3">`</span><span class="s2">$</span><span class="s4">{</span><span class="s2">actualSpaces</span><span class="s4">} </span><span class="s2">$</span><span class="s4">{</span><span class="s2">foundSpacesWord</span><span class="s4">} </span><span class="s3">and </span><span class="s2">$</span><span class="s4">{</span><span class="s2">actualTabs</span><span class="s4">} </span><span class="s2">$</span><span class="s4">{</span><span class="s2">foundTabsWord</span><span class="s4">}</span><span class="s3">`</span><span class="s4">; </span><span class="s5">// e.g. &quot;1 space and 2 tabs&quot;</span>
            <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">actualSpaces </span><span class="s4">&gt; </span><span class="s7">0</span><span class="s4">) {</span>

                <span class="s5">/* 
                 * Abbreviate the message if the expected indentation is also spaces. 
                 * e.g. 'Expected 4 spaces but found 2' rather than 'Expected 4 spaces but found 2 spaces' 
                 */</span>
                <span class="s2">foundStatement </span><span class="s4">= </span><span class="s2">indentType </span><span class="s4">=== </span><span class="s3">&quot;space&quot; </span><span class="s4">? </span><span class="s2">actualSpaces </span><span class="s4">: </span><span class="s3">`</span><span class="s2">$</span><span class="s4">{</span><span class="s2">actualSpaces</span><span class="s4">} </span><span class="s2">$</span><span class="s4">{</span><span class="s2">foundSpacesWord</span><span class="s4">}</span><span class="s3">`</span><span class="s4">;</span>
            <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">actualTabs </span><span class="s4">&gt; </span><span class="s7">0</span><span class="s4">) {</span>
                <span class="s2">foundStatement </span><span class="s4">= </span><span class="s2">indentType </span><span class="s4">=== </span><span class="s3">&quot;tab&quot; </span><span class="s4">? </span><span class="s2">actualTabs </span><span class="s4">: </span><span class="s3">`</span><span class="s2">$</span><span class="s4">{</span><span class="s2">actualTabs</span><span class="s4">} </span><span class="s2">$</span><span class="s4">{</span><span class="s2">foundTabsWord</span><span class="s4">}</span><span class="s3">`</span><span class="s4">;</span>
            <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                <span class="s2">foundStatement </span><span class="s4">= </span><span class="s3">&quot;0&quot;</span><span class="s4">;</span>
            <span class="s4">}</span>
            <span class="s6">return </span><span class="s4">{</span>
                <span class="s2">expected</span><span class="s4">: </span><span class="s2">expectedStatement</span><span class="s4">,</span>
                <span class="s2">actual</span><span class="s4">: </span><span class="s2">foundStatement</span>
            <span class="s4">};</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Reports a given indent violation</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node Node violating the indent rule</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} needed Expected indentation character count</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} gottenSpaces Indentation space count in the actual node/code</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} gottenTabs Indentation tab count in the actual node/code</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{Object} [loc] Error line and column location</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{boolean} isLastNodeCheck Is the error for last node check</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">report</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">needed</span><span class="s4">, </span><span class="s2">gottenSpaces</span><span class="s4">, </span><span class="s2">gottenTabs</span><span class="s4">, </span><span class="s2">loc</span><span class="s4">, </span><span class="s2">isLastNodeCheck</span><span class="s4">) {</span>
            <span class="s6">if </span><span class="s4">(</span><span class="s2">gottenSpaces </span><span class="s4">&amp;&amp; </span><span class="s2">gottenTabs</span><span class="s4">) {</span>

                <span class="s5">// To avoid conflicts with `no-mixed-spaces-and-tabs`, don't report lines that have both spaces and tabs.</span>
                <span class="s6">return</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">const </span><span class="s2">desiredIndent </span><span class="s4">= (</span><span class="s2">indentType </span><span class="s4">=== </span><span class="s3">&quot;space&quot; </span><span class="s4">? </span><span class="s3">&quot; &quot; </span><span class="s4">: </span><span class="s3">&quot;</span><span class="s6">\t</span><span class="s3">&quot;</span><span class="s4">).</span><span class="s2">repeat</span><span class="s4">(</span><span class="s2">needed</span><span class="s4">);</span>

            <span class="s6">const </span><span class="s2">textRange </span><span class="s4">= </span><span class="s2">isLastNodeCheck</span>
                <span class="s4">? [</span><span class="s2">node</span><span class="s4">.</span><span class="s2">range</span><span class="s4">[</span><span class="s7">1</span><span class="s4">] - </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">column</span><span class="s4">, </span><span class="s2">node</span><span class="s4">.</span><span class="s2">range</span><span class="s4">[</span><span class="s7">1</span><span class="s4">] - </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">column </span><span class="s4">+ </span><span class="s2">gottenSpaces </span><span class="s4">+ </span><span class="s2">gottenTabs</span><span class="s4">]</span>
                <span class="s4">: [</span><span class="s2">node</span><span class="s4">.</span><span class="s2">range</span><span class="s4">[</span><span class="s7">0</span><span class="s4">] - </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column</span><span class="s4">, </span><span class="s2">node</span><span class="s4">.</span><span class="s2">range</span><span class="s4">[</span><span class="s7">0</span><span class="s4">] - </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column </span><span class="s4">+ </span><span class="s2">gottenSpaces </span><span class="s4">+ </span><span class="s2">gottenTabs</span><span class="s4">];</span>

            <span class="s2">context</span><span class="s4">.</span><span class="s2">report</span><span class="s4">({</span>
                <span class="s2">node</span><span class="s4">,</span>
                <span class="s2">loc</span><span class="s4">,</span>
                <span class="s2">messageId</span><span class="s4">: </span><span class="s3">&quot;expected&quot;</span><span class="s4">,</span>
                <span class="s2">data</span><span class="s4">: </span><span class="s2">createErrorMessageData</span><span class="s4">(</span><span class="s2">needed</span><span class="s4">, </span><span class="s2">gottenSpaces</span><span class="s4">, </span><span class="s2">gottenTabs</span><span class="s4">),</span>
                <span class="s2">fix</span><span class="s4">: </span><span class="s2">fixer </span><span class="s4">=&gt; </span><span class="s2">fixer</span><span class="s4">.</span><span class="s2">replaceTextRange</span><span class="s4">(</span><span class="s2">textRange</span><span class="s4">, </span><span class="s2">desiredIndent</span><span class="s4">)</span>
            <span class="s4">});</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Get the actual indent of node</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode|Token} node Node to examine</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{boolean} [byLastLine=false] get indent of node's last line</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{Object} The node's indent. Contains keys `space` and `tab`, representing the indent of each character. Also</span>
         <span class="s0">* contains keys `goodChar` and `badChar`, where `goodChar` is the amount of the user's desired indentation character, and</span>
         <span class="s0">* `badChar` is the amount of the other indentation character.</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">byLastLine</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">token </span><span class="s4">= </span><span class="s2">byLastLine </span><span class="s4">? </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getLastToken</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) : </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getFirstToken</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>
            <span class="s6">const </span><span class="s2">srcCharsBeforeNode </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getText</span><span class="s4">(</span><span class="s2">token</span><span class="s4">, </span><span class="s2">token</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column</span><span class="s4">).</span><span class="s2">split</span><span class="s4">(</span><span class="s3">&quot;&quot;</span><span class="s4">);</span>
            <span class="s6">const </span><span class="s2">indentChars </span><span class="s4">= </span><span class="s2">srcCharsBeforeNode</span><span class="s4">.</span><span class="s2">slice</span><span class="s4">(</span><span class="s7">0</span><span class="s4">, </span><span class="s2">srcCharsBeforeNode</span><span class="s4">.</span><span class="s2">findIndex</span><span class="s4">(</span><span class="s2">char </span><span class="s4">=&gt; </span><span class="s2">char </span><span class="s4">!== </span><span class="s3">&quot; &quot; </span><span class="s4">&amp;&amp; </span><span class="s2">char </span><span class="s4">!== </span><span class="s3">&quot;</span><span class="s6">\t</span><span class="s3">&quot;</span><span class="s4">));</span>
            <span class="s6">const </span><span class="s2">spaces </span><span class="s4">= </span><span class="s2">indentChars</span><span class="s4">.</span><span class="s2">filter</span><span class="s4">(</span><span class="s2">char </span><span class="s4">=&gt; </span><span class="s2">char </span><span class="s4">=== </span><span class="s3">&quot; &quot;</span><span class="s4">).</span><span class="s2">length</span><span class="s4">;</span>
            <span class="s6">const </span><span class="s2">tabs </span><span class="s4">= </span><span class="s2">indentChars</span><span class="s4">.</span><span class="s2">filter</span><span class="s4">(</span><span class="s2">char </span><span class="s4">=&gt; </span><span class="s2">char </span><span class="s4">=== </span><span class="s3">&quot;</span><span class="s6">\t</span><span class="s3">&quot;</span><span class="s4">).</span><span class="s2">length</span><span class="s4">;</span>

            <span class="s6">return </span><span class="s4">{</span>
                <span class="s2">space</span><span class="s4">: </span><span class="s2">spaces</span><span class="s4">,</span>
                <span class="s2">tab</span><span class="s4">: </span><span class="s2">tabs</span><span class="s4">,</span>
                <span class="s2">goodChar</span><span class="s4">: </span><span class="s2">indentType </span><span class="s4">=== </span><span class="s3">&quot;space&quot; </span><span class="s4">? </span><span class="s2">spaces </span><span class="s4">: </span><span class="s2">tabs</span><span class="s4">,</span>
                <span class="s2">badChar</span><span class="s4">: </span><span class="s2">indentType </span><span class="s4">=== </span><span class="s3">&quot;space&quot; </span><span class="s4">? </span><span class="s2">tabs </span><span class="s4">: </span><span class="s2">spaces</span>
            <span class="s4">};</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Checks node is the first in its own start line. By default it looks by start line.</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node The node to check</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{boolean} [byEndLocation=false] Lookup based on start position or end</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{boolean} true if its the first in the its start line</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">isNodeFirstInLine</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">byEndLocation</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">firstToken </span><span class="s4">= </span><span class="s2">byEndLocation </span><span class="s4">=== </span><span class="s6">true </span><span class="s4">? </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getLastToken</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s7">1</span><span class="s4">) : </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getTokenBefore</span><span class="s4">(</span><span class="s2">node</span><span class="s4">),</span>
                <span class="s2">startLine </span><span class="s4">= </span><span class="s2">byEndLocation </span><span class="s4">=== </span><span class="s6">true </span><span class="s4">? </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">line </span><span class="s4">: </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">,</span>
                <span class="s2">endLine </span><span class="s4">= </span><span class="s2">firstToken </span><span class="s4">? </span><span class="s2">firstToken</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">line </span><span class="s4">: -</span><span class="s7">1</span><span class="s4">;</span>

            <span class="s6">return </span><span class="s2">startLine </span><span class="s4">!== </span><span class="s2">endLine</span><span class="s4">;</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check indent for node</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node Node to check</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} neededIndent needed indent</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">checkNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">neededIndent</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">actualIndent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s6">false</span><span class="s4">);</span>

            <span class="s6">if </span><span class="s4">(</span>
                <span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s3">&quot;ArrayExpression&quot; </span><span class="s4">&amp;&amp;</span>
                <span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s3">&quot;ObjectExpression&quot; </span><span class="s4">&amp;&amp;</span>
                <span class="s4">(</span><span class="s2">actualIndent</span><span class="s4">.</span><span class="s2">goodChar </span><span class="s4">!== </span><span class="s2">neededIndent </span><span class="s4">|| </span><span class="s2">actualIndent</span><span class="s4">.</span><span class="s2">badChar </span><span class="s4">!== </span><span class="s7">0</span><span class="s4">) &amp;&amp;</span>
                <span class="s2">isNodeFirstInLine</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)</span>
            <span class="s4">) {</span>
                <span class="s2">report</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">neededIndent</span><span class="s4">, </span><span class="s2">actualIndent</span><span class="s4">.</span><span class="s2">space</span><span class="s4">, </span><span class="s2">actualIndent</span><span class="s4">.</span><span class="s2">tab</span><span class="s4">);</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;IfStatement&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">alternate</span><span class="s4">) {</span>
                <span class="s6">const </span><span class="s2">elseToken </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getTokenBefore</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">alternate</span><span class="s4">);</span>

                <span class="s2">checkNodeIndent</span><span class="s4">(</span><span class="s2">elseToken</span><span class="s4">, </span><span class="s2">neededIndent</span><span class="s4">);</span>

                <span class="s6">if </span><span class="s4">(!</span><span class="s2">isNodeFirstInLine</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">alternate</span><span class="s4">)) {</span>
                    <span class="s2">checkNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">alternate</span><span class="s4">, </span><span class="s2">neededIndent</span><span class="s4">);</span>
                <span class="s4">}</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;TryStatement&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">handler</span><span class="s4">) {</span>
                <span class="s6">const </span><span class="s2">catchToken </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getFirstToken</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">handler</span><span class="s4">);</span>

                <span class="s2">checkNodeIndent</span><span class="s4">(</span><span class="s2">catchToken</span><span class="s4">, </span><span class="s2">neededIndent</span><span class="s4">);</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;TryStatement&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">finalizer</span><span class="s4">) {</span>
                <span class="s6">const </span><span class="s2">finallyToken </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getTokenBefore</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">finalizer</span><span class="s4">);</span>

                <span class="s2">checkNodeIndent</span><span class="s4">(</span><span class="s2">finallyToken</span><span class="s4">, </span><span class="s2">neededIndent</span><span class="s4">);</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;DoWhileStatement&quot;</span><span class="s4">) {</span>
                <span class="s6">const </span><span class="s2">whileToken </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getTokenAfter</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">body</span><span class="s4">);</span>

                <span class="s2">checkNodeIndent</span><span class="s4">(</span><span class="s2">whileToken</span><span class="s4">, </span><span class="s2">neededIndent</span><span class="s4">);</span>
            <span class="s4">}</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check indent for nodes list</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode[]} nodes list of node objects</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} indent needed indent</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">nodes</span><span class="s4">, </span><span class="s2">indent</span><span class="s4">) {</span>
            <span class="s2">nodes</span><span class="s4">.</span><span class="s2">forEach</span><span class="s4">(</span><span class="s2">node </span><span class="s4">=&gt; </span><span class="s2">checkNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">indent</span><span class="s4">));</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check last node line indent this detects, that block closed correctly</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node Node to examine</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} lastLineIndent needed indent</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">checkLastNodeLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">lastLineIndent</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">lastToken </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getLastToken</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>
            <span class="s6">const </span><span class="s2">endIndent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">lastToken</span><span class="s4">, </span><span class="s6">true</span><span class="s4">);</span>

            <span class="s6">if </span><span class="s4">((</span><span class="s2">endIndent</span><span class="s4">.</span><span class="s2">goodChar </span><span class="s4">!== </span><span class="s2">lastLineIndent </span><span class="s4">|| </span><span class="s2">endIndent</span><span class="s4">.</span><span class="s2">badChar </span><span class="s4">!== </span><span class="s7">0</span><span class="s4">) &amp;&amp; </span><span class="s2">isNodeFirstInLine</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s6">true</span><span class="s4">)) {</span>
                <span class="s2">report</span><span class="s4">(</span>
                    <span class="s2">node</span><span class="s4">,</span>
                    <span class="s2">lastLineIndent</span><span class="s4">,</span>
                    <span class="s2">endIndent</span><span class="s4">.</span><span class="s2">space</span><span class="s4">,</span>
                    <span class="s2">endIndent</span><span class="s4">.</span><span class="s2">tab</span><span class="s4">,</span>
                    <span class="s4">{ </span><span class="s2">line</span><span class="s4">: </span><span class="s2">lastToken</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">, </span><span class="s2">column</span><span class="s4">: </span><span class="s2">lastToken</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column </span><span class="s4">},</span>
                    <span class="s6">true</span>
                <span class="s4">);</span>
            <span class="s4">}</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check last node line indent this detects, that block closed correctly</span>
         <span class="s0">* This function for more complicated return statement case, where closing parenthesis may be followed by ';'</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node Node to examine</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} firstLineIndent first line needed indent</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">checkLastReturnStatementLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">firstLineIndent</span><span class="s4">) {</span>

            <span class="s5">/* 
             * in case if return statement ends with ');' we have traverse back to ')' 
             * otherwise we'll measure indent for ';' and replace ')' 
             */</span>
            <span class="s6">const </span><span class="s2">lastToken </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getLastToken</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">astUtils</span><span class="s4">.</span><span class="s2">isClosingParenToken</span><span class="s4">);</span>
            <span class="s6">const </span><span class="s2">textBeforeClosingParenthesis </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getText</span><span class="s4">(</span><span class="s2">lastToken</span><span class="s4">, </span><span class="s2">lastToken</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column</span><span class="s4">).</span><span class="s2">slice</span><span class="s4">(</span><span class="s7">0</span><span class="s4">, -</span><span class="s7">1</span><span class="s4">);</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">textBeforeClosingParenthesis</span><span class="s4">.</span><span class="s2">trim</span><span class="s4">()) {</span>

                <span class="s5">// There are tokens before the closing paren, don't report this case</span>
                <span class="s6">return</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">const </span><span class="s2">endIndent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">lastToken</span><span class="s4">, </span><span class="s6">true</span><span class="s4">);</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">endIndent</span><span class="s4">.</span><span class="s2">goodChar </span><span class="s4">!== </span><span class="s2">firstLineIndent</span><span class="s4">) {</span>
                <span class="s2">report</span><span class="s4">(</span>
                    <span class="s2">node</span><span class="s4">,</span>
                    <span class="s2">firstLineIndent</span><span class="s4">,</span>
                    <span class="s2">endIndent</span><span class="s4">.</span><span class="s2">space</span><span class="s4">,</span>
                    <span class="s2">endIndent</span><span class="s4">.</span><span class="s2">tab</span><span class="s4">,</span>
                    <span class="s4">{ </span><span class="s2">line</span><span class="s4">: </span><span class="s2">lastToken</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">, </span><span class="s2">column</span><span class="s4">: </span><span class="s2">lastToken</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column </span><span class="s4">},</span>
                    <span class="s6">true</span>
                <span class="s4">);</span>
            <span class="s4">}</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check first node line indent is correct</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node Node to examine</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} firstLineIndent needed indent</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">checkFirstNodeLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">firstLineIndent</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">startIndent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s6">false</span><span class="s4">);</span>

            <span class="s6">if </span><span class="s4">((</span><span class="s2">startIndent</span><span class="s4">.</span><span class="s2">goodChar </span><span class="s4">!== </span><span class="s2">firstLineIndent </span><span class="s4">|| </span><span class="s2">startIndent</span><span class="s4">.</span><span class="s2">badChar </span><span class="s4">!== </span><span class="s7">0</span><span class="s4">) &amp;&amp; </span><span class="s2">isNodeFirstInLine</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                <span class="s2">report</span><span class="s4">(</span>
                    <span class="s2">node</span><span class="s4">,</span>
                    <span class="s2">firstLineIndent</span><span class="s4">,</span>
                    <span class="s2">startIndent</span><span class="s4">.</span><span class="s2">space</span><span class="s4">,</span>
                    <span class="s2">startIndent</span><span class="s4">.</span><span class="s2">tab</span><span class="s4">,</span>
                    <span class="s4">{ </span><span class="s2">line</span><span class="s4">: </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">, </span><span class="s2">column</span><span class="s4">: </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column </span><span class="s4">}</span>
                <span class="s4">);</span>
            <span class="s4">}</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Returns a parent node of given node based on a specified type</span>
         <span class="s0">* if not present then return null</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to examine</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{string} type type that is being looked for</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{string} stopAtList end points for the evaluating code</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{ASTNode|void} if found then node otherwise null</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">getParentNodeByType</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">type</span><span class="s4">, </span><span class="s2">stopAtList</span><span class="s4">) {</span>
            <span class="s6">let </span><span class="s2">parent </span><span class="s4">= </span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">;</span>
            <span class="s6">const </span><span class="s2">stopAtSet </span><span class="s4">= </span><span class="s6">new </span><span class="s2">Set</span><span class="s4">(</span><span class="s2">stopAtList </span><span class="s4">|| [</span><span class="s3">&quot;Program&quot;</span><span class="s4">]);</span>

            <span class="s6">while </span><span class="s4">(</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s2">type </span><span class="s4">&amp;&amp; !</span><span class="s2">stopAtSet</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type</span><span class="s4">) &amp;&amp; </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s3">&quot;Program&quot;</span><span class="s4">) {</span>
                <span class="s2">parent </span><span class="s4">= </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">return </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s2">type </span><span class="s4">? </span><span class="s2">parent </span><span class="s4">: </span><span class="s6">null</span><span class="s4">;</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Returns the VariableDeclarator based on the current node</span>
         <span class="s0">* if not present then return null</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to examine</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{ASTNode|void} if found then node otherwise null</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">getVariableDeclaratorNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
            <span class="s6">return </span><span class="s2">getParentNodeByType</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s3">&quot;VariableDeclarator&quot;</span><span class="s4">);</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check to see if the node is part of the multi-line variable declaration.</span>
         <span class="s0">* Also if its on the same line as the varNode</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to check</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} varNode variable declaration node to check against</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{boolean} True if all the above condition satisfy</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">isNodeInVarOnTop</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">varNode</span><span class="s4">) {</span>
            <span class="s6">return </span><span class="s2">varNode </span><span class="s4">&amp;&amp;</span>
                <span class="s2">varNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">=== </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">&amp;&amp;</span>
                <span class="s2">varNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">declarations</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt; </span><span class="s7">1</span><span class="s4">;</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check to see if the argument before the callee node is multi-line and</span>
         <span class="s0">* there should only be 1 argument before the callee node</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to check</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{boolean} True if arguments are multi-line</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">isArgBeforeCalleeNodeMultiline</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">parent </span><span class="s4">= </span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">;</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt;= </span><span class="s7">2 </span><span class="s4">&amp;&amp; </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">[</span><span class="s7">1</span><span class="s4">] === </span><span class="s2">node</span><span class="s4">) {</span>
                <span class="s6">return </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">line </span><span class="s4">&gt; </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">return false</span><span class="s4">;</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check to see if the node is a file level IIFE</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node The function node to check.</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{boolean} True if the node is the outer IIFE</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">isOuterIIFE</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">parent </span><span class="s4">= </span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">;</span>
            <span class="s6">let </span><span class="s2">stmt </span><span class="s4">= </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">;</span>

            <span class="s5">/* 
             * Verify that the node is an IIEF 
             */</span>
            <span class="s6">if </span><span class="s4">(</span>
                <span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s3">&quot;CallExpression&quot; </span><span class="s4">||</span>
                <span class="s2">parent</span><span class="s4">.</span><span class="s2">callee </span><span class="s4">!== </span><span class="s2">node</span><span class="s4">) {</span>

                <span class="s6">return false</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s5">/* 
             * Navigate legal ancestors to determine whether this IIEF is outer 
             */</span>
            <span class="s6">while </span><span class="s4">(</span>
                <span class="s2">stmt</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;UnaryExpression&quot; </span><span class="s4">&amp;&amp; (</span>
                    <span class="s2">stmt</span><span class="s4">.</span><span class="s2">operator </span><span class="s4">=== </span><span class="s3">&quot;!&quot; </span><span class="s4">||</span>
                    <span class="s2">stmt</span><span class="s4">.</span><span class="s2">operator </span><span class="s4">=== </span><span class="s3">&quot;~&quot; </span><span class="s4">||</span>
                    <span class="s2">stmt</span><span class="s4">.</span><span class="s2">operator </span><span class="s4">=== </span><span class="s3">&quot;+&quot; </span><span class="s4">||</span>
                    <span class="s2">stmt</span><span class="s4">.</span><span class="s2">operator </span><span class="s4">=== </span><span class="s3">&quot;-&quot;</span><span class="s4">) ||</span>
                <span class="s2">stmt</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;AssignmentExpression&quot; </span><span class="s4">||</span>
                <span class="s2">stmt</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;LogicalExpression&quot; </span><span class="s4">||</span>
                <span class="s2">stmt</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;SequenceExpression&quot; </span><span class="s4">||</span>
                <span class="s2">stmt</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;VariableDeclarator&quot;</span><span class="s4">) {</span>

                <span class="s2">stmt </span><span class="s4">= </span><span class="s2">stmt</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">return </span><span class="s4">((</span>
                <span class="s2">stmt</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;ExpressionStatement&quot; </span><span class="s4">||</span>
                <span class="s2">stmt</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;VariableDeclaration&quot;</span><span class="s4">) &amp;&amp;</span>
                <span class="s2">stmt</span><span class="s4">.</span><span class="s2">parent </span><span class="s4">&amp;&amp; </span><span class="s2">stmt</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;Program&quot;</span>
            <span class="s4">);</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check indent for function block content</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node A BlockStatement node that is inside of a function.</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">checkIndentInFunctionBlock</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>

            <span class="s5">/* 
             * Search first caller in chain. 
             * Ex.: 
             * 
             * Models &lt;- Identifier 
             *   .User 
             *   .find() 
             *   .exec(function() { 
             *   // function body 
             * }); 
             * 
             * Looks for 'Models' 
             */</span>
            <span class="s6">const </span><span class="s2">calleeNode </span><span class="s4">= </span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">; </span><span class="s5">// FunctionExpression</span>
            <span class="s6">let </span><span class="s2">indent</span><span class="s4">;</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">.</span><span class="s2">parent </span><span class="s4">&amp;&amp;</span>
                <span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;Property&quot; </span><span class="s4">||</span>
                <span class="s2">calleeNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;ArrayExpression&quot;</span><span class="s4">)) {</span>

                <span class="s5">// If function is part of array or object, comma can be put at left</span>
                <span class="s2">indent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">, </span><span class="s6">false</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
            <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>

                <span class="s5">// If function is standalone, simple calculate indent</span>
                <span class="s2">indent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;CallExpression&quot;</span><span class="s4">) {</span>
                <span class="s6">const </span><span class="s2">calleeParent </span><span class="s4">= </span><span class="s2">calleeNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">;</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s3">&quot;FunctionExpression&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">calleeNode</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s3">&quot;ArrowFunctionExpression&quot;</span><span class="s4">) {</span>
                    <span class="s6">if </span><span class="s4">(</span><span class="s2">calleeParent </span><span class="s4">&amp;&amp; </span><span class="s2">calleeParent</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">&lt; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">) {</span>
                        <span class="s2">indent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">calleeParent</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
                    <span class="s4">}</span>
                <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                    <span class="s6">if </span><span class="s4">(</span><span class="s2">isArgBeforeCalleeNodeMultiline</span><span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">) &amp;&amp;</span>
                        <span class="s2">calleeParent</span><span class="s4">.</span><span class="s2">callee</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">=== </span><span class="s2">calleeParent</span><span class="s4">.</span><span class="s2">callee</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">line </span><span class="s4">&amp;&amp;</span>
                        <span class="s4">!</span><span class="s2">isNodeFirstInLine</span><span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">)) {</span>
                        <span class="s2">indent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">calleeParent</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
                    <span class="s4">}</span>
                <span class="s4">}</span>
            <span class="s4">}</span>

            <span class="s5">/* 
             * function body indent should be indent + indent size, unless this 
             * is a FunctionDeclaration, FunctionExpression, or outer IIFE and the corresponding options are enabled. 
             */</span>
            <span class="s6">let </span><span class="s2">functionOffset </span><span class="s4">= </span><span class="s2">indentSize</span><span class="s4">;</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">outerIIFEBody </span><span class="s4">!== </span><span class="s6">null </span><span class="s4">&amp;&amp; </span><span class="s2">isOuterIIFE</span><span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">)) {</span>
                <span class="s2">functionOffset </span><span class="s4">= </span><span class="s2">options</span><span class="s4">.</span><span class="s2">outerIIFEBody </span><span class="s4">* </span><span class="s2">indentSize</span><span class="s4">;</span>
            <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;FunctionExpression&quot;</span><span class="s4">) {</span>
                <span class="s2">functionOffset </span><span class="s4">= </span><span class="s2">options</span><span class="s4">.</span><span class="s2">FunctionExpression</span><span class="s4">.</span><span class="s2">body </span><span class="s4">* </span><span class="s2">indentSize</span><span class="s4">;</span>
            <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">calleeNode</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;FunctionDeclaration&quot;</span><span class="s4">) {</span>
                <span class="s2">functionOffset </span><span class="s4">= </span><span class="s2">options</span><span class="s4">.</span><span class="s2">FunctionDeclaration</span><span class="s4">.</span><span class="s2">body </span><span class="s4">* </span><span class="s2">indentSize</span><span class="s4">;</span>
            <span class="s4">}</span>
            <span class="s2">indent </span><span class="s4">+= </span><span class="s2">functionOffset</span><span class="s4">;</span>

            <span class="s5">// check if the node is inside a variable</span>
            <span class="s6">const </span><span class="s2">parentVarNode </span><span class="s4">= </span><span class="s2">getVariableDeclaratorNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">parentVarNode </span><span class="s4">&amp;&amp; </span><span class="s2">isNodeInVarOnTop</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">parentVarNode</span><span class="s4">)) {</span>
                <span class="s2">indent </span><span class="s4">+= </span><span class="s2">indentSize </span><span class="s4">* </span><span class="s2">options</span><span class="s4">.</span><span class="s2">VariableDeclarator</span><span class="s4">[</span><span class="s2">parentVarNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">kind</span><span class="s4">];</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">body</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt; </span><span class="s7">0</span><span class="s4">) {</span>
                <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">body</span><span class="s4">, </span><span class="s2">indent</span><span class="s4">);</span>
            <span class="s4">}</span>

            <span class="s2">checkLastNodeLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">indent </span><span class="s4">- </span><span class="s2">functionOffset</span><span class="s4">);</span>
        <span class="s4">}</span>


        <span class="s0">/**</span>
         <span class="s0">* Checks if the given node starts and ends on the same line</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node The node to check</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{boolean} Whether or not the block starts and ends on the same line.</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">isSingleLineNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">lastToken </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getLastToken</span><span class="s4">(</span><span class="s2">node</span><span class="s4">),</span>
                <span class="s2">startLine </span><span class="s4">= </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">,</span>
                <span class="s2">endLine </span><span class="s4">= </span><span class="s2">lastToken</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">line</span><span class="s4">;</span>

            <span class="s6">return </span><span class="s2">startLine </span><span class="s4">=== </span><span class="s2">endLine</span><span class="s4">;</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check indent for array block content or object block content</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to examine</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">checkIndentInArrayOrObjectBlock</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>

            <span class="s5">// Skip inline</span>
            <span class="s6">if </span><span class="s4">(</span><span class="s2">isSingleLineNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                <span class="s6">return</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">let </span><span class="s2">elements </span><span class="s4">= (</span><span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;ArrayExpression&quot;</span><span class="s4">) ? </span><span class="s2">node</span><span class="s4">.</span><span class="s2">elements </span><span class="s4">: </span><span class="s2">node</span><span class="s4">.</span><span class="s2">properties</span><span class="s4">;</span>

            <span class="s5">// filter out empty elements example would be [ , 2] so remove first element as espree considers it as null</span>
            <span class="s2">elements </span><span class="s4">= </span><span class="s2">elements</span><span class="s4">.</span><span class="s2">filter</span><span class="s4">(</span><span class="s2">elem </span><span class="s4">=&gt; </span><span class="s2">elem </span><span class="s4">!== </span><span class="s6">null</span><span class="s4">);</span>

            <span class="s6">let </span><span class="s2">nodeIndent</span><span class="s4">;</span>
            <span class="s6">let </span><span class="s2">elementsIndent</span><span class="s4">;</span>
            <span class="s6">const </span><span class="s2">parentVarNode </span><span class="s4">= </span><span class="s2">getVariableDeclaratorNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>

            <span class="s5">// TODO - come up with a better strategy in future</span>
            <span class="s6">if </span><span class="s4">(</span><span class="s2">isNodeFirstInLine</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                <span class="s6">const </span><span class="s2">parent </span><span class="s4">= </span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">;</span>

                <span class="s2">nodeIndent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">parent</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
                <span class="s6">if </span><span class="s4">(!</span><span class="s2">parentVarNode </span><span class="s4">|| </span><span class="s2">parentVarNode</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">!== </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">) {</span>
                    <span class="s6">if </span><span class="s4">(</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s3">&quot;VariableDeclarator&quot; </span><span class="s4">|| </span><span class="s2">parentVarNode </span><span class="s4">=== </span><span class="s2">parentVarNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">declarations</span><span class="s4">[</span><span class="s7">0</span><span class="s4">]) {</span>
                        <span class="s6">if </span><span class="s4">(</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;VariableDeclarator&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">parentVarNode</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">=== </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">) {</span>
                            <span class="s2">nodeIndent </span><span class="s4">+= (</span><span class="s2">indentSize </span><span class="s4">* </span><span class="s2">options</span><span class="s4">.</span><span class="s2">VariableDeclarator</span><span class="s4">[</span><span class="s2">parentVarNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">kind</span><span class="s4">]);</span>
                        <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;ObjectExpression&quot; </span><span class="s4">|| </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;ArrayExpression&quot;</span><span class="s4">) {</span>
                            <span class="s6">const </span><span class="s2">parentElements </span><span class="s4">= </span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;ObjectExpression&quot; </span><span class="s4">? </span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">properties </span><span class="s4">: </span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">elements</span><span class="s4">;</span>

                            <span class="s6">if </span><span class="s4">(</span><span class="s2">parentElements</span><span class="s4">[</span><span class="s7">0</span><span class="s4">] &amp;&amp;</span>
                                    <span class="s2">parentElements</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">=== </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">&amp;&amp;</span>
                                    <span class="s2">parentElements</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">line </span><span class="s4">!== </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">) {</span>

                                <span class="s5">/* 
                                 * If the first element of the array spans multiple lines, don't increase the expected indentation of the rest. 
                                 * e.g. [{ 
                                 *        foo: 1 
                                 *      }, 
                                 *      { 
                                 *        bar: 1 
                                 *      }] 
                                 * the second object is not indented. 
                                 */</span>
                            <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">options</span><span class="s4">[</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type</span><span class="s4">] === </span><span class="s3">&quot;number&quot;</span><span class="s4">) {</span>
                                <span class="s2">nodeIndent </span><span class="s4">+= </span><span class="s2">options</span><span class="s4">[</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type</span><span class="s4">] * </span><span class="s2">indentSize</span><span class="s4">;</span>
                            <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                                <span class="s2">nodeIndent </span><span class="s4">= </span><span class="s2">parentElements</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column</span><span class="s4">;</span>
                            <span class="s4">}</span>
                        <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;CallExpression&quot; </span><span class="s4">|| </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;NewExpression&quot;</span><span class="s4">) {</span>
                            <span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">options</span><span class="s4">.</span><span class="s2">CallExpression</span><span class="s4">.</span><span class="s2">arguments </span><span class="s4">=== </span><span class="s3">&quot;number&quot;</span><span class="s4">) {</span>
                                <span class="s2">nodeIndent </span><span class="s4">+= </span><span class="s2">options</span><span class="s4">.</span><span class="s2">CallExpression</span><span class="s4">.</span><span class="s2">arguments </span><span class="s4">* </span><span class="s2">indentSize</span><span class="s4">;</span>
                            <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">CallExpression</span><span class="s4">.</span><span class="s2">arguments </span><span class="s4">=== </span><span class="s3">&quot;first&quot;</span><span class="s4">) {</span>
                                <span class="s6">if </span><span class="s4">(</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">.</span><span class="s2">includes</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                                    <span class="s2">nodeIndent </span><span class="s4">= </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column</span><span class="s4">;</span>
                                <span class="s4">}</span>
                            <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                                <span class="s2">nodeIndent </span><span class="s4">+= </span><span class="s2">indentSize</span><span class="s4">;</span>
                            <span class="s4">}</span>
                        <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;LogicalExpression&quot; </span><span class="s4">|| </span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;ArrowFunctionExpression&quot;</span><span class="s4">) {</span>
                            <span class="s2">nodeIndent </span><span class="s4">+= </span><span class="s2">indentSize</span><span class="s4">;</span>
                        <span class="s4">}</span>
                    <span class="s4">}</span>
                <span class="s4">}</span>

                <span class="s2">checkFirstNodeLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">nodeIndent</span><span class="s4">);</span>
            <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                <span class="s2">nodeIndent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">options</span><span class="s4">[</span><span class="s2">node</span><span class="s4">.</span><span class="s2">type</span><span class="s4">] === </span><span class="s3">&quot;first&quot;</span><span class="s4">) {</span>
                <span class="s2">elementsIndent </span><span class="s4">= </span><span class="s2">elements</span><span class="s4">.</span><span class="s2">length </span><span class="s4">? </span><span class="s2">elements</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column </span><span class="s4">: </span><span class="s7">0</span><span class="s4">; </span><span class="s5">// If there are no elements, elementsIndent doesn't matter.</span>
            <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                <span class="s2">elementsIndent </span><span class="s4">= </span><span class="s2">nodeIndent </span><span class="s4">+ </span><span class="s2">indentSize </span><span class="s4">* </span><span class="s2">options</span><span class="s4">[</span><span class="s2">node</span><span class="s4">.</span><span class="s2">type</span><span class="s4">];</span>
            <span class="s4">}</span>

            <span class="s5">/* 
             * Check if the node is a multiple variable declaration; if so, then 
             * make sure indentation takes that into account. 
             */</span>
            <span class="s6">if </span><span class="s4">(</span><span class="s2">isNodeInVarOnTop</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">parentVarNode</span><span class="s4">)) {</span>
                <span class="s2">elementsIndent </span><span class="s4">+= </span><span class="s2">indentSize </span><span class="s4">* </span><span class="s2">options</span><span class="s4">.</span><span class="s2">VariableDeclarator</span><span class="s4">[</span><span class="s2">parentVarNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">kind</span><span class="s4">];</span>
            <span class="s4">}</span>

            <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">elements</span><span class="s4">, </span><span class="s2">elementsIndent</span><span class="s4">);</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">elements</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt; </span><span class="s7">0</span><span class="s4">) {</span>

                <span class="s5">// Skip last block line check if last item in same line</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">elements</span><span class="s4">[</span><span class="s2">elements</span><span class="s4">.</span><span class="s2">length </span><span class="s4">- </span><span class="s7">1</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">line </span><span class="s4">=== </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">line</span><span class="s4">) {</span>
                    <span class="s6">return</span><span class="s4">;</span>
                <span class="s4">}</span>
            <span class="s4">}</span>

            <span class="s2">checkLastNodeLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">nodeIndent </span><span class="s4">+</span>
                <span class="s4">(</span><span class="s2">isNodeInVarOnTop</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">parentVarNode</span><span class="s4">) ? </span><span class="s2">options</span><span class="s4">.</span><span class="s2">VariableDeclarator</span><span class="s4">[</span><span class="s2">parentVarNode</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">kind</span><span class="s4">] * </span><span class="s2">indentSize </span><span class="s4">: </span><span class="s7">0</span><span class="s4">));</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check if the node or node body is a BlockStatement or not</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to test</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{boolean} True if it or its body is a block statement</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">isNodeBodyBlock</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
            <span class="s6">return </span><span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;BlockStatement&quot; </span><span class="s4">|| </span><span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;ClassBody&quot; </span><span class="s4">|| (</span><span class="s2">node</span><span class="s4">.</span><span class="s2">body </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">body</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;BlockStatement&quot;</span><span class="s4">) ||</span>
                <span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">consequent </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">consequent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;BlockStatement&quot;</span><span class="s4">);</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check indentation for blocks</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to check</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">blockIndentationCheck</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>

            <span class="s5">// Skip inline blocks</span>
            <span class="s6">if </span><span class="s4">(</span><span class="s2">isSingleLineNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                <span class="s6">return</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent </span><span class="s4">&amp;&amp; (</span>
                <span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;FunctionExpression&quot; </span><span class="s4">||</span>
                <span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;FunctionDeclaration&quot; </span><span class="s4">||</span>
                <span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;ArrowFunctionExpression&quot;</span><span class="s4">)</span>
            <span class="s4">) {</span>
                <span class="s2">checkIndentInFunctionBlock</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>
                <span class="s6">return</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">let </span><span class="s2">indent</span><span class="s4">;</span>
            <span class="s6">let </span><span class="s2">nodesToCheck </span><span class="s4">= [];</span>

            <span class="s5">/* 
             * For this statements we should check indent from statement beginning, 
             * not from the beginning of the block. 
             */</span>
            <span class="s6">const </span><span class="s2">statementsWithProperties </span><span class="s4">= [</span>
                <span class="s3">&quot;IfStatement&quot;</span><span class="s4">, </span><span class="s3">&quot;WhileStatement&quot;</span><span class="s4">, </span><span class="s3">&quot;ForStatement&quot;</span><span class="s4">, </span><span class="s3">&quot;ForInStatement&quot;</span><span class="s4">, </span><span class="s3">&quot;ForOfStatement&quot;</span><span class="s4">, </span><span class="s3">&quot;DoWhileStatement&quot;</span><span class="s4">, </span><span class="s3">&quot;ClassDeclaration&quot;</span><span class="s4">, </span><span class="s3">&quot;TryStatement&quot;</span>
            <span class="s4">];</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent </span><span class="s4">&amp;&amp; </span><span class="s2">statementsWithProperties</span><span class="s4">.</span><span class="s2">includes</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type</span><span class="s4">) &amp;&amp; </span><span class="s2">isNodeBodyBlock</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                <span class="s2">indent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
            <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;CatchClause&quot;</span><span class="s4">) {</span>
                <span class="s2">indent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
            <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                <span class="s2">indent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;IfStatement&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">consequent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s3">&quot;BlockStatement&quot;</span><span class="s4">) {</span>
                <span class="s2">nodesToCheck </span><span class="s4">= [</span><span class="s2">node</span><span class="s4">.</span><span class="s2">consequent</span><span class="s4">];</span>
            <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">Array</span><span class="s4">.</span><span class="s2">isArray</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">body</span><span class="s4">)) {</span>
                <span class="s2">nodesToCheck </span><span class="s4">= </span><span class="s2">node</span><span class="s4">.</span><span class="s2">body</span><span class="s4">;</span>
            <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                <span class="s2">nodesToCheck </span><span class="s4">= [</span><span class="s2">node</span><span class="s4">.</span><span class="s2">body</span><span class="s4">];</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">nodesToCheck</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt; </span><span class="s7">0</span><span class="s4">) {</span>
                <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">nodesToCheck</span><span class="s4">, </span><span class="s2">indent </span><span class="s4">+ </span><span class="s2">indentSize</span><span class="s4">);</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;BlockStatement&quot;</span><span class="s4">) {</span>
                <span class="s2">checkLastNodeLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">indent</span><span class="s4">);</span>
            <span class="s4">}</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Filter out the elements which are on the same line of each other or the node.</span>
         <span class="s0">* basically have only 1 elements from each line except the variable declaration line.</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node Variable declaration node</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{ASTNode[]} Filtered elements</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">filterOutSameLineVars</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
            <span class="s6">return </span><span class="s2">node</span><span class="s4">.</span><span class="s2">declarations</span><span class="s4">.</span><span class="s2">reduce</span><span class="s4">((</span><span class="s2">finalCollection</span><span class="s4">, </span><span class="s2">elem</span><span class="s4">) =&gt; {</span>
                <span class="s6">const </span><span class="s2">lastElem </span><span class="s4">= </span><span class="s2">finalCollection</span><span class="s4">[</span><span class="s2">finalCollection</span><span class="s4">.</span><span class="s2">length </span><span class="s4">- </span><span class="s7">1</span><span class="s4">];</span>

                <span class="s6">if </span><span class="s4">((</span><span class="s2">elem</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">!== </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">&amp;&amp; !</span><span class="s2">lastElem</span><span class="s4">) ||</span>
                    <span class="s4">(</span><span class="s2">lastElem </span><span class="s4">&amp;&amp; </span><span class="s2">lastElem</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">!== </span><span class="s2">elem</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">)) {</span>
                    <span class="s2">finalCollection</span><span class="s4">.</span><span class="s2">push</span><span class="s4">(</span><span class="s2">elem</span><span class="s4">);</span>
                <span class="s4">}</span>

                <span class="s6">return </span><span class="s2">finalCollection</span><span class="s4">;</span>
            <span class="s4">}, []);</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check indentation for variable declarations</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to examine</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">checkIndentInVariableDeclarations</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">elements </span><span class="s4">= </span><span class="s2">filterOutSameLineVars</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>
            <span class="s6">const </span><span class="s2">nodeIndent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
            <span class="s6">const </span><span class="s2">lastElement </span><span class="s4">= </span><span class="s2">elements</span><span class="s4">[</span><span class="s2">elements</span><span class="s4">.</span><span class="s2">length </span><span class="s4">- </span><span class="s7">1</span><span class="s4">];</span>

            <span class="s6">const </span><span class="s2">elementsIndent </span><span class="s4">= </span><span class="s2">nodeIndent </span><span class="s4">+ </span><span class="s2">indentSize </span><span class="s4">* </span><span class="s2">options</span><span class="s4">.</span><span class="s2">VariableDeclarator</span><span class="s4">[</span><span class="s2">node</span><span class="s4">.</span><span class="s2">kind</span><span class="s4">];</span>

            <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">elements</span><span class="s4">, </span><span class="s2">elementsIndent</span><span class="s4">);</span>

            <span class="s5">// Only check the last line if there is any token after the last item</span>
            <span class="s6">if </span><span class="s4">(</span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getLastToken</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">line </span><span class="s4">&lt;= </span><span class="s2">lastElement</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">end</span><span class="s4">.</span><span class="s2">line</span><span class="s4">) {</span>
                <span class="s6">return</span><span class="s4">;</span>
            <span class="s4">}</span>

            <span class="s6">const </span><span class="s2">tokenBeforeLastElement </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getTokenBefore</span><span class="s4">(</span><span class="s2">lastElement</span><span class="s4">);</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">tokenBeforeLastElement</span><span class="s4">.</span><span class="s2">value </span><span class="s4">=== </span><span class="s3">&quot;,&quot;</span><span class="s4">) {</span>

                <span class="s5">// Special case for comma-first syntax where the semicolon is indented</span>
                <span class="s2">checkLastNodeLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">tokenBeforeLastElement</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">);</span>
            <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                <span class="s2">checkLastNodeLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">elementsIndent </span><span class="s4">- </span><span class="s2">indentSize</span><span class="s4">);</span>
            <span class="s4">}</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Check and decide whether to check for indentation for blockless nodes</span>
         <span class="s0">* Scenarios are for or while statements without braces around them</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to examine</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{void}</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">blockLessNodes</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
            <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">body</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s3">&quot;BlockStatement&quot;</span><span class="s4">) {</span>
                <span class="s2">blockIndentationCheck</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>
            <span class="s4">}</span>
        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Returns the expected indentation for the case statement</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to examine</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{int} [providedSwitchIndent] indent for switch statement</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{int} indent size</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">expectedCaseIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">providedSwitchIndent</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">switchNode </span><span class="s4">= (</span><span class="s2">node</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;SwitchStatement&quot;</span><span class="s4">) ? </span><span class="s2">node </span><span class="s4">: </span><span class="s2">node</span><span class="s4">.</span><span class="s2">parent</span><span class="s4">;</span>
            <span class="s6">const </span><span class="s2">switchIndent </span><span class="s4">= </span><span class="s6">typeof </span><span class="s2">providedSwitchIndent </span><span class="s4">=== </span><span class="s3">&quot;undefined&quot;</span>
                <span class="s4">? </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">switchNode</span><span class="s4">).</span><span class="s2">goodChar</span>
                <span class="s4">: </span><span class="s2">providedSwitchIndent</span><span class="s4">;</span>
            <span class="s6">let </span><span class="s2">caseIndent</span><span class="s4">;</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">caseIndentStore</span><span class="s4">[</span><span class="s2">switchNode</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">]) {</span>
                <span class="s6">return </span><span class="s2">caseIndentStore</span><span class="s4">[</span><span class="s2">switchNode</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">];</span>
            <span class="s4">}</span>

            <span class="s6">if </span><span class="s4">(</span><span class="s2">switchNode</span><span class="s4">.</span><span class="s2">cases</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt; </span><span class="s7">0 </span><span class="s4">&amp;&amp; </span><span class="s2">options</span><span class="s4">.</span><span class="s2">SwitchCase </span><span class="s4">=== </span><span class="s7">0</span><span class="s4">) {</span>
                <span class="s2">caseIndent </span><span class="s4">= </span><span class="s2">switchIndent</span><span class="s4">;</span>
            <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                <span class="s2">caseIndent </span><span class="s4">= </span><span class="s2">switchIndent </span><span class="s4">+ (</span><span class="s2">indentSize </span><span class="s4">* </span><span class="s2">options</span><span class="s4">.</span><span class="s2">SwitchCase</span><span class="s4">);</span>
            <span class="s4">}</span>

            <span class="s2">caseIndentStore</span><span class="s4">[</span><span class="s2">switchNode</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">] = </span><span class="s2">caseIndent</span><span class="s4">;</span>
            <span class="s6">return </span><span class="s2">caseIndent</span><span class="s4">;</span>

        <span class="s4">}</span>

        <span class="s0">/**</span>
         <span class="s0">* Checks whether a return statement is wrapped in ()</span>
         <span class="s0">* </span><span class="s1">@param </span><span class="s0">{ASTNode} node node to examine</span>
         <span class="s0">* </span><span class="s1">@returns </span><span class="s0">{boolean} the result</span>
         <span class="s0">*/</span>
        <span class="s6">function </span><span class="s2">isWrappedInParenthesis</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
            <span class="s6">const </span><span class="s2">regex </span><span class="s4">= </span><span class="s8">/^return\s*?\(\s*?\);*?/u</span><span class="s4">;</span>

            <span class="s6">const </span><span class="s2">statementWithoutArgument </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getText</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">replace</span><span class="s4">(</span>
                <span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getText</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">argument</span><span class="s4">), </span><span class="s3">&quot;&quot;</span>
            <span class="s4">);</span>

            <span class="s6">return </span><span class="s2">regex</span><span class="s4">.</span><span class="s2">test</span><span class="s4">(</span><span class="s2">statementWithoutArgument</span><span class="s4">);</span>
        <span class="s4">}</span>

        <span class="s6">return </span><span class="s4">{</span>
            <span class="s2">Program</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">body</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt; </span><span class="s7">0</span><span class="s4">) {</span>

                    <span class="s5">// Root nodes should have no indent</span>
                    <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">body</span><span class="s4">, </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">);</span>
                <span class="s4">}</span>
            <span class="s4">},</span>

            <span class="s2">ClassBody</span><span class="s4">: </span><span class="s2">blockIndentationCheck</span><span class="s4">,</span>

            <span class="s2">BlockStatement</span><span class="s4">: </span><span class="s2">blockIndentationCheck</span><span class="s4">,</span>

            <span class="s2">WhileStatement</span><span class="s4">: </span><span class="s2">blockLessNodes</span><span class="s4">,</span>

            <span class="s2">ForStatement</span><span class="s4">: </span><span class="s2">blockLessNodes</span><span class="s4">,</span>

            <span class="s2">ForInStatement</span><span class="s4">: </span><span class="s2">blockLessNodes</span><span class="s4">,</span>

            <span class="s2">ForOfStatement</span><span class="s4">: </span><span class="s2">blockLessNodes</span><span class="s4">,</span>

            <span class="s2">DoWhileStatement</span><span class="s4">: </span><span class="s2">blockLessNodes</span><span class="s4">,</span>

            <span class="s2">IfStatement</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">consequent</span><span class="s4">.</span><span class="s2">type </span><span class="s4">!== </span><span class="s3">&quot;BlockStatement&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">consequent</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">&gt; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">) {</span>
                    <span class="s2">blockIndentationCheck</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>
                <span class="s4">}</span>
            <span class="s4">},</span>

            <span class="s2">VariableDeclaration</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">declarations</span><span class="s4">[</span><span class="s2">node</span><span class="s4">.</span><span class="s2">declarations</span><span class="s4">.</span><span class="s2">length </span><span class="s4">- </span><span class="s7">1</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line </span><span class="s4">&gt; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">declarations</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">line</span><span class="s4">) {</span>
                    <span class="s2">checkIndentInVariableDeclarations</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>
                <span class="s4">}</span>
            <span class="s4">},</span>

            <span class="s2">ObjectExpression</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
                <span class="s2">checkIndentInArrayOrObjectBlock</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>
            <span class="s4">},</span>

            <span class="s2">ArrayExpression</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
                <span class="s2">checkIndentInArrayOrObjectBlock</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>
            <span class="s4">},</span>

            <span class="s2">MemberExpression</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s6">typeof </span><span class="s2">options</span><span class="s4">.</span><span class="s2">MemberExpression </span><span class="s4">=== </span><span class="s3">&quot;undefined&quot;</span><span class="s4">) {</span>
                    <span class="s6">return</span><span class="s4">;</span>
                <span class="s4">}</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s2">isSingleLineNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                    <span class="s6">return</span><span class="s4">;</span>
                <span class="s4">}</span>

                <span class="s5">/* 
                 * The typical layout of variable declarations and assignments 
                 * alter the expectation of correct indentation. Skip them. 
                 * TODO: Add appropriate configuration options for variable 
                 * declarations and assignments. 
                 */</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">getParentNodeByType</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s3">&quot;VariableDeclarator&quot;</span><span class="s4">, [</span><span class="s3">&quot;FunctionExpression&quot;</span><span class="s4">, </span><span class="s3">&quot;ArrowFunctionExpression&quot;</span><span class="s4">])) {</span>
                    <span class="s6">return</span><span class="s4">;</span>
                <span class="s4">}</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s2">getParentNodeByType</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s3">&quot;AssignmentExpression&quot;</span><span class="s4">, [</span><span class="s3">&quot;FunctionExpression&quot;</span><span class="s4">])) {</span>
                    <span class="s6">return</span><span class="s4">;</span>
                <span class="s4">}</span>

                <span class="s6">const </span><span class="s2">propertyIndent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">goodChar </span><span class="s4">+ </span><span class="s2">indentSize </span><span class="s4">* </span><span class="s2">options</span><span class="s4">.</span><span class="s2">MemberExpression</span><span class="s4">;</span>

                <span class="s6">const </span><span class="s2">checkNodes </span><span class="s4">= [</span><span class="s2">node</span><span class="s4">.</span><span class="s2">property</span><span class="s4">];</span>

                <span class="s6">const </span><span class="s2">dot </span><span class="s4">= </span><span class="s2">sourceCode</span><span class="s4">.</span><span class="s2">getTokenBefore</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">property</span><span class="s4">);</span>

                <span class="s6">if </span><span class="s4">(</span><span class="s2">dot</span><span class="s4">.</span><span class="s2">type </span><span class="s4">=== </span><span class="s3">&quot;Punctuator&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">dot</span><span class="s4">.</span><span class="s2">value </span><span class="s4">=== </span><span class="s3">&quot;.&quot;</span><span class="s4">) {</span>
                    <span class="s2">checkNodes</span><span class="s4">.</span><span class="s2">push</span><span class="s4">(</span><span class="s2">dot</span><span class="s4">);</span>
                <span class="s4">}</span>

                <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">checkNodes</span><span class="s4">, </span><span class="s2">propertyIndent</span><span class="s4">);</span>
            <span class="s4">},</span>

            <span class="s2">SwitchStatement</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>

                <span class="s5">// Switch is not a 'BlockStatement'</span>
                <span class="s6">const </span><span class="s2">switchIndent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>
                <span class="s6">const </span><span class="s2">caseIndent </span><span class="s4">= </span><span class="s2">expectedCaseIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">switchIndent</span><span class="s4">);</span>

                <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">cases</span><span class="s4">, </span><span class="s2">caseIndent</span><span class="s4">);</span>


                <span class="s2">checkLastNodeLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">switchIndent</span><span class="s4">);</span>
            <span class="s4">},</span>

            <span class="s2">SwitchCase</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>

                <span class="s5">// Skip inline cases</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">isSingleLineNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                    <span class="s6">return</span><span class="s4">;</span>
                <span class="s4">}</span>
                <span class="s6">const </span><span class="s2">caseIndent </span><span class="s4">= </span><span class="s2">expectedCaseIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">);</span>

                <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">consequent</span><span class="s4">, </span><span class="s2">caseIndent </span><span class="s4">+ </span><span class="s2">indentSize</span><span class="s4">);</span>
            <span class="s4">},</span>

            <span class="s2">FunctionDeclaration</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">isSingleLineNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                    <span class="s6">return</span><span class="s4">;</span>
                <span class="s4">}</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">FunctionDeclaration</span><span class="s4">.</span><span class="s2">parameters </span><span class="s4">=== </span><span class="s3">&quot;first&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">params</span><span class="s4">.</span><span class="s2">length</span><span class="s4">) {</span>
                    <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">params</span><span class="s4">.</span><span class="s2">slice</span><span class="s4">(</span><span class="s7">1</span><span class="s4">), </span><span class="s2">node</span><span class="s4">.</span><span class="s2">params</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column</span><span class="s4">);</span>
                <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">FunctionDeclaration</span><span class="s4">.</span><span class="s2">parameters </span><span class="s4">!== </span><span class="s6">null</span><span class="s4">) {</span>
                    <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">params</span><span class="s4">, </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">goodChar </span><span class="s4">+ </span><span class="s2">indentSize </span><span class="s4">* </span><span class="s2">options</span><span class="s4">.</span><span class="s2">FunctionDeclaration</span><span class="s4">.</span><span class="s2">parameters</span><span class="s4">);</span>
                <span class="s4">}</span>
            <span class="s4">},</span>

            <span class="s2">FunctionExpression</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">isSingleLineNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                    <span class="s6">return</span><span class="s4">;</span>
                <span class="s4">}</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">FunctionExpression</span><span class="s4">.</span><span class="s2">parameters </span><span class="s4">=== </span><span class="s3">&quot;first&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">params</span><span class="s4">.</span><span class="s2">length</span><span class="s4">) {</span>
                    <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">params</span><span class="s4">.</span><span class="s2">slice</span><span class="s4">(</span><span class="s7">1</span><span class="s4">), </span><span class="s2">node</span><span class="s4">.</span><span class="s2">params</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column</span><span class="s4">);</span>
                <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">FunctionExpression</span><span class="s4">.</span><span class="s2">parameters </span><span class="s4">!== </span><span class="s6">null</span><span class="s4">) {</span>
                    <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">params</span><span class="s4">, </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">goodChar </span><span class="s4">+ </span><span class="s2">indentSize </span><span class="s4">* </span><span class="s2">options</span><span class="s4">.</span><span class="s2">FunctionExpression</span><span class="s4">.</span><span class="s2">parameters</span><span class="s4">);</span>
                <span class="s4">}</span>
            <span class="s4">},</span>

            <span class="s2">ReturnStatement</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">isSingleLineNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                    <span class="s6">return</span><span class="s4">;</span>
                <span class="s4">}</span>

                <span class="s6">const </span><span class="s2">firstLineIndent </span><span class="s4">= </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">goodChar</span><span class="s4">;</span>

                <span class="s5">// in case if return statement is wrapped in parenthesis</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">isWrappedInParenthesis</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                    <span class="s2">checkLastReturnStatementLineIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">firstLineIndent</span><span class="s4">);</span>
                <span class="s4">} </span><span class="s6">else </span><span class="s4">{</span>
                    <span class="s2">checkNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">, </span><span class="s2">firstLineIndent</span><span class="s4">);</span>
                <span class="s4">}</span>
            <span class="s4">},</span>

            <span class="s2">CallExpression</span><span class="s4">(</span><span class="s2">node</span><span class="s4">) {</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">isSingleLineNode</span><span class="s4">(</span><span class="s2">node</span><span class="s4">)) {</span>
                    <span class="s6">return</span><span class="s4">;</span>
                <span class="s4">}</span>
                <span class="s6">if </span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">CallExpression</span><span class="s4">.</span><span class="s2">arguments </span><span class="s4">=== </span><span class="s3">&quot;first&quot; </span><span class="s4">&amp;&amp; </span><span class="s2">node</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">.</span><span class="s2">length</span><span class="s4">) {</span>
                    <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">.</span><span class="s2">slice</span><span class="s4">(</span><span class="s7">1</span><span class="s4">), </span><span class="s2">node</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">[</span><span class="s7">0</span><span class="s4">].</span><span class="s2">loc</span><span class="s4">.</span><span class="s2">start</span><span class="s4">.</span><span class="s2">column</span><span class="s4">);</span>
                <span class="s4">} </span><span class="s6">else if </span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">CallExpression</span><span class="s4">.</span><span class="s2">arguments </span><span class="s4">!== </span><span class="s6">null</span><span class="s4">) {</span>
                    <span class="s2">checkNodesIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">, </span><span class="s2">getNodeIndent</span><span class="s4">(</span><span class="s2">node</span><span class="s4">).</span><span class="s2">goodChar </span><span class="s4">+ </span><span class="s2">indentSize </span><span class="s4">* </span><span class="s2">options</span><span class="s4">.</span><span class="s2">CallExpression</span><span class="s4">.</span><span class="s2">arguments</span><span class="s4">);</span>
                <span class="s4">}</span>
            <span class="s4">}</span>

        <span class="s4">};</span>

    <span class="s4">}</span>
<span class="s4">};</span>
</pre>
</body>
</html>