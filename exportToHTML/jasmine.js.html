<html>
<head>
<title>jasmine.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #5f826b; font-style: italic;}
.s5 { color: #67a37c; font-style: italic;}
.s6 { color: #2aacb8;}
.s7 { color: #7a7e85;}
.s8 { color: #42c3d4;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
jasmine.js</font>
</center></td></tr></table>
<pre><span class="s0">var </span><span class="s1">isCommonJS </span><span class="s2">= </span><span class="s0">typeof </span><span class="s1">window </span><span class="s2">== </span><span class="s3">&quot;undefined&quot; </span><span class="s2">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">exports </span><span class="s2">== </span><span class="s3">&quot;object&quot;</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Top level namespace for Jasmine, a lightweight JavaScript BDD/spec/testing framework.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@namespace</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">jasmine </span><span class="s2">= {};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">jasmine </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">;</span>
<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@private</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">unimplementedMethod_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">&quot;unimplemented method&quot;</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Use &lt;code&gt;jasmine.undefined&lt;/code&gt; instead of &lt;code&gt;undefined&lt;/code&gt;, since &lt;code&gt;undefined&lt;/code&gt; is just</span>
 <span class="s4">* a plain old variable and may be redefined by somebody else.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@private</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">___undefined___</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Show diagnostic messages in the console if set to true</span>
 <span class="s4">*</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">VERBOSE </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Default interval in milliseconds for event loop yields (e.g. to allow network activity or to refresh the screen with the HTML-based runner). Small values here may result in slow test running. Zero means no updates until all tests have completed.</span>
 <span class="s4">*</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">DEFAULT_UPDATE_INTERVAL </span><span class="s2">= </span><span class="s6">250</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Maximum levels of nesting that will be included when an object is pretty-printed</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MAX_PRETTY_PRINT_DEPTH </span><span class="s2">= </span><span class="s6">40</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Default timeout interval in milliseconds for waitsFor() blocks.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">DEFAULT_TIMEOUT_INTERVAL </span><span class="s2">= </span><span class="s6">5000</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* By default exceptions thrown in the context of a test are caught by jasmine so that it can run the remaining tests in the suite.</span>
 <span class="s4">* Set to false to let the exception bubble up in the browser.</span>
 <span class="s4">*</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">CATCH_EXCEPTIONS </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">function </span><span class="s1">getGlobal</span><span class="s2">() {</span>
    <span class="s0">return this</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">return </span><span class="s1">getGlobal</span><span class="s2">();</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Allows for bound functions to be compared.  Internal use only.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@ignore</span>
 <span class="s4">* </span><span class="s5">@private</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">base {Object} bound 'this' for the function</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">name {Function} function to find</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">bindOriginal_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">base</span><span class="s2">, </span><span class="s1">name</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">original </span><span class="s2">= </span><span class="s1">base</span><span class="s2">[</span><span class="s1">name</span><span class="s2">];</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">original</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">) {</span>
    <span class="s0">return function</span><span class="s2">() {</span>
      <span class="s0">return </span><span class="s1">original</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s1">base</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
    <span class="s2">};</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s7">// IE support</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">()[</span><span class="s1">name</span><span class="s2">];</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">setTimeout </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">bindOriginal_</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">(), </span><span class="s3">'setTimeout'</span><span class="s2">);</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">clearTimeout </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">bindOriginal_</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">(), </span><span class="s3">'clearTimeout'</span><span class="s2">);</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">setInterval </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">bindOriginal_</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">(), </span><span class="s3">'setInterval'</span><span class="s2">);</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">clearInterval </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">bindOriginal_</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">(), </span><span class="s3">'clearInterval'</span><span class="s2">);</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MessageResult </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">values</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">type </span><span class="s2">= </span><span class="s3">'log'</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">values </span><span class="s2">= </span><span class="s1">values</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">trace </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Error</span><span class="s2">(); </span><span class="s7">// todo: test better</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MessageResult</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toString </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">text </span><span class="s2">= </span><span class="s3">&quot;&quot;</span><span class="s2">;</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">values</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">i </span><span class="s2">&gt; </span><span class="s6">0</span><span class="s2">) </span><span class="s1">text </span><span class="s2">+= </span><span class="s3">&quot; &quot;</span><span class="s2">;</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isString_</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">values</span><span class="s2">[</span><span class="s1">i</span><span class="s2">])) {</span>
      <span class="s1">text </span><span class="s2">+= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">values</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
      <span class="s1">text </span><span class="s2">+= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">values</span><span class="s2">[</span><span class="s1">i</span><span class="s2">]);</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">text</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">ExpectationResult </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">params</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">type </span><span class="s2">= </span><span class="s3">'expect'</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">matcherName </span><span class="s2">= </span><span class="s1">params</span><span class="s2">.</span><span class="s1">matcherName</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">passed_ </span><span class="s2">= </span><span class="s1">params</span><span class="s2">.</span><span class="s1">passed</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">expected </span><span class="s2">= </span><span class="s1">params</span><span class="s2">.</span><span class="s1">expected</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">= </span><span class="s1">params</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">message </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">passed_ </span><span class="s2">? </span><span class="s3">'Passed.' </span><span class="s2">: </span><span class="s1">params</span><span class="s2">.</span><span class="s1">message</span><span class="s2">;</span>

  <span class="s0">var </span><span class="s1">trace </span><span class="s2">= (</span><span class="s1">params</span><span class="s2">.</span><span class="s1">trace </span><span class="s2">|| </span><span class="s0">new </span><span class="s1">Error</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">message</span><span class="s2">));</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">trace </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">passed_ </span><span class="s2">? </span><span class="s3">'' </span><span class="s2">: </span><span class="s1">trace</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">ExpectationResult</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toString </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">message</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">ExpectationResult</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">passed </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">passed_</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Getter for the Jasmine environment. Ensures one gets created</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">env </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">currentEnv_ </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">currentEnv_ </span><span class="s2">|| </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">();</span>
  <span class="s0">return </span><span class="s1">env</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@ignore</span>
 <span class="s4">* </span><span class="s5">@private</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">value</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">{Boolean}</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isArray_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isA_</span><span class="s2">(</span><span class="s3">&quot;Array&quot;</span><span class="s2">, </span><span class="s1">value</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@ignore</span>
 <span class="s4">* </span><span class="s5">@private</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">value</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">{Boolean}</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isString_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isA_</span><span class="s2">(</span><span class="s3">&quot;String&quot;</span><span class="s2">, </span><span class="s1">value</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@ignore</span>
 <span class="s4">* </span><span class="s5">@private</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">value</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">{Boolean}</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isNumber_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isA_</span><span class="s2">(</span><span class="s3">&quot;Number&quot;</span><span class="s2">, </span><span class="s1">value</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@ignore</span>
 <span class="s4">* </span><span class="s5">@private</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} typeName</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">value</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">{Boolean}</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isA_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">typeName</span><span class="s2">, </span><span class="s1">value</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">Object</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toString</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) === </span><span class="s3">'[object ' </span><span class="s2">+ </span><span class="s1">typeName </span><span class="s2">+ </span><span class="s3">']'</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Pretty printer for expecations.  Takes any object and turns it into a human-readable string.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">value {Object} an object to be outputted</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">{String}</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">stringPrettyPrinter </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">StringPrettyPrinter</span><span class="s2">();</span>
  <span class="s1">stringPrettyPrinter</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">value</span><span class="s2">);</span>
  <span class="s0">return </span><span class="s1">stringPrettyPrinter</span><span class="s2">.</span><span class="s1">string</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Returns true if the object is a DOM Node.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Object} obj object to check</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">{Boolean}</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isDomNode </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">obj</span><span class="s2">.</span><span class="s1">nodeType </span><span class="s2">&gt; </span><span class="s6">0</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Returns a matchable 'generic' object of the class type.  For use in expecations of type when values don't matter.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* // don't care about which function is passed in, as long as it's a function</span>
 <span class="s4">* expect(mySpy).toHaveBeenCalledWith(jasmine.any(Function));</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Class} clazz</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">matchable object of the type clazz</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">any </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">clazz</span><span class="s2">) {</span>
  <span class="s0">return new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">Any</span><span class="s2">(</span><span class="s1">clazz</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Returns a matchable subset of a JSON object. For use in expectations when you don't care about all of the</span>
 <span class="s4">* attributes on the object.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* // don't care about any other attributes than foo.</span>
 <span class="s4">* expect(mySpy).toHaveBeenCalledWith(jasmine.objectContaining({foo: &quot;bar&quot;});</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">sample {Object} sample</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">matchable object for the sample</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">objectContaining </span><span class="s2">= </span><span class="s0">function </span><span class="s2">(</span><span class="s1">sample</span><span class="s2">) {</span>
    <span class="s0">return new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">ObjectContaining</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Jasmine Spies are test doubles that can act as stubs, spies, fakes or when used in an expecation, mocks.</span>
 <span class="s4">*</span>
 <span class="s4">* Spies should be created in test setup, before expectations.  They can then be checked, using the standard Jasmine</span>
 <span class="s4">* expectation syntax. Spies can be checked if they were called or not and what the calling params were.</span>
 <span class="s4">*</span>
 <span class="s4">* A Spy has the following fields: wasCalled, callCount, mostRecentCall, and argsForCall (see docs).</span>
 <span class="s4">*</span>
 <span class="s4">* Spies are torn down at the end of every spec.</span>
 <span class="s4">*</span>
 <span class="s4">* Note: Do &lt;b&gt;not&lt;/b&gt; call new jasmine.Spy() directly - a spy must be created using spyOn, jasmine.createSpy or jasmine.createSpyObj.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* // a stub</span>
 <span class="s4">* var myStub = jasmine.createSpy('myStub');  // can be used anywhere</span>
 <span class="s4">*</span>
 <span class="s4">* // spy example</span>
 <span class="s4">* var foo = {</span>
 <span class="s4">*   not: function(bool) { return !bool; }</span>
 <span class="s4">* }</span>
 <span class="s4">*</span>
 <span class="s4">* // actual foo.not will not be called, execution stops</span>
 <span class="s4">* spyOn(foo, 'not');</span>

 <span class="s4">// foo.not spied upon, execution will continue to implementation</span>
 <span class="s4">* spyOn(foo, 'not').andCallThrough();</span>
 <span class="s4">*</span>
 <span class="s4">* // fake example</span>
 <span class="s4">* var foo = {</span>
 <span class="s4">*   not: function(bool) { return !bool; }</span>
 <span class="s4">* }</span>
 <span class="s4">*</span>
 <span class="s4">* // foo.not(val) will return val</span>
 <span class="s4">* spyOn(foo, 'not').andCallFake(function(value) {return value;});</span>
 <span class="s4">*</span>
 <span class="s4">* // mock example</span>
 <span class="s4">* foo.not(7 == 7);</span>
 <span class="s4">* expect(foo.not).toHaveBeenCalled();</span>
 <span class="s4">* expect(foo.not).toHaveBeenCalledWith(true);</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">* </span><span class="s5">@see </span><span class="s4">spyOn, jasmine.createSpy, jasmine.createSpyObj</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} name</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spy </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">name</span><span class="s2">) {</span>
  <span class="s4">/**</span>
   <span class="s4">* The name of the spy, if provided.</span>
   <span class="s4">*/</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">identity </span><span class="s2">= </span><span class="s1">name </span><span class="s2">|| </span><span class="s3">'unknown'</span><span class="s2">;</span>
  <span class="s4">/**</span>
   <span class="s4">*  Is this Object a spy?</span>
   <span class="s4">*/</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">isSpy </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
  <span class="s4">/**</span>
   <span class="s4">* The actual function this spy stubs.</span>
   <span class="s4">*/</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">plan </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s2">};</span>
  <span class="s4">/**</span>
   <span class="s4">* Tracking of the most recent call to the spy.</span>
   <span class="s4">* </span><span class="s5">@example</span>
   <span class="s4">* var mySpy = jasmine.createSpy('foo');</span>
   <span class="s4">* mySpy(1, 2);</span>
   <span class="s4">* mySpy.mostRecentCall.args = [1, 2];</span>
   <span class="s4">*/</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">mostRecentCall </span><span class="s2">= {};</span>

  <span class="s4">/**</span>
   <span class="s4">* Holds arguments for each call to the spy, indexed by call count</span>
   <span class="s4">* </span><span class="s5">@example</span>
   <span class="s4">* var mySpy = jasmine.createSpy('foo');</span>
   <span class="s4">* mySpy(1, 2);</span>
   <span class="s4">* mySpy(7, 8);</span>
   <span class="s4">* mySpy.mostRecentCall.args = [7, 8];</span>
   <span class="s4">* mySpy.argsForCall[0] = [1, 2];</span>
   <span class="s4">* mySpy.argsForCall[1] = [7, 8];</span>
   <span class="s4">*/</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">argsForCall </span><span class="s2">= [];</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">calls </span><span class="s2">= [];</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Tells a spy to call through to the actual implemenatation.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* var foo = {</span>
 <span class="s4">*   bar: function() { // do some stuff }</span>
 <span class="s4">* }</span>
 <span class="s4">*</span>
 <span class="s4">* // defining a spy on an existing property: foo.bar</span>
 <span class="s4">* spyOn(foo, 'bar').andCallThrough();</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spy</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">andCallThrough </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">plan </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">originalValue</span><span class="s2">;</span>
  <span class="s0">return this</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* For setting the return value of a spy.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* // defining a spy from scratch: foo() returns 'baz'</span>
 <span class="s4">* var foo = jasmine.createSpy('spy on foo').andReturn('baz');</span>
 <span class="s4">*</span>
 <span class="s4">* // defining a spy on an existing property: foo.bar() returns 'baz'</span>
 <span class="s4">* spyOn(foo, 'bar').andReturn('baz');</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Object} value</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spy</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">andReturn </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">plan </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">return </span><span class="s1">value</span><span class="s2">;</span>
  <span class="s2">};</span>
  <span class="s0">return this</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* For throwing an exception when a spy is called.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* // defining a spy from scratch: foo() throws an exception w/ message 'ouch'</span>
 <span class="s4">* var foo = jasmine.createSpy('spy on foo').andThrow('baz');</span>
 <span class="s4">*</span>
 <span class="s4">* // defining a spy on an existing property: foo.bar() throws an exception w/ message 'ouch'</span>
 <span class="s4">* spyOn(foo, 'bar').andThrow('baz');</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} exceptionMsg</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spy</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">andThrow </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">exceptionMsg</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">plan </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">throw </span><span class="s1">exceptionMsg</span><span class="s2">;</span>
  <span class="s2">};</span>
  <span class="s0">return this</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Calls an alternate implementation when a spy is called.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* var baz = function() {</span>
 <span class="s4">*   // do some stuff, return something</span>
 <span class="s4">* }</span>
 <span class="s4">* // defining a spy from scratch: foo() calls the function baz</span>
 <span class="s4">* var foo = jasmine.createSpy('spy on foo').andCall(baz);</span>
 <span class="s4">*</span>
 <span class="s4">* // defining a spy on an existing property: foo.bar() calls an anonymnous function</span>
 <span class="s4">* spyOn(foo, 'bar').andCall(function() { return 'baz';} );</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} fakeFunc</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spy</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">andCallFake </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">fakeFunc</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">plan </span><span class="s2">= </span><span class="s1">fakeFunc</span><span class="s2">;</span>
  <span class="s0">return this</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Resets all of a spy's the tracking variables so that it can be used again.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* spyOn(foo, 'bar');</span>
 <span class="s4">*</span>
 <span class="s4">* foo.bar();</span>
 <span class="s4">*</span>
 <span class="s4">* expect(foo.bar.callCount).toEqual(1);</span>
 <span class="s4">*</span>
 <span class="s4">* foo.bar.reset();</span>
 <span class="s4">*</span>
 <span class="s4">* expect(foo.bar.callCount).toEqual(0);</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spy</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reset </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">wasCalled </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">callCount </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">argsForCall </span><span class="s2">= [];</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">calls </span><span class="s2">= [];</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">mostRecentCall </span><span class="s2">= {};</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">createSpy </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">name</span><span class="s2">) {</span>

  <span class="s0">var </span><span class="s1">spyObj </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s1">spyObj</span><span class="s2">.</span><span class="s1">wasCalled </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
    <span class="s1">spyObj</span><span class="s2">.</span><span class="s1">callCount</span><span class="s2">++;</span>
    <span class="s0">var </span><span class="s1">args </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">argsToArray</span><span class="s2">(</span><span class="s1">arguments</span><span class="s2">);</span>
    <span class="s1">spyObj</span><span class="s2">.</span><span class="s1">mostRecentCall</span><span class="s2">.</span><span class="s1">object </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
    <span class="s1">spyObj</span><span class="s2">.</span><span class="s1">mostRecentCall</span><span class="s2">.</span><span class="s1">args </span><span class="s2">= </span><span class="s1">args</span><span class="s2">;</span>
    <span class="s1">spyObj</span><span class="s2">.</span><span class="s1">argsForCall</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">args</span><span class="s2">);</span>
    <span class="s1">spyObj</span><span class="s2">.</span><span class="s1">calls</span><span class="s2">.</span><span class="s1">push</span><span class="s2">({</span><span class="s1">object</span><span class="s2">: </span><span class="s0">this</span><span class="s2">, </span><span class="s1">args</span><span class="s2">: </span><span class="s1">args</span><span class="s2">});</span>
    <span class="s0">return </span><span class="s1">spyObj</span><span class="s2">.</span><span class="s1">plan</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s2">};</span>

  <span class="s0">var </span><span class="s1">spy </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spy</span><span class="s2">(</span><span class="s1">name</span><span class="s2">);</span>

  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">prop </span><span class="s0">in </span><span class="s1">spy</span><span class="s2">) {</span>
    <span class="s1">spyObj</span><span class="s2">[</span><span class="s1">prop</span><span class="s2">] = </span><span class="s1">spy</span><span class="s2">[</span><span class="s1">prop</span><span class="s2">];</span>
  <span class="s2">}</span>

  <span class="s1">spyObj</span><span class="s2">.</span><span class="s1">reset</span><span class="s2">();</span>

  <span class="s0">return </span><span class="s1">spyObj</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Determines whether an object is a spy.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Spy|Object} putativeSpy</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">{Boolean}</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isSpy </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">putativeSpy</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">putativeSpy </span><span class="s2">&amp;&amp; </span><span class="s1">putativeSpy</span><span class="s2">.</span><span class="s1">isSpy</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Creates a more complicated spy: an Object that has every property a function that is a spy.  Used for stubbing something</span>
 <span class="s4">* large in one call.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} baseName name of spy class</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Array} methodNames array of names of methods to make spies</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">createSpyObj </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">baseName</span><span class="s2">, </span><span class="s1">methodNames</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(!</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isArray_</span><span class="s2">(</span><span class="s1">methodNames</span><span class="s2">) || </span><span class="s1">methodNames</span><span class="s2">.</span><span class="s1">length </span><span class="s2">=== </span><span class="s6">0</span><span class="s2">) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'createSpyObj requires a non-empty array of method names to create spies for'</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">var </span><span class="s1">obj </span><span class="s2">= {};</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">methodNames</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s1">obj</span><span class="s2">[</span><span class="s1">methodNames</span><span class="s2">[</span><span class="s1">i</span><span class="s2">]] = </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">createSpy</span><span class="s2">(</span><span class="s1">baseName </span><span class="s2">+ </span><span class="s3">'.' </span><span class="s2">+ </span><span class="s1">methodNames</span><span class="s2">[</span><span class="s1">i</span><span class="s2">]);</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">obj</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* All parameters are pretty-printed and concatenated together, then written to the current spec's output.</span>
 <span class="s4">*</span>
 <span class="s4">* Be careful not to leave calls to &lt;code&gt;jasmine.log&lt;/code&gt; in production code.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">log </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">spec </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">currentSpec</span><span class="s2">;</span>
  <span class="s1">spec</span><span class="s2">.</span><span class="s1">log</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s1">spec</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Function that installs a spy on an existing object's method name.  Used within a Spec to create a spy.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* // spy example</span>
 <span class="s4">* var foo = {</span>
 <span class="s4">*   not: function(bool) { return !bool; }</span>
 <span class="s4">* }</span>
 <span class="s4">* spyOn(foo, 'not'); // actual foo.not will not be called, execution stops</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@see </span><span class="s4">jasmine.createSpy</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">obj</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">methodName</span>
 <span class="s4">* </span><span class="s5">@return </span><span class="s4">{jasmine.Spy} a Jasmine spy that can be chained with all spy methods</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">spyOn </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">, </span><span class="s1">methodName</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">currentSpec</span><span class="s2">.</span><span class="s1">spyOn</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">, </span><span class="s1">methodName</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">spyOn </span><span class="s2">= </span><span class="s1">spyOn</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Creates a Jasmine spec that will be added to the current suite.</span>
 <span class="s4">*</span>
 <span class="s4">* // TODO: pending tests</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* it('should be true', function() {</span>
 <span class="s4">*   expect(true).toEqual(true);</span>
 <span class="s4">* });</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} desc description of this specification</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} func defines the preconditions and expectations of the spec</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">it </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">desc</span><span class="s2">, </span><span class="s1">func</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">it</span><span class="s2">(</span><span class="s1">desc</span><span class="s2">, </span><span class="s1">func</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">it </span><span class="s2">= </span><span class="s1">it</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Creates a &lt;em&gt;disabled&lt;/em&gt; Jasmine spec.</span>
 <span class="s4">*</span>
 <span class="s4">* A convenience method that allows existing specs to be disabled temporarily during development.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} desc description of this specification</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} func defines the preconditions and expectations of the spec</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">xit </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">desc</span><span class="s2">, </span><span class="s1">func</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">xit</span><span class="s2">(</span><span class="s1">desc</span><span class="s2">, </span><span class="s1">func</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">xit </span><span class="s2">= </span><span class="s1">xit</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Starts a chain for a Jasmine expectation.</span>
 <span class="s4">*</span>
 <span class="s4">* It is passed an Object that is the actual value and should chain to one of the many</span>
 <span class="s4">* jasmine.Matchers functions.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Object} actual Actual value to test against and expected value</span>
 <span class="s4">* </span><span class="s5">@return </span><span class="s4">{jasmine.Matchers}</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">expect </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">currentSpec</span><span class="s2">.</span><span class="s1">expect</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">expect </span><span class="s2">= </span><span class="s1">expect</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Defines part of a jasmine spec.  Used in cominbination with waits or waitsFor in asynchrnous specs.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} func Function that defines part of a jasmine spec.</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">runs </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">func</span><span class="s2">) {</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">currentSpec</span><span class="s2">.</span><span class="s1">runs</span><span class="s2">(</span><span class="s1">func</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">runs </span><span class="s2">= </span><span class="s1">runs</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Waits a fixed time period before moving to the next block.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@deprecated </span><span class="s4">Use waitsFor() instead</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Number} timeout milliseconds to wait</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">waits </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">timeout</span><span class="s2">) {</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">currentSpec</span><span class="s2">.</span><span class="s1">waits</span><span class="s2">(</span><span class="s1">timeout</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">waits </span><span class="s2">= </span><span class="s1">waits</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Waits for the latchFunction to return true before proceeding to the next block.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} latchFunction</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} optional_timeoutMessage</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Number} optional_timeout</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">waitsFor </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">latchFunction</span><span class="s2">, </span><span class="s1">optional_timeoutMessage</span><span class="s2">, </span><span class="s1">optional_timeout</span><span class="s2">) {</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">currentSpec</span><span class="s2">.</span><span class="s1">waitsFor</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">currentSpec</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">waitsFor </span><span class="s2">= </span><span class="s1">waitsFor</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* A function that is called before each spec in a suite.</span>
 <span class="s4">*</span>
 <span class="s4">* Used for spec setup, including validating assumptions.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} beforeEachFunction</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">beforeEach </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">beforeEachFunction</span><span class="s2">) {</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">beforeEach</span><span class="s2">(</span><span class="s1">beforeEachFunction</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">beforeEach </span><span class="s2">= </span><span class="s1">beforeEach</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* A function that is called after each spec in a suite.</span>
 <span class="s4">*</span>
 <span class="s4">* Used for restoring any state that is hijacked during spec execution.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} afterEachFunction</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">afterEach </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">afterEachFunction</span><span class="s2">) {</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">afterEach</span><span class="s2">(</span><span class="s1">afterEachFunction</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">afterEach </span><span class="s2">= </span><span class="s1">afterEach</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Defines a suite of specifications.</span>
 <span class="s4">*</span>
 <span class="s4">* Stores the description and all defined specs in the Jasmine environment as one suite of specs. Variables declared</span>
 <span class="s4">* are accessible by calls to beforeEach, it, and afterEach. Describe blocks can be nested, allowing for specialization</span>
 <span class="s4">* of setup in some tests.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">* // TODO: a simple suite</span>
 <span class="s4">*</span>
 <span class="s4">* // TODO: a simple suite with a nested describe block</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} description A string, usually the class under test.</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} specDefinitions function that defines several specs.</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">describe </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">description</span><span class="s2">, </span><span class="s1">specDefinitions</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">describe</span><span class="s2">(</span><span class="s1">description</span><span class="s2">, </span><span class="s1">specDefinitions</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">describe </span><span class="s2">= </span><span class="s1">describe</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Disables a suite of specifications.  Used to disable some suites in a file, or files, temporarily during development.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} description A string, usually the class under test.</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} specDefinitions function that defines several specs.</span>
 <span class="s4">*/</span>
<span class="s0">var </span><span class="s1">xdescribe </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">description</span><span class="s2">, </span><span class="s1">specDefinitions</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">xdescribe</span><span class="s2">(</span><span class="s1">description</span><span class="s2">, </span><span class="s1">specDefinitions</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s0">if </span><span class="s2">(</span><span class="s1">isCommonJS</span><span class="s2">) </span><span class="s1">exports</span><span class="s2">.</span><span class="s1">xdescribe </span><span class="s2">= </span><span class="s1">xdescribe</span><span class="s2">;</span>


<span class="s7">// Provide the XMLHttpRequest class for IE 5.x-6.x:</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">XmlHttpRequest </span><span class="s2">= (</span><span class="s0">typeof </span><span class="s1">XMLHttpRequest </span><span class="s2">== </span><span class="s3">&quot;undefined&quot;</span><span class="s2">) ? </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">function </span><span class="s1">tryIt</span><span class="s2">(</span><span class="s1">f</span><span class="s2">) {</span>
    <span class="s0">try </span><span class="s2">{</span>
      <span class="s0">return </span><span class="s1">f</span><span class="s2">();</span>
    <span class="s2">} </span><span class="s0">catch</span><span class="s2">(</span><span class="s1">e</span><span class="s2">) {</span>
    <span class="s2">}</span>
    <span class="s0">return null</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">var </span><span class="s1">xhr </span><span class="s2">= </span><span class="s1">tryIt</span><span class="s2">(</span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">return new </span><span class="s1">ActiveXObject</span><span class="s2">(</span><span class="s3">&quot;Msxml2.XMLHTTP.6.0&quot;</span><span class="s2">);</span>
  <span class="s2">}) ||</span>
    <span class="s1">tryIt</span><span class="s2">(</span><span class="s0">function</span><span class="s2">() {</span>
      <span class="s0">return new </span><span class="s1">ActiveXObject</span><span class="s2">(</span><span class="s3">&quot;Msxml2.XMLHTTP.3.0&quot;</span><span class="s2">);</span>
    <span class="s2">}) ||</span>
    <span class="s1">tryIt</span><span class="s2">(</span><span class="s0">function</span><span class="s2">() {</span>
      <span class="s0">return new </span><span class="s1">ActiveXObject</span><span class="s2">(</span><span class="s3">&quot;Msxml2.XMLHTTP&quot;</span><span class="s2">);</span>
    <span class="s2">}) ||</span>
    <span class="s1">tryIt</span><span class="s2">(</span><span class="s0">function</span><span class="s2">() {</span>
      <span class="s0">return new </span><span class="s1">ActiveXObject</span><span class="s2">(</span><span class="s3">&quot;Microsoft.XMLHTTP&quot;</span><span class="s2">);</span>
    <span class="s2">});</span>

  <span class="s0">if </span><span class="s2">(!</span><span class="s1">xhr</span><span class="s2">) </span><span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">&quot;This browser does not support XMLHttpRequest.&quot;</span><span class="s2">);</span>

  <span class="s0">return </span><span class="s1">xhr</span><span class="s2">;</span>
<span class="s2">} : </span><span class="s1">XMLHttpRequest</span><span class="s2">;</span>
<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@namespace</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util </span><span class="s2">= {};</span>

<span class="s4">/**</span>
 <span class="s4">* Declare that a child class inherit it's prototype from the parent class.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@private</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} childClass</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} parentClass</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">inherit </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">childClass</span><span class="s2">, </span><span class="s1">parentClass</span><span class="s2">) {</span>
  <span class="s4">/**</span>
   <span class="s4">* </span><span class="s5">@private</span>
   <span class="s4">*/</span>
  <span class="s0">var </span><span class="s1">subclass </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s2">};</span>
  <span class="s1">subclass</span><span class="s2">.</span><span class="s1">prototype </span><span class="s2">= </span><span class="s1">parentClass</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">;</span>
  <span class="s1">childClass</span><span class="s2">.</span><span class="s1">prototype </span><span class="s2">= </span><span class="s0">new </span><span class="s1">subclass</span><span class="s2">();</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">formatException </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">e</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">lineNumber</span><span class="s2">;</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">e</span><span class="s2">.</span><span class="s1">line</span><span class="s2">) {</span>
    <span class="s1">lineNumber </span><span class="s2">= </span><span class="s1">e</span><span class="s2">.</span><span class="s1">line</span><span class="s2">;</span>
  <span class="s2">}</span>
  <span class="s0">else if </span><span class="s2">(</span><span class="s1">e</span><span class="s2">.</span><span class="s1">lineNumber</span><span class="s2">) {</span>
    <span class="s1">lineNumber </span><span class="s2">= </span><span class="s1">e</span><span class="s2">.</span><span class="s1">lineNumber</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">var </span><span class="s1">file</span><span class="s2">;</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">e</span><span class="s2">.</span><span class="s1">sourceURL</span><span class="s2">) {</span>
    <span class="s1">file </span><span class="s2">= </span><span class="s1">e</span><span class="s2">.</span><span class="s1">sourceURL</span><span class="s2">;</span>
  <span class="s2">}</span>
  <span class="s0">else if </span><span class="s2">(</span><span class="s1">e</span><span class="s2">.</span><span class="s1">fileName</span><span class="s2">) {</span>
    <span class="s1">file </span><span class="s2">= </span><span class="s1">e</span><span class="s2">.</span><span class="s1">fileName</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">var </span><span class="s1">message </span><span class="s2">= (</span><span class="s1">e</span><span class="s2">.</span><span class="s1">name </span><span class="s2">&amp;&amp; </span><span class="s1">e</span><span class="s2">.</span><span class="s1">message</span><span class="s2">) ? (</span><span class="s1">e</span><span class="s2">.</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">': ' </span><span class="s2">+ </span><span class="s1">e</span><span class="s2">.</span><span class="s1">message</span><span class="s2">) : </span><span class="s1">e</span><span class="s2">.</span><span class="s1">toString</span><span class="s2">();</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">file </span><span class="s2">&amp;&amp; </span><span class="s1">lineNumber</span><span class="s2">) {</span>
    <span class="s1">message </span><span class="s2">+= </span><span class="s3">' in ' </span><span class="s2">+ </span><span class="s1">file </span><span class="s2">+ </span><span class="s3">' (line ' </span><span class="s2">+ </span><span class="s1">lineNumber </span><span class="s2">+ </span><span class="s3">')'</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">return </span><span class="s1">message</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">htmlEscape </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">str</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(!</span><span class="s1">str</span><span class="s2">) </span><span class="s0">return </span><span class="s1">str</span><span class="s2">;</span>
  <span class="s0">return </span><span class="s1">str</span><span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s8">/&amp;/g</span><span class="s2">, </span><span class="s3">'&amp;amp;'</span><span class="s2">)</span>
    <span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s8">/&lt;/g</span><span class="s2">, </span><span class="s3">'&amp;lt;'</span><span class="s2">)</span>
    <span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s8">/&gt;/g</span><span class="s2">, </span><span class="s3">'&amp;gt;'</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">argsToArray </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">args</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">arrayOfArgs </span><span class="s2">= [];</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">args</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) </span><span class="s1">arrayOfArgs</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">args</span><span class="s2">[</span><span class="s1">i</span><span class="s2">]);</span>
  <span class="s0">return </span><span class="s1">arrayOfArgs</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">extend </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">destination</span><span class="s2">, </span><span class="s1">source</span><span class="s2">) {</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">property </span><span class="s0">in </span><span class="s1">source</span><span class="s2">) </span><span class="s1">destination</span><span class="s2">[</span><span class="s1">property</span><span class="s2">] = </span><span class="s1">source</span><span class="s2">[</span><span class="s1">property</span><span class="s2">];</span>
  <span class="s0">return </span><span class="s1">destination</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Environment for Jasmine</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">currentSpec </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">currentRunner_ </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">(</span><span class="s0">this</span><span class="s2">);</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">reporter </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MultiReporter</span><span class="s2">();</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">updateInterval </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">DEFAULT_UPDATE_INTERVAL</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">defaultTimeoutInterval </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">DEFAULT_TIMEOUT_INTERVAL</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">lastUpdate </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">specFilter </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">return true</span><span class="s2">;</span>
  <span class="s2">};</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">nextSpecId_ </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">nextSuiteId_ </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">equalityTesters_ </span><span class="s2">= [];</span>

  <span class="s7">// wrap matchers</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">matchersClass </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s2">};</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">inherit</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">matchersClass</span><span class="s2">, </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">);</span>

  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">wrapInto_</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">, </span><span class="s0">this</span><span class="s2">.</span><span class="s1">matchersClass</span><span class="s2">);</span>
<span class="s2">};</span>


<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">setTimeout </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">setTimeout</span><span class="s2">;</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">clearTimeout </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">clearTimeout</span><span class="s2">;</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">setInterval </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">setInterval</span><span class="s2">;</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">clearInterval </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">clearInterval</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">an object containing jasmine version build info, if set.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">version </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">version_</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">version_</span><span class="s2">;</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'Version not set'</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">string containing jasmine version build info, if set.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">versionString </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">if </span><span class="s2">(!</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">version_</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s3">&quot;version unknown&quot;</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">var </span><span class="s1">version </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">version</span><span class="s2">();</span>
  <span class="s0">var </span><span class="s1">versionString </span><span class="s2">= </span><span class="s1">version</span><span class="s2">.</span><span class="s1">major </span><span class="s2">+ </span><span class="s3">&quot;.&quot; </span><span class="s2">+ </span><span class="s1">version</span><span class="s2">.</span><span class="s1">minor </span><span class="s2">+ </span><span class="s3">&quot;.&quot; </span><span class="s2">+ </span><span class="s1">version</span><span class="s2">.</span><span class="s1">build</span><span class="s2">;</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">version</span><span class="s2">.</span><span class="s1">release_candidate</span><span class="s2">) {</span>
    <span class="s1">versionString </span><span class="s2">+= </span><span class="s3">&quot;.rc&quot; </span><span class="s2">+ </span><span class="s1">version</span><span class="s2">.</span><span class="s1">release_candidate</span><span class="s2">;</span>
  <span class="s2">}</span>
  <span class="s1">versionString </span><span class="s2">+= </span><span class="s3">&quot; revision &quot; </span><span class="s2">+ </span><span class="s1">version</span><span class="s2">.</span><span class="s1">revision</span><span class="s2">;</span>
  <span class="s0">return </span><span class="s1">versionString</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">a sequential integer starting at 0</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">nextSpecId </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">nextSpecId_</span><span class="s2">++;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">a sequential integer starting at 0</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">nextSuiteId </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">nextSuiteId_</span><span class="s2">++;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Register a reporter to receive status updates from Jasmine.</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Reporter} reporter An object which will receive status updates.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">addReporter </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">reporter</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">reporter</span><span class="s2">.</span><span class="s1">addReporter</span><span class="s2">(</span><span class="s1">reporter</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">execute </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">currentRunner_</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">();</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">describe </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">description</span><span class="s2">, </span><span class="s1">specDefinitions</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">suite </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">description</span><span class="s2">, </span><span class="s1">specDefinitions</span><span class="s2">, </span><span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">parentSuite </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite</span><span class="s2">;</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">parentSuite</span><span class="s2">) {</span>
    <span class="s1">parentSuite</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s1">suite</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">currentRunner_</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s1">suite</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite </span><span class="s2">= </span><span class="s1">suite</span><span class="s2">;</span>

  <span class="s0">var </span><span class="s1">declarationError </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
  <span class="s0">try </span><span class="s2">{</span>
    <span class="s1">specDefinitions</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s1">suite</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">catch</span><span class="s2">(</span><span class="s1">e</span><span class="s2">) {</span>
    <span class="s1">declarationError </span><span class="s2">= </span><span class="s1">e</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">declarationError</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">it</span><span class="s2">(</span><span class="s3">&quot;encountered a declaration exception&quot;</span><span class="s2">, </span><span class="s0">function</span><span class="s2">() {</span>
      <span class="s0">throw </span><span class="s1">declarationError</span><span class="s2">;</span>
    <span class="s2">});</span>
  <span class="s2">}</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite </span><span class="s2">= </span><span class="s1">parentSuite</span><span class="s2">;</span>

  <span class="s0">return </span><span class="s1">suite</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">beforeEach </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">beforeEachFunction</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite</span><span class="s2">.</span><span class="s1">beforeEach</span><span class="s2">(</span><span class="s1">beforeEachFunction</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">currentRunner_</span><span class="s2">.</span><span class="s1">beforeEach</span><span class="s2">(</span><span class="s1">beforeEachFunction</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">currentRunner </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">currentRunner_</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">afterEach </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">afterEachFunction</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite</span><span class="s2">.</span><span class="s1">afterEach</span><span class="s2">(</span><span class="s1">afterEachFunction</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">currentRunner_</span><span class="s2">.</span><span class="s1">afterEach</span><span class="s2">(</span><span class="s1">afterEachFunction</span><span class="s2">);</span>
  <span class="s2">}</span>

<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">xdescribe </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">desc</span><span class="s2">, </span><span class="s1">specDefinitions</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s2">{</span>
    <span class="s1">execute</span><span class="s2">: </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s2">}</span>
  <span class="s2">};</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">it </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">description</span><span class="s2">, </span><span class="s1">func</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">spec </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite</span><span class="s2">, </span><span class="s1">description</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">currentSuite</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s1">spec</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">currentSpec </span><span class="s2">= </span><span class="s1">spec</span><span class="s2">;</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">func</span><span class="s2">) {</span>
    <span class="s1">spec</span><span class="s2">.</span><span class="s1">runs</span><span class="s2">(</span><span class="s1">func</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">return </span><span class="s1">spec</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">xit </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">desc</span><span class="s2">, </span><span class="s1">func</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s2">{</span>
    <span class="s1">id</span><span class="s2">: </span><span class="s0">this</span><span class="s2">.</span><span class="s1">nextSpecId</span><span class="s2">(),</span>
    <span class="s1">runs</span><span class="s2">: </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s2">}</span>
  <span class="s2">};</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">compareRegExps_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">mismatchKeys</span><span class="s2">, </span><span class="s1">mismatchValues</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">source </span><span class="s2">!= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">source</span><span class="s2">)</span>
    <span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;expected pattern /&quot; </span><span class="s2">+ </span><span class="s1">b</span><span class="s2">.</span><span class="s1">source </span><span class="s2">+ </span><span class="s3">&quot;/ is not equal to the pattern /&quot; </span><span class="s2">+ </span><span class="s1">a</span><span class="s2">.</span><span class="s1">source </span><span class="s2">+ </span><span class="s3">&quot;/&quot;</span><span class="s2">);</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">ignoreCase </span><span class="s2">!= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">ignoreCase</span><span class="s2">)</span>
    <span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;expected modifier i was&quot; </span><span class="s2">+ (</span><span class="s1">b</span><span class="s2">.</span><span class="s1">ignoreCase </span><span class="s2">? </span><span class="s3">&quot; &quot; </span><span class="s2">: </span><span class="s3">&quot; not &quot;</span><span class="s2">) + </span><span class="s3">&quot;set and does not equal the origin modifier&quot;</span><span class="s2">);</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">global </span><span class="s2">!= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">global</span><span class="s2">)</span>
    <span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;expected modifier g was&quot; </span><span class="s2">+ (</span><span class="s1">b</span><span class="s2">.</span><span class="s1">global </span><span class="s2">? </span><span class="s3">&quot; &quot; </span><span class="s2">: </span><span class="s3">&quot; not &quot;</span><span class="s2">) + </span><span class="s3">&quot;set and does not equal the origin modifier&quot;</span><span class="s2">);</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">multiline </span><span class="s2">!= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">multiline</span><span class="s2">)</span>
    <span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;expected modifier m was&quot; </span><span class="s2">+ (</span><span class="s1">b</span><span class="s2">.</span><span class="s1">multiline </span><span class="s2">? </span><span class="s3">&quot; &quot; </span><span class="s2">: </span><span class="s3">&quot; not &quot;</span><span class="s2">) + </span><span class="s3">&quot;set and does not equal the origin modifier&quot;</span><span class="s2">);</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">sticky </span><span class="s2">!= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">sticky</span><span class="s2">)</span>
    <span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;expected modifier y was&quot; </span><span class="s2">+ (</span><span class="s1">b</span><span class="s2">.</span><span class="s1">sticky </span><span class="s2">? </span><span class="s3">&quot; &quot; </span><span class="s2">: </span><span class="s3">&quot; not &quot;</span><span class="s2">) + </span><span class="s3">&quot;set and does not equal the origin modifier&quot;</span><span class="s2">);</span>

  <span class="s0">return </span><span class="s2">(</span><span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">length </span><span class="s2">=== </span><span class="s6">0</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">compareObjects_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">mismatchKeys</span><span class="s2">, </span><span class="s1">mismatchValues</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">__Jasmine_been_here_before__ </span><span class="s2">=== </span><span class="s1">b </span><span class="s2">&amp;&amp; </span><span class="s1">b</span><span class="s2">.</span><span class="s1">__Jasmine_been_here_before__ </span><span class="s2">=== </span><span class="s1">a</span><span class="s2">) {</span>
    <span class="s0">return true</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s1">a</span><span class="s2">.</span><span class="s1">__Jasmine_been_here_before__ </span><span class="s2">= </span><span class="s1">b</span><span class="s2">;</span>
  <span class="s1">b</span><span class="s2">.</span><span class="s1">__Jasmine_been_here_before__ </span><span class="s2">= </span><span class="s1">a</span><span class="s2">;</span>

  <span class="s0">var </span><span class="s1">hasKey </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">, </span><span class="s1">keyName</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">obj </span><span class="s2">!== </span><span class="s0">null </span><span class="s2">&amp;&amp; </span><span class="s1">obj</span><span class="s2">[</span><span class="s1">keyName</span><span class="s2">] !== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">;</span>
  <span class="s2">};</span>

  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">property </span><span class="s0">in </span><span class="s1">b</span><span class="s2">) {</span>
    <span class="s0">if </span><span class="s2">(!</span><span class="s1">hasKey</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">property</span><span class="s2">) &amp;&amp; </span><span class="s1">hasKey</span><span class="s2">(</span><span class="s1">b</span><span class="s2">, </span><span class="s1">property</span><span class="s2">)) {</span>
      <span class="s1">mismatchKeys</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;expected has key '&quot; </span><span class="s2">+ </span><span class="s1">property </span><span class="s2">+ </span><span class="s3">&quot;', but missing from actual.&quot;</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s1">property </span><span class="s0">in </span><span class="s1">a</span><span class="s2">) {</span>
    <span class="s0">if </span><span class="s2">(!</span><span class="s1">hasKey</span><span class="s2">(</span><span class="s1">b</span><span class="s2">, </span><span class="s1">property</span><span class="s2">) &amp;&amp; </span><span class="s1">hasKey</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">property</span><span class="s2">)) {</span>
      <span class="s1">mismatchKeys</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;expected missing key '&quot; </span><span class="s2">+ </span><span class="s1">property </span><span class="s2">+ </span><span class="s3">&quot;', but present in actual.&quot;</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s1">property </span><span class="s0">in </span><span class="s1">b</span><span class="s2">) {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">property </span><span class="s2">== </span><span class="s3">'__Jasmine_been_here_before__'</span><span class="s2">) </span><span class="s0">continue</span><span class="s2">;</span>
    <span class="s0">if </span><span class="s2">(!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">equals_</span><span class="s2">(</span><span class="s1">a</span><span class="s2">[</span><span class="s1">property</span><span class="s2">], </span><span class="s1">b</span><span class="s2">[</span><span class="s1">property</span><span class="s2">], </span><span class="s1">mismatchKeys</span><span class="s2">, </span><span class="s1">mismatchValues</span><span class="s2">)) {</span>
      <span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;'&quot; </span><span class="s2">+ </span><span class="s1">property </span><span class="s2">+ </span><span class="s3">&quot;' was '&quot; </span><span class="s2">+ (</span><span class="s1">b</span><span class="s2">[</span><span class="s1">property</span><span class="s2">] ? </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">htmlEscape</span><span class="s2">(</span><span class="s1">b</span><span class="s2">[</span><span class="s1">property</span><span class="s2">].</span><span class="s1">toString</span><span class="s2">()) : </span><span class="s1">b</span><span class="s2">[</span><span class="s1">property</span><span class="s2">]) + </span><span class="s3">&quot;' in expected, but was '&quot; </span><span class="s2">+ (</span><span class="s1">a</span><span class="s2">[</span><span class="s1">property</span><span class="s2">] ? </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">htmlEscape</span><span class="s2">(</span><span class="s1">a</span><span class="s2">[</span><span class="s1">property</span><span class="s2">].</span><span class="s1">toString</span><span class="s2">()) : </span><span class="s1">a</span><span class="s2">[</span><span class="s1">property</span><span class="s2">]) + </span><span class="s3">&quot;' in actual.&quot;</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isArray_</span><span class="s2">(</span><span class="s1">a</span><span class="s2">) &amp;&amp; </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isArray_</span><span class="s2">(</span><span class="s1">b</span><span class="s2">) &amp;&amp; </span><span class="s1">a</span><span class="s2">.</span><span class="s1">length </span><span class="s2">!= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">length</span><span class="s2">) {</span>
    <span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;arrays were not the same length&quot;</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">delete </span><span class="s1">a</span><span class="s2">.</span><span class="s1">__Jasmine_been_here_before__</span><span class="s2">;</span>
  <span class="s0">delete </span><span class="s1">b</span><span class="s2">.</span><span class="s1">__Jasmine_been_here_before__</span><span class="s2">;</span>
  <span class="s0">return </span><span class="s2">(</span><span class="s1">mismatchKeys</span><span class="s2">.</span><span class="s1">length </span><span class="s2">=== </span><span class="s6">0 </span><span class="s2">&amp;&amp; </span><span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">length </span><span class="s2">=== </span><span class="s6">0</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">equals_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">mismatchKeys</span><span class="s2">, </span><span class="s1">mismatchValues</span><span class="s2">) {</span>
  <span class="s1">mismatchKeys </span><span class="s2">= </span><span class="s1">mismatchKeys </span><span class="s2">|| [];</span>
  <span class="s1">mismatchValues </span><span class="s2">= </span><span class="s1">mismatchValues </span><span class="s2">|| [];</span>

  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">equalityTesters_</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">var </span><span class="s1">equalityTester </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">equalityTesters_</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>
    <span class="s0">var </span><span class="s1">result </span><span class="s2">= </span><span class="s1">equalityTester</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s0">this</span><span class="s2">, </span><span class="s1">mismatchKeys</span><span class="s2">, </span><span class="s1">mismatchValues</span><span class="s2">);</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">result </span><span class="s2">!== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">) </span><span class="s0">return </span><span class="s1">result</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">a </span><span class="s2">=== </span><span class="s1">b</span><span class="s2">) </span><span class="s0">return true</span><span class="s2">;</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">a </span><span class="s2">=== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined </span><span class="s2">|| </span><span class="s1">a </span><span class="s2">=== </span><span class="s0">null </span><span class="s2">|| </span><span class="s1">b </span><span class="s2">=== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined </span><span class="s2">|| </span><span class="s1">b </span><span class="s2">=== </span><span class="s0">null</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s2">(</span><span class="s1">a </span><span class="s2">== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined </span><span class="s2">&amp;&amp; </span><span class="s1">b </span><span class="s2">== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isDomNode</span><span class="s2">(</span><span class="s1">a</span><span class="s2">) &amp;&amp; </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isDomNode</span><span class="s2">(</span><span class="s1">b</span><span class="s2">)) {</span>
    <span class="s0">return </span><span class="s1">a </span><span class="s2">=== </span><span class="s1">b</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">a </span><span class="s0">instanceof </span><span class="s1">Date </span><span class="s2">&amp;&amp; </span><span class="s1">b </span><span class="s0">instanceof </span><span class="s1">Date</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">a</span><span class="s2">.</span><span class="s1">getTime</span><span class="s2">() == </span><span class="s1">b</span><span class="s2">.</span><span class="s1">getTime</span><span class="s2">();</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">jasmineMatches</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">a</span><span class="s2">.</span><span class="s1">jasmineMatches</span><span class="s2">(</span><span class="s1">b</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">b</span><span class="s2">.</span><span class="s1">jasmineMatches</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">b</span><span class="s2">.</span><span class="s1">jasmineMatches</span><span class="s2">(</span><span class="s1">a</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">a </span><span class="s0">instanceof </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">ObjectContaining</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">a</span><span class="s2">.</span><span class="s1">matches</span><span class="s2">(</span><span class="s1">b</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">b </span><span class="s0">instanceof </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">ObjectContaining</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">b</span><span class="s2">.</span><span class="s1">matches</span><span class="s2">(</span><span class="s1">a</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isString_</span><span class="s2">(</span><span class="s1">a</span><span class="s2">) &amp;&amp; </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isString_</span><span class="s2">(</span><span class="s1">b</span><span class="s2">)) {</span>
    <span class="s0">return </span><span class="s2">(</span><span class="s1">a </span><span class="s2">== </span><span class="s1">b</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isNumber_</span><span class="s2">(</span><span class="s1">a</span><span class="s2">) &amp;&amp; </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isNumber_</span><span class="s2">(</span><span class="s1">b</span><span class="s2">)) {</span>
    <span class="s0">return </span><span class="s2">(</span><span class="s1">a </span><span class="s2">== </span><span class="s1">b</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">a </span><span class="s0">instanceof </span><span class="s1">RegExp </span><span class="s2">&amp;&amp; </span><span class="s1">b </span><span class="s0">instanceof </span><span class="s1">RegExp</span><span class="s2">) {</span>
    <span class="s0">return this</span><span class="s2">.</span><span class="s1">compareRegExps_</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">mismatchKeys</span><span class="s2">, </span><span class="s1">mismatchValues</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s0">typeof </span><span class="s1">a </span><span class="s2">=== </span><span class="s3">&quot;object&quot; </span><span class="s2">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">b </span><span class="s2">=== </span><span class="s3">&quot;object&quot;</span><span class="s2">) {</span>
    <span class="s0">return this</span><span class="s2">.</span><span class="s1">compareObjects_</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">mismatchKeys</span><span class="s2">, </span><span class="s1">mismatchValues</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s7">//Straight check</span>
  <span class="s0">return </span><span class="s2">(</span><span class="s1">a </span><span class="s2">=== </span><span class="s1">b</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">contains_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">haystack</span><span class="s2">, </span><span class="s1">needle</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isArray_</span><span class="s2">(</span><span class="s1">haystack</span><span class="s2">)) {</span>
    <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">haystack</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">equals_</span><span class="s2">(</span><span class="s1">haystack</span><span class="s2">[</span><span class="s1">i</span><span class="s2">], </span><span class="s1">needle</span><span class="s2">)) </span><span class="s0">return true</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s0">return false</span><span class="s2">;</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">haystack</span><span class="s2">.</span><span class="s1">indexOf</span><span class="s2">(</span><span class="s1">needle</span><span class="s2">) &gt;= </span><span class="s6">0</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Env</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">addEqualityTester </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">equalityTester</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">equalityTesters_</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">equalityTester</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s4">/** No-op base class for Jasmine reporters.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Reporter </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
<span class="s2">};</span>

<span class="s7">//noinspection JSUnusedLocalSymbols</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Reporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reportRunnerStarting </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">runner</span><span class="s2">) {</span>
<span class="s2">};</span>

<span class="s7">//noinspection JSUnusedLocalSymbols</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Reporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reportRunnerResults </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">runner</span><span class="s2">) {</span>
<span class="s2">};</span>

<span class="s7">//noinspection JSUnusedLocalSymbols</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Reporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reportSuiteResults </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">suite</span><span class="s2">) {</span>
<span class="s2">};</span>

<span class="s7">//noinspection JSUnusedLocalSymbols</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Reporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reportSpecStarting </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">spec</span><span class="s2">) {</span>
<span class="s2">};</span>

<span class="s7">//noinspection JSUnusedLocalSymbols</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Reporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reportSpecResults </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">spec</span><span class="s2">) {</span>
<span class="s2">};</span>

<span class="s7">//noinspection JSUnusedLocalSymbols</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Reporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">log </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">str</span><span class="s2">) {</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Blocks are functions with executable code that make up a spec.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Env} env</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} func</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Spec} spec</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">env</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, </span><span class="s1">spec</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">env </span><span class="s2">= </span><span class="s1">env</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">func </span><span class="s2">= </span><span class="s1">func</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">spec </span><span class="s2">= </span><span class="s1">spec</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">execute </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(!</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">CATCH_EXCEPTIONS</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">func</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">spec</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">else </span><span class="s2">{</span>
    <span class="s0">try </span><span class="s2">{</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">func</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">spec</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">catch </span><span class="s2">(</span><span class="s1">e</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">spec</span><span class="s2">.</span><span class="s1">fail</span><span class="s2">(</span><span class="s1">e</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
  <span class="s1">onComplete</span><span class="s2">();</span>
<span class="s2">};</span>
<span class="s4">/** JavaScript API reporter.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">started </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">finished </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">suites_ </span><span class="s2">= [];</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">results_ </span><span class="s2">= {};</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reportRunnerStarting </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">runner</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">started </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">suites </span><span class="s2">= </span><span class="s1">runner</span><span class="s2">.</span><span class="s1">topLevelSuites</span><span class="s2">();</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">suites</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">var </span><span class="s1">suite </span><span class="s2">= </span><span class="s1">suites</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">suites_</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">summarize_</span><span class="s2">(</span><span class="s1">suite</span><span class="s2">));</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">suites </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">suites_</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">summarize_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">suiteOrSpec</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">isSuite </span><span class="s2">= </span><span class="s1">suiteOrSpec </span><span class="s0">instanceof </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">summary </span><span class="s2">= {</span>
    <span class="s1">id</span><span class="s2">: </span><span class="s1">suiteOrSpec</span><span class="s2">.</span><span class="s1">id</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">: </span><span class="s1">suiteOrSpec</span><span class="s2">.</span><span class="s1">description</span><span class="s2">,</span>
    <span class="s1">type</span><span class="s2">: </span><span class="s1">isSuite </span><span class="s2">? </span><span class="s3">'suite' </span><span class="s2">: </span><span class="s3">'spec'</span><span class="s2">,</span>
    <span class="s1">children</span><span class="s2">: []</span>
  <span class="s2">};</span>
  
  <span class="s0">if </span><span class="s2">(</span><span class="s1">isSuite</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">children </span><span class="s2">= </span><span class="s1">suiteOrSpec</span><span class="s2">.</span><span class="s1">children</span><span class="s2">();</span>
    <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">children</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
      <span class="s1">summary</span><span class="s2">.</span><span class="s1">children</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">summarize_</span><span class="s2">(</span><span class="s1">children</span><span class="s2">[</span><span class="s1">i</span><span class="s2">]));</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">summary</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">results </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">results_</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">resultsForSpec </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">specId</span><span class="s2">) {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">results_</span><span class="s2">[</span><span class="s1">specId</span><span class="s2">];</span>
<span class="s2">};</span>

<span class="s7">//noinspection JSUnusedLocalSymbols</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reportRunnerResults </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">runner</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">finished </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s7">//noinspection JSUnusedLocalSymbols</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reportSuiteResults </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">suite</span><span class="s2">) {</span>
<span class="s2">};</span>

<span class="s7">//noinspection JSUnusedLocalSymbols</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reportSpecResults </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">spec</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">results_</span><span class="s2">[</span><span class="s1">spec</span><span class="s2">.</span><span class="s1">id</span><span class="s2">] = {</span>
    <span class="s1">messages</span><span class="s2">: </span><span class="s1">spec</span><span class="s2">.</span><span class="s1">results</span><span class="s2">().</span><span class="s1">getItems</span><span class="s2">(),</span>
    <span class="s1">result</span><span class="s2">: </span><span class="s1">spec</span><span class="s2">.</span><span class="s1">results</span><span class="s2">().</span><span class="s1">failedCount </span><span class="s2">&gt; </span><span class="s6">0 </span><span class="s2">? </span><span class="s3">&quot;failed&quot; </span><span class="s2">: </span><span class="s3">&quot;passed&quot;</span>
  <span class="s2">};</span>
<span class="s2">};</span>

<span class="s7">//noinspection JSUnusedLocalSymbols</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">log </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">str</span><span class="s2">) {</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">resultsForSpecs </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">specIds</span><span class="s2">){</span>
  <span class="s0">var </span><span class="s1">results </span><span class="s2">= {};</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">specIds</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">var </span><span class="s1">specId </span><span class="s2">= </span><span class="s1">specIds</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>
    <span class="s1">results</span><span class="s2">[</span><span class="s1">specId</span><span class="s2">] = </span><span class="s0">this</span><span class="s2">.</span><span class="s1">summarizeResult_</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">results_</span><span class="s2">[</span><span class="s1">specId</span><span class="s2">]);</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">results</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">JsApiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">summarizeResult_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">result</span><span class="s2">){</span>
  <span class="s0">var </span><span class="s1">summaryMessages </span><span class="s2">= [];</span>
  <span class="s0">var </span><span class="s1">messagesLength </span><span class="s2">= </span><span class="s1">result</span><span class="s2">.</span><span class="s1">messages</span><span class="s2">.</span><span class="s1">length</span><span class="s2">;</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">messageIndex </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">messageIndex </span><span class="s2">&lt; </span><span class="s1">messagesLength</span><span class="s2">; </span><span class="s1">messageIndex</span><span class="s2">++) {</span>
    <span class="s0">var </span><span class="s1">resultMessage </span><span class="s2">= </span><span class="s1">result</span><span class="s2">.</span><span class="s1">messages</span><span class="s2">[</span><span class="s1">messageIndex</span><span class="s2">];</span>
    <span class="s1">summaryMessages</span><span class="s2">.</span><span class="s1">push</span><span class="s2">({</span>
      <span class="s1">text</span><span class="s2">: </span><span class="s1">resultMessage</span><span class="s2">.</span><span class="s1">type </span><span class="s2">== </span><span class="s3">'log' </span><span class="s2">? </span><span class="s1">resultMessage</span><span class="s2">.</span><span class="s1">toString</span><span class="s2">() : </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">,</span>
      <span class="s1">passed</span><span class="s2">: </span><span class="s1">resultMessage</span><span class="s2">.</span><span class="s1">passed </span><span class="s2">? </span><span class="s1">resultMessage</span><span class="s2">.</span><span class="s1">passed</span><span class="s2">() : </span><span class="s0">true</span><span class="s2">,</span>
      <span class="s1">type</span><span class="s2">: </span><span class="s1">resultMessage</span><span class="s2">.</span><span class="s1">type</span><span class="s2">,</span>
      <span class="s1">message</span><span class="s2">: </span><span class="s1">resultMessage</span><span class="s2">.</span><span class="s1">message</span><span class="s2">,</span>
      <span class="s1">trace</span><span class="s2">: {</span>
        <span class="s1">stack</span><span class="s2">: </span><span class="s1">resultMessage</span><span class="s2">.</span><span class="s1">passed </span><span class="s2">&amp;&amp; !</span><span class="s1">resultMessage</span><span class="s2">.</span><span class="s1">passed</span><span class="s2">() ? </span><span class="s1">resultMessage</span><span class="s2">.</span><span class="s1">trace</span><span class="s2">.</span><span class="s1">stack </span><span class="s2">: </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span>
      <span class="s2">}</span>
    <span class="s2">});</span>
  <span class="s2">}</span>

  <span class="s0">return </span><span class="s2">{</span>
    <span class="s1">result </span><span class="s2">: </span><span class="s1">result</span><span class="s2">.</span><span class="s1">result</span><span class="s2">,</span>
    <span class="s1">messages </span><span class="s2">: </span><span class="s1">summaryMessages</span>
  <span class="s2">};</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Env} env</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">actual</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Spec} spec</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">env</span><span class="s2">, </span><span class="s1">actual</span><span class="s2">, </span><span class="s1">spec</span><span class="s2">, </span><span class="s1">opt_isNot</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">env </span><span class="s2">= </span><span class="s1">env</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">= </span><span class="s1">actual</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">spec </span><span class="s2">= </span><span class="s1">spec</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">isNot </span><span class="s2">= </span><span class="s1">opt_isNot </span><span class="s2">|| </span><span class="s0">false</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">reportWasCalled_ </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s7">// todo: @deprecated as of Jasmine 0.11, remove soon [xw]</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">pp </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">str</span><span class="s2">) {</span>
  <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">&quot;jasmine.Matchers.pp() is no longer supported, please use jasmine.pp() instead!&quot;</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s7">// todo: @deprecated Deprecated as of Jasmine 0.10. Rewrite your custom matchers to return true or false. [xw]</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">report </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">failing_message</span><span class="s2">, </span><span class="s1">details</span><span class="s2">) {</span>
  <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">&quot;As of jasmine 0.11, custom matchers must be implemented differently -- please see jasmine docs&quot;</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">wrapInto_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">prototype</span><span class="s2">, </span><span class="s1">matchersClass</span><span class="s2">) {</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">methodName </span><span class="s0">in </span><span class="s1">prototype</span><span class="s2">) {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">methodName </span><span class="s2">== </span><span class="s3">'report'</span><span class="s2">) </span><span class="s0">continue</span><span class="s2">;</span>
    <span class="s0">var </span><span class="s1">orig </span><span class="s2">= </span><span class="s1">prototype</span><span class="s2">[</span><span class="s1">methodName</span><span class="s2">];</span>
    <span class="s1">matchersClass</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">[</span><span class="s1">methodName</span><span class="s2">] = </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">matcherFn_</span><span class="s2">(</span><span class="s1">methodName</span><span class="s2">, </span><span class="s1">orig</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">matcherFn_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">matcherName</span><span class="s2">, </span><span class="s1">matcherFunction</span><span class="s2">) {</span>
  <span class="s0">return function</span><span class="s2">() {</span>
    <span class="s0">var </span><span class="s1">matcherArgs </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">argsToArray</span><span class="s2">(</span><span class="s1">arguments</span><span class="s2">);</span>
    <span class="s0">var </span><span class="s1">result </span><span class="s2">= </span><span class="s1">matcherFunction</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>

    <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">isNot</span><span class="s2">) {</span>
      <span class="s1">result </span><span class="s2">= !</span><span class="s1">result</span><span class="s2">;</span>
    <span class="s2">}</span>

    <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">reportWasCalled_</span><span class="s2">) </span><span class="s0">return </span><span class="s1">result</span><span class="s2">;</span>

    <span class="s0">var </span><span class="s1">message</span><span class="s2">;</span>
    <span class="s0">if </span><span class="s2">(!</span><span class="s1">result</span><span class="s2">) {</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">message</span><span class="s2">) {</span>
        <span class="s1">message </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">message</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isArray_</span><span class="s2">(</span><span class="s1">message</span><span class="s2">)) {</span>
          <span class="s1">message </span><span class="s2">= </span><span class="s1">message</span><span class="s2">[</span><span class="s0">this</span><span class="s2">.</span><span class="s1">isNot </span><span class="s2">? </span><span class="s6">1 </span><span class="s2">: </span><span class="s6">0</span><span class="s2">];</span>
        <span class="s2">}</span>
      <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
        <span class="s0">var </span><span class="s1">englishyPredicate </span><span class="s2">= </span><span class="s1">matcherName</span><span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s8">/[A-Z]/g</span><span class="s2">, </span><span class="s0">function</span><span class="s2">(</span><span class="s1">s</span><span class="s2">) { </span><span class="s0">return </span><span class="s3">' ' </span><span class="s2">+ </span><span class="s1">s</span><span class="s2">.</span><span class="s1">toLowerCase</span><span class="s2">(); });</span>
        <span class="s1">message </span><span class="s2">= </span><span class="s3">&quot;Expected &quot; </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">) + (</span><span class="s0">this</span><span class="s2">.</span><span class="s1">isNot </span><span class="s2">? </span><span class="s3">&quot; not &quot; </span><span class="s2">: </span><span class="s3">&quot; &quot;</span><span class="s2">) + </span><span class="s1">englishyPredicate</span><span class="s2">;</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">matcherArgs</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s6">0</span><span class="s2">) {</span>
          <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">matcherArgs</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">i </span><span class="s2">&gt; </span><span class="s6">0</span><span class="s2">) </span><span class="s1">message </span><span class="s2">+= </span><span class="s3">&quot;,&quot;</span><span class="s2">;</span>
            <span class="s1">message </span><span class="s2">+= </span><span class="s3">&quot; &quot; </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s1">matcherArgs</span><span class="s2">[</span><span class="s1">i</span><span class="s2">]);</span>
          <span class="s2">}</span>
        <span class="s2">}</span>
        <span class="s1">message </span><span class="s2">+= </span><span class="s3">&quot;.&quot;</span><span class="s2">;</span>
      <span class="s2">}</span>
    <span class="s2">}</span>
    <span class="s0">var </span><span class="s1">expectationResult </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">ExpectationResult</span><span class="s2">({</span>
      <span class="s1">matcherName</span><span class="s2">: </span><span class="s1">matcherName</span><span class="s2">,</span>
      <span class="s1">passed</span><span class="s2">: </span><span class="s1">result</span><span class="s2">,</span>
      <span class="s1">expected</span><span class="s2">: </span><span class="s1">matcherArgs</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s6">1 </span><span class="s2">? </span><span class="s1">matcherArgs </span><span class="s2">: </span><span class="s1">matcherArgs</span><span class="s2">[</span><span class="s6">0</span><span class="s2">],</span>
      <span class="s1">actual</span><span class="s2">: </span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">,</span>
      <span class="s1">message</span><span class="s2">: </span><span class="s1">message</span>
    <span class="s2">});</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">spec</span><span class="s2">.</span><span class="s1">addMatcherResult</span><span class="s2">(</span><span class="s1">expectationResult</span><span class="s2">);</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">;</span>
  <span class="s2">};</span>
<span class="s2">};</span>




<span class="s4">/**</span>
 <span class="s4">* toBe: compares the actual to the expected using ===</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">expected</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toBe </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">=== </span><span class="s1">expected</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* toNotBe: compares the actual to the expected using !==</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">expected</span>
 <span class="s4">* </span><span class="s5">@deprecated </span><span class="s4">as of 1.0. Use not.toBe() instead.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toNotBe </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">!== </span><span class="s1">expected</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* toEqual: compares the actual to the expected using common sense equality. Handles Objects, Arrays, etc.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">expected</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toEqual </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">equals_</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* toNotEqual: compares the actual to the expected using the ! of jasmine.Matchers.toEqual</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">expected</span>
 <span class="s4">* </span><span class="s5">@deprecated </span><span class="s4">as of 1.0. Use not.toEqual() instead.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toNotEqual </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s2">!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">equals_</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that compares the actual to the expected using a regular expression.  Constructs a RegExp, so takes</span>
 <span class="s4">* a pattern or a String.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">expected</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toMatch </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">return new </span><span class="s1">RegExp</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">).</span><span class="s1">test</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that compares the actual to the expected using the boolean inverse of jasmine.Matchers.toMatch</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">expected</span>
 <span class="s4">* </span><span class="s5">@deprecated </span><span class="s4">as of 1.0. Use not.toMatch() instead.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toNotMatch </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s2">!(</span><span class="s0">new </span><span class="s1">RegExp</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">).</span><span class="s1">test</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">));</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that compares the actual to jasmine.undefined.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toBeDefined </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">!== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that compares the actual to jasmine.undefined.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toBeUndefined </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">=== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that compares the actual to null.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toBeNull </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">=== </span><span class="s0">null</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that compares the actual to NaN.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toBeNaN </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
	<span class="s0">this</span><span class="s2">.</span><span class="s1">message </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
		<span class="s0">return </span><span class="s2">[ </span><span class="s3">&quot;Expected &quot; </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">) + </span><span class="s3">&quot; to be NaN.&quot; </span><span class="s2">];</span>
	<span class="s2">};</span>

	<span class="s0">return </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">!== </span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that boolean not-nots the actual.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toBeTruthy </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return </span><span class="s2">!!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">;</span>
<span class="s2">};</span>


<span class="s4">/**</span>
 <span class="s4">* Matcher that boolean nots the actual.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toBeFalsy </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return </span><span class="s2">!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">;</span>
<span class="s2">};</span>


<span class="s4">/**</span>
 <span class="s4">* Matcher that checks to see if the actual, a Jasmine spy, was called.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toHaveBeenCalled </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">arguments</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s6">0</span><span class="s2">) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'toHaveBeenCalled does not take arguments, use toHaveBeenCalledWith'</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(!</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isSpy</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">)) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'Expected a spy, but got ' </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">) + </span><span class="s3">'.'</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">message </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">return </span><span class="s2">[</span>
      <span class="s3">&quot;Expected spy &quot; </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">identity </span><span class="s2">+ </span><span class="s3">&quot; to have been called.&quot;</span><span class="s2">,</span>
      <span class="s3">&quot;Expected spy &quot; </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">identity </span><span class="s2">+ </span><span class="s3">&quot; not to have been called.&quot;</span>
    <span class="s2">];</span>
  <span class="s2">};</span>

  <span class="s0">return this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">wasCalled</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/** </span><span class="s5">@deprecated </span><span class="s4">Use expect(xxx).toHaveBeenCalled() instead */</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">wasCalled </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toHaveBeenCalled</span><span class="s2">;</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that checks to see if the actual, a Jasmine spy, was not called.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@deprecated </span><span class="s4">Use expect(xxx).not.toHaveBeenCalled() instead</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">wasNotCalled </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">arguments</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s6">0</span><span class="s2">) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'wasNotCalled does not take arguments'</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(!</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isSpy</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">)) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'Expected a spy, but got ' </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">) + </span><span class="s3">'.'</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">message </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">return </span><span class="s2">[</span>
      <span class="s3">&quot;Expected spy &quot; </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">identity </span><span class="s2">+ </span><span class="s3">&quot; to not have been called.&quot;</span><span class="s2">,</span>
      <span class="s3">&quot;Expected spy &quot; </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">identity </span><span class="s2">+ </span><span class="s3">&quot; to have been called.&quot;</span>
    <span class="s2">];</span>
  <span class="s2">};</span>

  <span class="s0">return </span><span class="s2">!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">wasCalled</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that checks to see if the actual, a Jasmine spy, was called with a set of parameters.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@example</span>
 <span class="s4">*</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toHaveBeenCalledWith </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">expectedArgs </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">argsToArray</span><span class="s2">(</span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s0">if </span><span class="s2">(!</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isSpy</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">)) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'Expected a spy, but got ' </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">) + </span><span class="s3">'.'</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">message </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">var </span><span class="s1">invertedMessage </span><span class="s2">= </span><span class="s3">&quot;Expected spy &quot; </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">identity </span><span class="s2">+ </span><span class="s3">&quot; not to have been called with &quot; </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s1">expectedArgs</span><span class="s2">) + </span><span class="s3">&quot; but it was.&quot;</span><span class="s2">;</span>
    <span class="s0">var </span><span class="s1">positiveMessage </span><span class="s2">= </span><span class="s3">&quot;&quot;</span><span class="s2">;</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">callCount </span><span class="s2">=== </span><span class="s6">0</span><span class="s2">) {</span>
      <span class="s1">positiveMessage </span><span class="s2">= </span><span class="s3">&quot;Expected spy &quot; </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">identity </span><span class="s2">+ </span><span class="s3">&quot; to have been called with &quot; </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s1">expectedArgs</span><span class="s2">) + </span><span class="s3">&quot; but it was never called.&quot;</span><span class="s2">;</span>
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
      <span class="s1">positiveMessage </span><span class="s2">= </span><span class="s3">&quot;Expected spy &quot; </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">identity </span><span class="s2">+ </span><span class="s3">&quot; to have been called with &quot; </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s1">expectedArgs</span><span class="s2">) + </span><span class="s3">&quot; but actual calls were &quot; </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">argsForCall</span><span class="s2">).</span><span class="s1">replace</span><span class="s2">(</span><span class="s8">/^\[ | \]$/g</span><span class="s2">, </span><span class="s3">''</span><span class="s2">)</span>
    <span class="s2">}</span>
    <span class="s0">return </span><span class="s2">[</span><span class="s1">positiveMessage</span><span class="s2">, </span><span class="s1">invertedMessage</span><span class="s2">];</span>
  <span class="s2">};</span>

  <span class="s0">return this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">contains_</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">argsForCall</span><span class="s2">, </span><span class="s1">expectedArgs</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/** </span><span class="s5">@deprecated </span><span class="s4">Use expect(xxx).toHaveBeenCalledWith() instead */</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">wasCalledWith </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toHaveBeenCalledWith</span><span class="s2">;</span>

<span class="s4">/** </span><span class="s5">@deprecated </span><span class="s4">Use expect(xxx).not.toHaveBeenCalledWith() instead */</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">wasNotCalledWith </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">expectedArgs </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">argsToArray</span><span class="s2">(</span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s0">if </span><span class="s2">(!</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isSpy</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">)) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'Expected a spy, but got ' </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">) + </span><span class="s3">'.'</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">message </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">return </span><span class="s2">[</span>
      <span class="s3">&quot;Expected spy not to have been called with &quot; </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s1">expectedArgs</span><span class="s2">) + </span><span class="s3">&quot; but it was&quot;</span><span class="s2">,</span>
      <span class="s3">&quot;Expected spy to have been called with &quot; </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s1">expectedArgs</span><span class="s2">) + </span><span class="s3">&quot; but it was&quot;</span>
    <span class="s2">];</span>
  <span class="s2">};</span>

  <span class="s0">return </span><span class="s2">!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">contains_</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">argsForCall</span><span class="s2">, </span><span class="s1">expectedArgs</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that checks that the expected item is an element in the actual Array.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Object} expected</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toContain </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">contains_</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that checks that the expected item is NOT an element in the actual Array.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Object} expected</span>
 <span class="s4">* </span><span class="s5">@deprecated </span><span class="s4">as of 1.0. Use not.toContain() instead.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toNotContain </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">return </span><span class="s2">!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">contains_</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toBeLessThan </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">&lt; </span><span class="s1">expected</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toBeGreaterThan </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">&gt; </span><span class="s1">expected</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that checks that the expected item is equal to the actual item</span>
 <span class="s4">* up to a given level of decimal precision (default 2).</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Number} expected</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Number} precision, as number of decimal places</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toBeCloseTo </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">precision</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(!(</span><span class="s1">precision </span><span class="s2">=== </span><span class="s6">0</span><span class="s2">)) {</span>
    <span class="s1">precision </span><span class="s2">= </span><span class="s1">precision </span><span class="s2">|| </span><span class="s6">2</span><span class="s2">;</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">Math</span><span class="s2">.</span><span class="s1">abs</span><span class="s2">(</span><span class="s1">expected </span><span class="s2">- </span><span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">) &lt; (</span><span class="s1">Math</span><span class="s2">.</span><span class="s1">pow</span><span class="s2">(</span><span class="s6">10</span><span class="s2">, -</span><span class="s1">precision</span><span class="s2">) / </span><span class="s6">2</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Matcher that checks that the expected exception was thrown by the actual.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} [expected]</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">toThrow </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">result </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">exception</span><span class="s2">;</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s0">typeof this</span><span class="s2">.</span><span class="s1">actual </span><span class="s2">!= </span><span class="s3">'function'</span><span class="s2">) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'Actual is not a function'</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">try </span><span class="s2">{</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">actual</span><span class="s2">();</span>
  <span class="s2">} </span><span class="s0">catch </span><span class="s2">(</span><span class="s1">e</span><span class="s2">) {</span>
    <span class="s1">exception </span><span class="s2">= </span><span class="s1">e</span><span class="s2">;</span>
  <span class="s2">}</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">exception</span><span class="s2">) {</span>
    <span class="s1">result </span><span class="s2">= (</span><span class="s1">expected </span><span class="s2">=== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined </span><span class="s2">|| </span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">equals_</span><span class="s2">(</span><span class="s1">exception</span><span class="s2">.</span><span class="s1">message </span><span class="s2">|| </span><span class="s1">exception</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">message </span><span class="s2">|| </span><span class="s1">expected</span><span class="s2">));</span>
  <span class="s2">}</span>

  <span class="s0">var </span><span class="s1">not </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">isNot </span><span class="s2">? </span><span class="s3">&quot;not &quot; </span><span class="s2">: </span><span class="s3">&quot;&quot;</span><span class="s2">;</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">message </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">exception </span><span class="s2">&amp;&amp; (</span><span class="s1">expected </span><span class="s2">=== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined </span><span class="s2">|| !</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">equals_</span><span class="s2">(</span><span class="s1">exception</span><span class="s2">.</span><span class="s1">message </span><span class="s2">|| </span><span class="s1">exception</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">message </span><span class="s2">|| </span><span class="s1">expected</span><span class="s2">))) {</span>
      <span class="s0">return </span><span class="s2">[</span><span class="s3">&quot;Expected function &quot; </span><span class="s2">+ </span><span class="s1">not </span><span class="s2">+ </span><span class="s3">&quot;to throw&quot;</span><span class="s2">, </span><span class="s1">expected </span><span class="s2">? </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">message </span><span class="s2">|| </span><span class="s1">expected </span><span class="s2">: </span><span class="s3">&quot;an exception&quot;</span><span class="s2">, </span><span class="s3">&quot;, but it threw&quot;</span><span class="s2">, </span><span class="s1">exception</span><span class="s2">.</span><span class="s1">message </span><span class="s2">|| </span><span class="s1">exception</span><span class="s2">].</span><span class="s1">join</span><span class="s2">(</span><span class="s3">' '</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
      <span class="s0">return </span><span class="s3">&quot;Expected function to throw an exception.&quot;</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">};</span>

  <span class="s0">return </span><span class="s1">result</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">Any </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">expectedClass</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">expectedClass </span><span class="s2">= </span><span class="s1">expectedClass</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">Any</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">jasmineMatches </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">other</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">expectedClass </span><span class="s2">== </span><span class="s1">String</span><span class="s2">) {</span>
    <span class="s0">return typeof </span><span class="s1">other </span><span class="s2">== </span><span class="s3">'string' </span><span class="s2">|| </span><span class="s1">other </span><span class="s0">instanceof </span><span class="s1">String</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">expectedClass </span><span class="s2">== </span><span class="s1">Number</span><span class="s2">) {</span>
    <span class="s0">return typeof </span><span class="s1">other </span><span class="s2">== </span><span class="s3">'number' </span><span class="s2">|| </span><span class="s1">other </span><span class="s0">instanceof </span><span class="s1">Number</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">expectedClass </span><span class="s2">== </span><span class="s1">Function</span><span class="s2">) {</span>
    <span class="s0">return typeof </span><span class="s1">other </span><span class="s2">== </span><span class="s3">'function' </span><span class="s2">|| </span><span class="s1">other </span><span class="s0">instanceof </span><span class="s1">Function</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">expectedClass </span><span class="s2">== </span><span class="s1">Object</span><span class="s2">) {</span>
    <span class="s0">return typeof </span><span class="s1">other </span><span class="s2">== </span><span class="s3">'object'</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">return </span><span class="s1">other </span><span class="s0">instanceof this</span><span class="s2">.</span><span class="s1">expectedClass</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">Any</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">jasmineToString </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return </span><span class="s3">'&lt;jasmine.any(' </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">expectedClass </span><span class="s2">+ </span><span class="s3">')&gt;'</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">ObjectContaining </span><span class="s2">= </span><span class="s0">function </span><span class="s2">(</span><span class="s1">sample</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">sample </span><span class="s2">= </span><span class="s1">sample</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">ObjectContaining</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">jasmineMatches </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">other</span><span class="s2">, </span><span class="s1">mismatchKeys</span><span class="s2">, </span><span class="s1">mismatchValues</span><span class="s2">) {</span>
  <span class="s1">mismatchKeys </span><span class="s2">= </span><span class="s1">mismatchKeys </span><span class="s2">|| [];</span>
  <span class="s1">mismatchValues </span><span class="s2">= </span><span class="s1">mismatchValues </span><span class="s2">|| [];</span>

  <span class="s0">var </span><span class="s1">env </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">();</span>

  <span class="s0">var </span><span class="s1">hasKey </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">, </span><span class="s1">keyName</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">obj </span><span class="s2">!= </span><span class="s0">null </span><span class="s2">&amp;&amp; </span><span class="s1">obj</span><span class="s2">[</span><span class="s1">keyName</span><span class="s2">] !== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">;</span>
  <span class="s2">};</span>

  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">property </span><span class="s0">in this</span><span class="s2">.</span><span class="s1">sample</span><span class="s2">) {</span>
    <span class="s0">if </span><span class="s2">(!</span><span class="s1">hasKey</span><span class="s2">(</span><span class="s1">other</span><span class="s2">, </span><span class="s1">property</span><span class="s2">) &amp;&amp; </span><span class="s1">hasKey</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">sample</span><span class="s2">, </span><span class="s1">property</span><span class="s2">)) {</span>
      <span class="s1">mismatchKeys</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;expected has key '&quot; </span><span class="s2">+ </span><span class="s1">property </span><span class="s2">+ </span><span class="s3">&quot;', but missing from actual.&quot;</span><span class="s2">);</span>
    <span class="s2">}</span>
    <span class="s0">else if </span><span class="s2">(!</span><span class="s1">env</span><span class="s2">.</span><span class="s1">equals_</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">sample</span><span class="s2">[</span><span class="s1">property</span><span class="s2">], </span><span class="s1">other</span><span class="s2">[</span><span class="s1">property</span><span class="s2">], </span><span class="s1">mismatchKeys</span><span class="s2">, </span><span class="s1">mismatchValues</span><span class="s2">)) {</span>
      <span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s3">&quot;'&quot; </span><span class="s2">+ </span><span class="s1">property </span><span class="s2">+ </span><span class="s3">&quot;' was '&quot; </span><span class="s2">+ (</span><span class="s1">other</span><span class="s2">[</span><span class="s1">property</span><span class="s2">] ? </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">htmlEscape</span><span class="s2">(</span><span class="s1">other</span><span class="s2">[</span><span class="s1">property</span><span class="s2">].</span><span class="s1">toString</span><span class="s2">()) : </span><span class="s1">other</span><span class="s2">[</span><span class="s1">property</span><span class="s2">]) + </span><span class="s3">&quot;' in expected, but was '&quot; </span><span class="s2">+ (</span><span class="s0">this</span><span class="s2">.</span><span class="s1">sample</span><span class="s2">[</span><span class="s1">property</span><span class="s2">] ? </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">htmlEscape</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">sample</span><span class="s2">[</span><span class="s1">property</span><span class="s2">].</span><span class="s1">toString</span><span class="s2">()) : </span><span class="s0">this</span><span class="s2">.</span><span class="s1">sample</span><span class="s2">[</span><span class="s1">property</span><span class="s2">]) + </span><span class="s3">&quot;' in actual.&quot;</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">}</span>

  <span class="s0">return </span><span class="s2">(</span><span class="s1">mismatchKeys</span><span class="s2">.</span><span class="s1">length </span><span class="s2">=== </span><span class="s6">0 </span><span class="s2">&amp;&amp; </span><span class="s1">mismatchValues</span><span class="s2">.</span><span class="s1">length </span><span class="s2">=== </span><span class="s6">0</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">ObjectContaining</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">jasmineToString </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
  <span class="s0">return </span><span class="s3">&quot;&lt;jasmine.objectContaining(&quot; </span><span class="s2">+ </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">pp</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">sample</span><span class="s2">) + </span><span class="s3">&quot;)&gt;&quot;</span><span class="s2">;</span>
<span class="s2">};</span>
<span class="s7">// Mock setTimeout, clearTimeout</span>
<span class="s7">// Contributed by Pivotal Computer Systems, www.pivotalsf.com</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">FakeTimer </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">reset</span><span class="s2">();</span>

  <span class="s0">var </span><span class="s1">self </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">setTimeout </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">) {</span>
    <span class="s1">self</span><span class="s2">.</span><span class="s1">timeoutsMade</span><span class="s2">++;</span>
    <span class="s1">self</span><span class="s2">.</span><span class="s1">scheduleFunction</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">timeoutsMade</span><span class="s2">, </span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">, </span><span class="s0">false</span><span class="s2">);</span>
    <span class="s0">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">timeoutsMade</span><span class="s2">;</span>
  <span class="s2">};</span>

  <span class="s1">self</span><span class="s2">.</span><span class="s1">setInterval </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">) {</span>
    <span class="s1">self</span><span class="s2">.</span><span class="s1">timeoutsMade</span><span class="s2">++;</span>
    <span class="s1">self</span><span class="s2">.</span><span class="s1">scheduleFunction</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">timeoutsMade</span><span class="s2">, </span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">, </span><span class="s0">true</span><span class="s2">);</span>
    <span class="s0">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">timeoutsMade</span><span class="s2">;</span>
  <span class="s2">};</span>

  <span class="s1">self</span><span class="s2">.</span><span class="s1">clearTimeout </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">timeoutKey</span><span class="s2">) {</span>
    <span class="s1">self</span><span class="s2">.</span><span class="s1">scheduledFunctions</span><span class="s2">[</span><span class="s1">timeoutKey</span><span class="s2">] = </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">;</span>
  <span class="s2">};</span>

  <span class="s1">self</span><span class="s2">.</span><span class="s1">clearInterval </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">timeoutKey</span><span class="s2">) {</span>
    <span class="s1">self</span><span class="s2">.</span><span class="s1">scheduledFunctions</span><span class="s2">[</span><span class="s1">timeoutKey</span><span class="s2">] = </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">;</span>
  <span class="s2">};</span>

<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">FakeTimer</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">reset </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">timeoutsMade </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">scheduledFunctions </span><span class="s2">= {};</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">nowMillis </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">FakeTimer</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">tick </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">millis</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">oldMillis </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">nowMillis</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">newMillis </span><span class="s2">= </span><span class="s1">oldMillis </span><span class="s2">+ </span><span class="s1">millis</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">runFunctionsWithinRange</span><span class="s2">(</span><span class="s1">oldMillis</span><span class="s2">, </span><span class="s1">newMillis</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">nowMillis </span><span class="s2">= </span><span class="s1">newMillis</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">FakeTimer</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">runFunctionsWithinRange </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">oldMillis</span><span class="s2">, </span><span class="s1">nowMillis</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">scheduledFunc</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">funcsToRun </span><span class="s2">= [];</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">timeoutKey </span><span class="s0">in this</span><span class="s2">.</span><span class="s1">scheduledFunctions</span><span class="s2">) {</span>
    <span class="s1">scheduledFunc </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">scheduledFunctions</span><span class="s2">[</span><span class="s1">timeoutKey</span><span class="s2">];</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">scheduledFunc </span><span class="s2">!= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined </span><span class="s2">&amp;&amp;</span>
        <span class="s1">scheduledFunc</span><span class="s2">.</span><span class="s1">runAtMillis </span><span class="s2">&gt;= </span><span class="s1">oldMillis </span><span class="s2">&amp;&amp;</span>
        <span class="s1">scheduledFunc</span><span class="s2">.</span><span class="s1">runAtMillis </span><span class="s2">&lt;= </span><span class="s1">nowMillis</span><span class="s2">) {</span>
      <span class="s1">funcsToRun</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">scheduledFunc</span><span class="s2">);</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">scheduledFunctions</span><span class="s2">[</span><span class="s1">timeoutKey</span><span class="s2">] = </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">funcsToRun</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s6">0</span><span class="s2">) {</span>
    <span class="s1">funcsToRun</span><span class="s2">.</span><span class="s1">sort</span><span class="s2">(</span><span class="s0">function</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">) {</span>
      <span class="s0">return </span><span class="s1">a</span><span class="s2">.</span><span class="s1">runAtMillis </span><span class="s2">- </span><span class="s1">b</span><span class="s2">.</span><span class="s1">runAtMillis</span><span class="s2">;</span>
    <span class="s2">});</span>
    <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">funcsToRun</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; ++</span><span class="s1">i</span><span class="s2">) {</span>
      <span class="s0">try </span><span class="s2">{</span>
        <span class="s0">var </span><span class="s1">funcToRun </span><span class="s2">= </span><span class="s1">funcsToRun</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">nowMillis </span><span class="s2">= </span><span class="s1">funcToRun</span><span class="s2">.</span><span class="s1">runAtMillis</span><span class="s2">;</span>
        <span class="s1">funcToRun</span><span class="s2">.</span><span class="s1">funcToCall</span><span class="s2">();</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">funcToRun</span><span class="s2">.</span><span class="s1">recurring</span><span class="s2">) {</span>
          <span class="s0">this</span><span class="s2">.</span><span class="s1">scheduleFunction</span><span class="s2">(</span><span class="s1">funcToRun</span><span class="s2">.</span><span class="s1">timeoutKey</span><span class="s2">,</span>
              <span class="s1">funcToRun</span><span class="s2">.</span><span class="s1">funcToCall</span><span class="s2">,</span>
              <span class="s1">funcToRun</span><span class="s2">.</span><span class="s1">millis</span><span class="s2">,</span>
              <span class="s0">true</span><span class="s2">);</span>
        <span class="s2">}</span>
      <span class="s2">} </span><span class="s0">catch</span><span class="s2">(</span><span class="s1">e</span><span class="s2">) {</span>
      <span class="s2">}</span>
    <span class="s2">}</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">runFunctionsWithinRange</span><span class="s2">(</span><span class="s1">oldMillis</span><span class="s2">, </span><span class="s1">nowMillis</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">FakeTimer</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">scheduleFunction </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">timeoutKey</span><span class="s2">, </span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">, </span><span class="s1">recurring</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">scheduledFunctions</span><span class="s2">[</span><span class="s1">timeoutKey</span><span class="s2">] = {</span>
    <span class="s1">runAtMillis</span><span class="s2">: </span><span class="s0">this</span><span class="s2">.</span><span class="s1">nowMillis </span><span class="s2">+ </span><span class="s1">millis</span><span class="s2">,</span>
    <span class="s1">funcToCall</span><span class="s2">: </span><span class="s1">funcToCall</span><span class="s2">,</span>
    <span class="s1">recurring</span><span class="s2">: </span><span class="s1">recurring</span><span class="s2">,</span>
    <span class="s1">timeoutKey</span><span class="s2">: </span><span class="s1">timeoutKey</span><span class="s2">,</span>
    <span class="s1">millis</span><span class="s2">: </span><span class="s1">millis</span>
  <span class="s2">};</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@namespace</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock </span><span class="s2">= {</span>
  <span class="s1">defaultFakeTimer</span><span class="s2">: </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">FakeTimer</span><span class="s2">(),</span>

  <span class="s1">reset</span><span class="s2">: </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">assertInstalled</span><span class="s2">();</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">defaultFakeTimer</span><span class="s2">.</span><span class="s1">reset</span><span class="s2">();</span>
  <span class="s2">},</span>

  <span class="s1">tick</span><span class="s2">: </span><span class="s0">function</span><span class="s2">(</span><span class="s1">millis</span><span class="s2">) {</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">assertInstalled</span><span class="s2">();</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">defaultFakeTimer</span><span class="s2">.</span><span class="s1">tick</span><span class="s2">(</span><span class="s1">millis</span><span class="s2">);</span>
  <span class="s2">},</span>

  <span class="s1">runFunctionsWithinRange</span><span class="s2">: </span><span class="s0">function</span><span class="s2">(</span><span class="s1">oldMillis</span><span class="s2">, </span><span class="s1">nowMillis</span><span class="s2">) {</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">defaultFakeTimer</span><span class="s2">.</span><span class="s1">runFunctionsWithinRange</span><span class="s2">(</span><span class="s1">oldMillis</span><span class="s2">, </span><span class="s1">nowMillis</span><span class="s2">);</span>
  <span class="s2">},</span>

  <span class="s1">scheduleFunction</span><span class="s2">: </span><span class="s0">function</span><span class="s2">(</span><span class="s1">timeoutKey</span><span class="s2">, </span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">, </span><span class="s1">recurring</span><span class="s2">) {</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">defaultFakeTimer</span><span class="s2">.</span><span class="s1">scheduleFunction</span><span class="s2">(</span><span class="s1">timeoutKey</span><span class="s2">, </span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">, </span><span class="s1">recurring</span><span class="s2">);</span>
  <span class="s2">},</span>

  <span class="s1">useMock</span><span class="s2">: </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">if </span><span class="s2">(!</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">isInstalled</span><span class="s2">()) {</span>
      <span class="s0">var </span><span class="s1">spec </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getEnv</span><span class="s2">().</span><span class="s1">currentSpec</span><span class="s2">;</span>
      <span class="s1">spec</span><span class="s2">.</span><span class="s1">after</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">uninstallMock</span><span class="s2">);</span>

      <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installMock</span><span class="s2">();</span>
    <span class="s2">}</span>
  <span class="s2">},</span>

  <span class="s1">installMock</span><span class="s2">: </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">defaultFakeTimer</span><span class="s2">;</span>
  <span class="s2">},</span>

  <span class="s1">uninstallMock</span><span class="s2">: </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">assertInstalled</span><span class="s2">();</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">real</span><span class="s2">;</span>
  <span class="s2">},</span>

  <span class="s1">real</span><span class="s2">: {</span>
    <span class="s1">setTimeout</span><span class="s2">: </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">().</span><span class="s1">setTimeout</span><span class="s2">,</span>
    <span class="s1">clearTimeout</span><span class="s2">: </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">().</span><span class="s1">clearTimeout</span><span class="s2">,</span>
    <span class="s1">setInterval</span><span class="s2">: </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">().</span><span class="s1">setInterval</span><span class="s2">,</span>
    <span class="s1">clearInterval</span><span class="s2">: </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">().</span><span class="s1">clearInterval</span>
  <span class="s2">},</span>

  <span class="s1">assertInstalled</span><span class="s2">: </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">if </span><span class="s2">(!</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">isInstalled</span><span class="s2">()) {</span>
      <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">&quot;Mock clock is not installed, use jasmine.Clock.useMock()&quot;</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">},</span>

  <span class="s1">isInstalled</span><span class="s2">: </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed </span><span class="s2">== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">defaultFakeTimer</span><span class="s2">;</span>
  <span class="s2">},</span>

  <span class="s1">installed</span><span class="s2">: </span><span class="s0">null</span>
<span class="s2">};</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">real</span><span class="s2">;</span>

<span class="s7">//else for IE support</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">().</span><span class="s1">setTimeout </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">setTimeout</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">setTimeout</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">setTimeout</span><span class="s2">(</span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">().</span><span class="s1">setInterval </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">setInterval</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">setInterval</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">setInterval</span><span class="s2">(</span><span class="s1">funcToCall</span><span class="s2">, </span><span class="s1">millis</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">().</span><span class="s1">clearTimeout </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">timeoutKey</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">clearTimeout</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">clearTimeout</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">clearTimeout</span><span class="s2">(</span><span class="s1">timeoutKey</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">().</span><span class="s1">clearInterval </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">timeoutKey</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">clearTimeout</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">clearInterval</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">return </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Clock</span><span class="s2">.</span><span class="s1">installed</span><span class="s2">.</span><span class="s1">clearInterval</span><span class="s2">(</span><span class="s1">timeoutKey</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MultiReporter </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">subReporters_ </span><span class="s2">= [];</span>
<span class="s2">};</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">inherit</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MultiReporter</span><span class="s2">, </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Reporter</span><span class="s2">);</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MultiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">addReporter </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">reporter</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">subReporters_</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">reporter</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s2">(</span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">functionNames </span><span class="s2">= [</span>
    <span class="s3">&quot;reportRunnerStarting&quot;</span><span class="s2">,</span>
    <span class="s3">&quot;reportRunnerResults&quot;</span><span class="s2">,</span>
    <span class="s3">&quot;reportSuiteResults&quot;</span><span class="s2">,</span>
    <span class="s3">&quot;reportSpecStarting&quot;</span><span class="s2">,</span>
    <span class="s3">&quot;reportSpecResults&quot;</span><span class="s2">,</span>
    <span class="s3">&quot;log&quot;</span>
  <span class="s2">];</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">functionNames</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">var </span><span class="s1">functionName </span><span class="s2">= </span><span class="s1">functionNames</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>
    <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MultiReporter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">[</span><span class="s1">functionName</span><span class="s2">] = (</span><span class="s0">function</span><span class="s2">(</span><span class="s1">functionName</span><span class="s2">) {</span>
      <span class="s0">return function</span><span class="s2">() {</span>
        <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">j </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">j </span><span class="s2">&lt; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">subReporters_</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">j</span><span class="s2">++) {</span>
          <span class="s0">var </span><span class="s1">subReporter </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">subReporters_</span><span class="s2">[</span><span class="s1">j</span><span class="s2">];</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">subReporter</span><span class="s2">[</span><span class="s1">functionName</span><span class="s2">]) {</span>
            <span class="s1">subReporter</span><span class="s2">[</span><span class="s1">functionName</span><span class="s2">].</span><span class="s1">apply</span><span class="s2">(</span><span class="s1">subReporter</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
          <span class="s2">}</span>
        <span class="s2">}</span>
      <span class="s2">};</span>
    <span class="s2">})(</span><span class="s1">functionName</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">})();</span>
<span class="s4">/**</span>
 <span class="s4">* Holds results for a set of Jasmine spec. Allows for the results array to hold another jasmine.NestedResults</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">NestedResults </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s4">/**</span>
   <span class="s4">* The total count of results</span>
   <span class="s4">*/</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">totalCount </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s4">/**</span>
   <span class="s4">* Number of passed results</span>
   <span class="s4">*/</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">passedCount </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s4">/**</span>
   <span class="s4">* Number of failed results</span>
   <span class="s4">*/</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">failedCount </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s4">/**</span>
   <span class="s4">* Was this suite/spec skipped?</span>
   <span class="s4">*/</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">skipped </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
  <span class="s4">/**</span>
   <span class="s4">* </span><span class="s5">@ignore</span>
   <span class="s4">*/</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">items_ </span><span class="s2">= [];</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Roll up the result counts.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">result</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">NestedResults</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">rollupCounts </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">result</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">totalCount </span><span class="s2">+= </span><span class="s1">result</span><span class="s2">.</span><span class="s1">totalCount</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">passedCount </span><span class="s2">+= </span><span class="s1">result</span><span class="s2">.</span><span class="s1">passedCount</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">failedCount </span><span class="s2">+= </span><span class="s1">result</span><span class="s2">.</span><span class="s1">failedCount</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Adds a log message.</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">values Array of message parts which will be concatenated later.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">NestedResults</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">log </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">values</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">items_</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MessageResult</span><span class="s2">(</span><span class="s1">values</span><span class="s2">));</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Getter for the results: message &amp; results.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">NestedResults</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">getItems </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">items_</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Adds a result, tracking counts (total, passed, &amp; failed)</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.ExpectationResult|jasmine.NestedResults} result</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">NestedResults</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">addResult </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">result</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">type </span><span class="s2">!= </span><span class="s3">'log'</span><span class="s2">) {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">items_</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">rollupCounts</span><span class="s2">(</span><span class="s1">result</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">totalCount</span><span class="s2">++;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">passed</span><span class="s2">()) {</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">passedCount</span><span class="s2">++;</span>
      <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">failedCount</span><span class="s2">++;</span>
      <span class="s2">}</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">items_</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">result</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@returns </span><span class="s4">{Boolean} True if &lt;b&gt;everything&lt;/b&gt; below passed</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">NestedResults</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">passed </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">passedCount </span><span class="s2">=== </span><span class="s0">this</span><span class="s2">.</span><span class="s1">totalCount</span><span class="s2">;</span>
<span class="s2">};</span>
<span class="s4">/**</span>
 <span class="s4">* Base class for pretty printing for expectation results.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">PrettyPrinter </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">ppNestLevel_ </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Formats a value in a nice, human-readable string.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">value</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">PrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">format </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">ppNestLevel_</span><span class="s2">++;</span>
  <span class="s0">try </span><span class="s2">{</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">value </span><span class="s2">=== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s3">'undefined'</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">value </span><span class="s2">=== </span><span class="s0">null</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s3">'null'</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">value </span><span class="s2">=== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">getGlobal</span><span class="s2">()) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s3">'&lt;global&gt;'</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">value</span><span class="s2">.</span><span class="s1">jasmineToString</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s1">value</span><span class="s2">.</span><span class="s1">jasmineToString</span><span class="s2">());</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s0">typeof </span><span class="s1">value </span><span class="s2">=== </span><span class="s3">'string'</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitString</span><span class="s2">(</span><span class="s1">value</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isSpy</span><span class="s2">(</span><span class="s1">value</span><span class="s2">)) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s3">&quot;spy on &quot; </span><span class="s2">+ </span><span class="s1">value</span><span class="s2">.</span><span class="s1">identity</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">value </span><span class="s0">instanceof </span><span class="s1">RegExp</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s1">value</span><span class="s2">.</span><span class="s1">toString</span><span class="s2">());</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s0">typeof </span><span class="s1">value </span><span class="s2">=== </span><span class="s3">'function'</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s3">'Function'</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s0">typeof </span><span class="s1">value</span><span class="s2">.</span><span class="s1">nodeType </span><span class="s2">=== </span><span class="s3">'number'</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s3">'HTMLNode'</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">value </span><span class="s0">instanceof </span><span class="s1">Date</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s3">'Date(' </span><span class="s2">+ </span><span class="s1">value </span><span class="s2">+ </span><span class="s3">')'</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">value</span><span class="s2">.</span><span class="s1">__Jasmine_been_here_before__</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s3">'&lt;circular reference: ' </span><span class="s2">+ (</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isArray_</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) ? </span><span class="s3">'Array' </span><span class="s2">: </span><span class="s3">'Object'</span><span class="s2">) + </span><span class="s3">'&gt;'</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isArray_</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) || </span><span class="s0">typeof </span><span class="s1">value </span><span class="s2">== </span><span class="s3">'object'</span><span class="s2">) {</span>
      <span class="s1">value</span><span class="s2">.</span><span class="s1">__Jasmine_been_here_before__ </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">isArray_</span><span class="s2">(</span><span class="s1">value</span><span class="s2">)) {</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">emitArray</span><span class="s2">(</span><span class="s1">value</span><span class="s2">);</span>
      <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">emitObject</span><span class="s2">(</span><span class="s1">value</span><span class="s2">);</span>
      <span class="s2">}</span>
      <span class="s0">delete </span><span class="s1">value</span><span class="s2">.</span><span class="s1">__Jasmine_been_here_before__</span><span class="s2">;</span>
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">emitScalar</span><span class="s2">(</span><span class="s1">value</span><span class="s2">.</span><span class="s1">toString</span><span class="s2">());</span>
    <span class="s2">}</span>
  <span class="s2">} </span><span class="s0">finally </span><span class="s2">{</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">ppNestLevel_</span><span class="s2">--;</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">PrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">iterateObject </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">, </span><span class="s1">fn</span><span class="s2">) {</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">property </span><span class="s0">in </span><span class="s1">obj</span><span class="s2">) {</span>
    <span class="s0">if </span><span class="s2">(!</span><span class="s1">obj</span><span class="s2">.</span><span class="s1">hasOwnProperty</span><span class="s2">(</span><span class="s1">property</span><span class="s2">)) </span><span class="s0">continue</span><span class="s2">;</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">property </span><span class="s2">== </span><span class="s3">'__Jasmine_been_here_before__'</span><span class="s2">) </span><span class="s0">continue</span><span class="s2">;</span>
    <span class="s1">fn</span><span class="s2">(</span><span class="s1">property</span><span class="s2">, </span><span class="s1">obj</span><span class="s2">.</span><span class="s1">__lookupGetter__ </span><span class="s2">? (</span><span class="s1">obj</span><span class="s2">.</span><span class="s1">__lookupGetter__</span><span class="s2">(</span><span class="s1">property</span><span class="s2">) !== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined </span><span class="s2">&amp;&amp; </span>
                                         <span class="s1">obj</span><span class="s2">.</span><span class="s1">__lookupGetter__</span><span class="s2">(</span><span class="s1">property</span><span class="s2">) !== </span><span class="s0">null</span><span class="s2">) : </span><span class="s0">false</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">PrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">emitArray </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">unimplementedMethod_</span><span class="s2">;</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">PrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">emitObject </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">unimplementedMethod_</span><span class="s2">;</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">PrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">emitScalar </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">unimplementedMethod_</span><span class="s2">;</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">PrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">emitString </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">unimplementedMethod_</span><span class="s2">;</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">StringPrettyPrinter </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">PrettyPrinter</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">);</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">string </span><span class="s2">= </span><span class="s3">''</span><span class="s2">;</span>
<span class="s2">};</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">inherit</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">StringPrettyPrinter</span><span class="s2">, </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">PrettyPrinter</span><span class="s2">);</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">StringPrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">emitScalar </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">value</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">StringPrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">emitString </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">&quot;'&quot; </span><span class="s2">+ </span><span class="s1">value </span><span class="s2">+ </span><span class="s3">&quot;'&quot;</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">StringPrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">emitArray </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">array</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">ppNestLevel_ </span><span class="s2">&gt; </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MAX_PRETTY_PRINT_DEPTH</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">&quot;Array&quot;</span><span class="s2">);</span>
    <span class="s0">return</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">'[ '</span><span class="s2">);</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">array</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">i </span><span class="s2">&gt; </span><span class="s6">0</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">', '</span><span class="s2">);</span>
    <span class="s2">}</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">array</span><span class="s2">[</span><span class="s1">i</span><span class="s2">]);</span>
  <span class="s2">}</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">' ]'</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">StringPrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">emitObject </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">ppNestLevel_ </span><span class="s2">&gt; </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">MAX_PRETTY_PRINT_DEPTH</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">&quot;Object&quot;</span><span class="s2">);</span>
    <span class="s0">return</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">var </span><span class="s1">self </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">'{ '</span><span class="s2">);</span>
  <span class="s0">var </span><span class="s1">first </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">iterateObject</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">, </span><span class="s0">function</span><span class="s2">(</span><span class="s1">property</span><span class="s2">, </span><span class="s1">isGetter</span><span class="s2">) {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">first</span><span class="s2">) {</span>
      <span class="s1">first </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
      <span class="s1">self</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">', '</span><span class="s2">);</span>
    <span class="s2">}</span>

    <span class="s1">self</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">property</span><span class="s2">);</span>
    <span class="s1">self</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">' : '</span><span class="s2">);</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">isGetter</span><span class="s2">) {</span>
      <span class="s1">self</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">'&lt;getter&gt;'</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
      <span class="s1">self</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">[</span><span class="s1">property</span><span class="s2">]);</span>
    <span class="s2">}</span>
  <span class="s2">});</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s3">' }'</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">StringPrettyPrinter</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">append </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">string </span><span class="s2">+= </span><span class="s1">value</span><span class="s2">;</span>
<span class="s2">};</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">env</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">env </span><span class="s2">= </span><span class="s1">env</span><span class="s2">;</span>

  <span class="s7">// parallel to blocks. each true value in this array means the block will</span>
  <span class="s7">// get executed even if we abort</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">ensured </span><span class="s2">= [];</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">blocks </span><span class="s2">= [];</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">running </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">offset </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">abort </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">addBefore </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">block</span><span class="s2">, </span><span class="s1">ensure</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">ensure </span><span class="s2">=== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">) {</span>
    <span class="s1">ensure </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">blocks</span><span class="s2">.</span><span class="s1">unshift</span><span class="s2">(</span><span class="s1">block</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">ensured</span><span class="s2">.</span><span class="s1">unshift</span><span class="s2">(</span><span class="s1">ensure</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">add </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">block</span><span class="s2">, </span><span class="s1">ensure</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">ensure </span><span class="s2">=== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">) {</span>
    <span class="s1">ensure </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">blocks</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">block</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">ensured</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">ensure</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">insertNext </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">block</span><span class="s2">, </span><span class="s1">ensure</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">ensure </span><span class="s2">=== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">) {</span>
    <span class="s1">ensure </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">ensured</span><span class="s2">.</span><span class="s1">splice</span><span class="s2">((</span><span class="s0">this</span><span class="s2">.</span><span class="s1">index </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">offset </span><span class="s2">+ </span><span class="s6">1</span><span class="s2">), </span><span class="s6">0</span><span class="s2">, </span><span class="s1">ensure</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">blocks</span><span class="s2">.</span><span class="s1">splice</span><span class="s2">((</span><span class="s0">this</span><span class="s2">.</span><span class="s1">index </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">offset </span><span class="s2">+ </span><span class="s6">1</span><span class="s2">), </span><span class="s6">0</span><span class="s2">, </span><span class="s1">block</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">offset</span><span class="s2">++;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">start </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">running </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">onComplete </span><span class="s2">= </span><span class="s1">onComplete</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">next_</span><span class="s2">();</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">isRunning </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">running</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">.</span><span class="s1">LOOP_DONT_RECURSE </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">next_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">self </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">goAgain </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>

  <span class="s0">while </span><span class="s2">(</span><span class="s1">goAgain</span><span class="s2">) {</span>
    <span class="s1">goAgain </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
    
    <span class="s0">if </span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">&lt; </span><span class="s1">self</span><span class="s2">.</span><span class="s1">blocks</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&amp;&amp; !(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">abort </span><span class="s2">&amp;&amp; !</span><span class="s0">this</span><span class="s2">.</span><span class="s1">ensured</span><span class="s2">[</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index</span><span class="s2">])) {</span>
      <span class="s0">var </span><span class="s1">calledSynchronously </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">completedSynchronously </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>

      <span class="s0">var </span><span class="s1">onComplete </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">.</span><span class="s1">LOOP_DONT_RECURSE </span><span class="s2">&amp;&amp; </span><span class="s1">calledSynchronously</span><span class="s2">) {</span>
          <span class="s1">completedSynchronously </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
          <span class="s0">return</span><span class="s2">;</span>
        <span class="s2">}</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">blocks</span><span class="s2">[</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index</span><span class="s2">].</span><span class="s1">abort</span><span class="s2">) {</span>
          <span class="s1">self</span><span class="s2">.</span><span class="s1">abort </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
        <span class="s2">}</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">offset </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">index</span><span class="s2">++;</span>

        <span class="s0">var </span><span class="s1">now </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Date</span><span class="s2">().</span><span class="s1">getTime</span><span class="s2">();</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">updateInterval </span><span class="s2">&amp;&amp; </span><span class="s1">now </span><span class="s2">- </span><span class="s1">self</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">lastUpdate </span><span class="s2">&gt; </span><span class="s1">self</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">updateInterval</span><span class="s2">) {</span>
          <span class="s1">self</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">lastUpdate </span><span class="s2">= </span><span class="s1">now</span><span class="s2">;</span>
          <span class="s1">self</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">setTimeout</span><span class="s2">(</span><span class="s0">function</span><span class="s2">() {</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">next_</span><span class="s2">();</span>
          <span class="s2">}, </span><span class="s6">0</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">.</span><span class="s1">LOOP_DONT_RECURSE </span><span class="s2">&amp;&amp; </span><span class="s1">completedSynchronously</span><span class="s2">) {</span>
            <span class="s1">goAgain </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
          <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">next_</span><span class="s2">();</span>
          <span class="s2">}</span>
        <span class="s2">}</span>
      <span class="s2">};</span>
      <span class="s1">self</span><span class="s2">.</span><span class="s1">blocks</span><span class="s2">[</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index</span><span class="s2">].</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">);</span>

      <span class="s1">calledSynchronously </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">completedSynchronously</span><span class="s2">) {</span>
        <span class="s1">onComplete</span><span class="s2">();</span>
      <span class="s2">}</span>
      
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
      <span class="s1">self</span><span class="s2">.</span><span class="s1">running </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">onComplete</span><span class="s2">) {</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">onComplete</span><span class="s2">();</span>
      <span class="s2">}</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">results </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">results </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">NestedResults</span><span class="s2">();</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">blocks</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">blocks</span><span class="s2">[</span><span class="s1">i</span><span class="s2">].</span><span class="s1">results</span><span class="s2">) {</span>
      <span class="s1">results</span><span class="s2">.</span><span class="s1">addResult</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">blocks</span><span class="s2">[</span><span class="s1">i</span><span class="s2">].</span><span class="s1">results</span><span class="s2">());</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">results</span><span class="s2">;</span>
<span class="s2">};</span>


<span class="s4">/**</span>
 <span class="s4">* Runner</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Env} env</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">env</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">self </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">env </span><span class="s2">= </span><span class="s1">env</span><span class="s2">;</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">queue </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">(</span><span class="s1">env</span><span class="s2">);</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">before_ </span><span class="s2">= [];</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">after_ </span><span class="s2">= [];</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">suites_ </span><span class="s2">= [];</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">execute </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">self </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">reporter</span><span class="s2">.</span><span class="s1">reportRunnerStarting</span><span class="s2">) {</span>
    <span class="s1">self</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">reporter</span><span class="s2">.</span><span class="s1">reportRunnerStarting</span><span class="s2">(</span><span class="s0">this</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">start</span><span class="s2">(</span><span class="s0">function </span><span class="s2">() {</span>
    <span class="s1">self</span><span class="s2">.</span><span class="s1">finishCallback</span><span class="s2">();</span>
  <span class="s2">});</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">beforeEach </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">beforeEachFunction</span><span class="s2">) {</span>
  <span class="s1">beforeEachFunction</span><span class="s2">.</span><span class="s1">typeName </span><span class="s2">= </span><span class="s3">'beforeEach'</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">before_</span><span class="s2">.</span><span class="s1">splice</span><span class="s2">(</span><span class="s6">0</span><span class="s2">,</span><span class="s6">0</span><span class="s2">,</span><span class="s1">beforeEachFunction</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">afterEach </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">afterEachFunction</span><span class="s2">) {</span>
  <span class="s1">afterEachFunction</span><span class="s2">.</span><span class="s1">typeName </span><span class="s2">= </span><span class="s3">'afterEach'</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">after_</span><span class="s2">.</span><span class="s1">splice</span><span class="s2">(</span><span class="s6">0</span><span class="s2">,</span><span class="s6">0</span><span class="s2">,</span><span class="s1">afterEachFunction</span><span class="s2">);</span>
<span class="s2">};</span>


<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">finishCallback </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">reporter</span><span class="s2">.</span><span class="s1">reportRunnerResults</span><span class="s2">(</span><span class="s0">this</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">addSuite </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">suite</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">suites_</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">suite</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">add </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">block</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">block </span><span class="s0">instanceof </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">addSuite</span><span class="s2">(</span><span class="s1">block</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s1">block</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">specs </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">suites </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">suites</span><span class="s2">();</span>
  <span class="s0">var </span><span class="s1">specs </span><span class="s2">= [];</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">suites</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s1">specs </span><span class="s2">= </span><span class="s1">specs</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">suites</span><span class="s2">[</span><span class="s1">i</span><span class="s2">].</span><span class="s1">specs</span><span class="s2">());</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">specs</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">suites </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">suites_</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">topLevelSuites </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">topLevelSuites </span><span class="s2">= [];</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">suites_</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">if </span><span class="s2">(!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">suites_</span><span class="s2">[</span><span class="s1">i</span><span class="s2">].</span><span class="s1">parentSuite</span><span class="s2">) {</span>
      <span class="s1">topLevelSuites</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">suites_</span><span class="s2">[</span><span class="s1">i</span><span class="s2">]);</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">topLevelSuites</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Runner</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">results </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">results</span><span class="s2">();</span>
<span class="s2">};</span>
<span class="s4">/**</span>
 <span class="s4">* Internal representation of a Jasmine specification, or test.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Env} env</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Suite} suite</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} description</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">env</span><span class="s2">, </span><span class="s1">suite</span><span class="s2">, </span><span class="s1">description</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(!</span><span class="s1">env</span><span class="s2">) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'jasmine.Env() required'</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">if </span><span class="s2">(!</span><span class="s1">suite</span><span class="s2">) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">'jasmine.Suite() required'</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">var </span><span class="s1">spec </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
  <span class="s1">spec</span><span class="s2">.</span><span class="s1">id </span><span class="s2">= </span><span class="s1">env</span><span class="s2">.</span><span class="s1">nextSpecId </span><span class="s2">? </span><span class="s1">env</span><span class="s2">.</span><span class="s1">nextSpecId</span><span class="s2">() : </span><span class="s0">null</span><span class="s2">;</span>
  <span class="s1">spec</span><span class="s2">.</span><span class="s1">env </span><span class="s2">= </span><span class="s1">env</span><span class="s2">;</span>
  <span class="s1">spec</span><span class="s2">.</span><span class="s1">suite </span><span class="s2">= </span><span class="s1">suite</span><span class="s2">;</span>
  <span class="s1">spec</span><span class="s2">.</span><span class="s1">description </span><span class="s2">= </span><span class="s1">description</span><span class="s2">;</span>
  <span class="s1">spec</span><span class="s2">.</span><span class="s1">queue </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">(</span><span class="s1">env</span><span class="s2">);</span>

  <span class="s1">spec</span><span class="s2">.</span><span class="s1">afterCallbacks </span><span class="s2">= [];</span>
  <span class="s1">spec</span><span class="s2">.</span><span class="s1">spies_ </span><span class="s2">= [];</span>

  <span class="s1">spec</span><span class="s2">.</span><span class="s1">results_ </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">NestedResults</span><span class="s2">();</span>
  <span class="s1">spec</span><span class="s2">.</span><span class="s1">results_</span><span class="s2">.</span><span class="s1">description </span><span class="s2">= </span><span class="s1">description</span><span class="s2">;</span>
  <span class="s1">spec</span><span class="s2">.</span><span class="s1">matchersClass </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">getFullName </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">suite</span><span class="s2">.</span><span class="s1">getFullName</span><span class="s2">() + </span><span class="s3">' ' </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">description </span><span class="s2">+ </span><span class="s3">'.'</span><span class="s2">;</span>
<span class="s2">};</span>


<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">results </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">results_</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* All parameters are pretty-printed and concatenated together, then written to the spec's output.</span>
 <span class="s4">*</span>
 <span class="s4">* Be careful not to leave calls to &lt;code&gt;jasmine.log&lt;/code&gt; in production code.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">log </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">results_</span><span class="s2">.</span><span class="s1">log</span><span class="s2">(</span><span class="s1">arguments</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">runs </span><span class="s2">= </span><span class="s0">function </span><span class="s2">(</span><span class="s1">func</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">block </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, </span><span class="s0">this</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">addToQueue</span><span class="s2">(</span><span class="s1">block</span><span class="s2">);</span>
  <span class="s0">return this</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">addToQueue </span><span class="s2">= </span><span class="s0">function </span><span class="s2">(</span><span class="s1">block</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">isRunning</span><span class="s2">()) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">insertNext</span><span class="s2">(</span><span class="s1">block</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s1">block</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.ExpectationResult} result</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">addMatcherResult </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">result</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">results_</span><span class="s2">.</span><span class="s1">addResult</span><span class="s2">(</span><span class="s1">result</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">expect </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">positive </span><span class="s2">= </span><span class="s0">new </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">getMatchersClass_</span><span class="s2">())(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s1">actual</span><span class="s2">, </span><span class="s0">this</span><span class="s2">);</span>
  <span class="s1">positive</span><span class="s2">.</span><span class="s1">not </span><span class="s2">= </span><span class="s0">new </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">getMatchersClass_</span><span class="s2">())(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s1">actual</span><span class="s2">, </span><span class="s0">this</span><span class="s2">, </span><span class="s0">true</span><span class="s2">);</span>
  <span class="s0">return </span><span class="s1">positive</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Waits a fixed time period before moving to the next block.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@deprecated </span><span class="s4">Use waitsFor() instead</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Number} timeout milliseconds to wait</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">waits </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">timeout</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">waitsFunc </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsBlock</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s1">timeout</span><span class="s2">, </span><span class="s0">this</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">addToQueue</span><span class="s2">(</span><span class="s1">waitsFunc</span><span class="s2">);</span>
  <span class="s0">return this</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Waits for the latchFunction to return true before proceeding to the next block.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} latchFunction</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} optional_timeoutMessage</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Number} optional_timeout</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">waitsFor </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">latchFunction</span><span class="s2">, </span><span class="s1">optional_timeoutMessage</span><span class="s2">, </span><span class="s1">optional_timeout</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">latchFunction_ </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">optional_timeoutMessage_ </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">optional_timeout_ </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>

  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">arguments</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">var </span><span class="s1">arg </span><span class="s2">= </span><span class="s1">arguments</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>
    <span class="s0">switch </span><span class="s2">(</span><span class="s0">typeof </span><span class="s1">arg</span><span class="s2">) {</span>
      <span class="s0">case </span><span class="s3">'function'</span><span class="s2">:</span>
        <span class="s1">latchFunction_ </span><span class="s2">= </span><span class="s1">arg</span><span class="s2">;</span>
        <span class="s0">break</span><span class="s2">;</span>
      <span class="s0">case </span><span class="s3">'string'</span><span class="s2">:</span>
        <span class="s1">optional_timeoutMessage_ </span><span class="s2">= </span><span class="s1">arg</span><span class="s2">;</span>
        <span class="s0">break</span><span class="s2">;</span>
      <span class="s0">case </span><span class="s3">'number'</span><span class="s2">:</span>
        <span class="s1">optional_timeout_ </span><span class="s2">= </span><span class="s1">arg</span><span class="s2">;</span>
        <span class="s0">break</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}</span>

  <span class="s0">var </span><span class="s1">waitsForFunc </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsForBlock</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s1">optional_timeout_</span><span class="s2">, </span><span class="s1">latchFunction_</span><span class="s2">, </span><span class="s1">optional_timeoutMessage_</span><span class="s2">, </span><span class="s0">this</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">addToQueue</span><span class="s2">(</span><span class="s1">waitsForFunc</span><span class="s2">);</span>
  <span class="s0">return this</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">fail </span><span class="s2">= </span><span class="s0">function </span><span class="s2">(</span><span class="s1">e</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">expectationResult </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">ExpectationResult</span><span class="s2">({</span>
    <span class="s1">passed</span><span class="s2">: </span><span class="s0">false</span><span class="s2">,</span>
    <span class="s1">message</span><span class="s2">: </span><span class="s1">e </span><span class="s2">? </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">formatException</span><span class="s2">(</span><span class="s1">e</span><span class="s2">) : </span><span class="s3">'Exception'</span><span class="s2">,</span>
    <span class="s1">trace</span><span class="s2">: { </span><span class="s1">stack</span><span class="s2">: </span><span class="s1">e</span><span class="s2">.</span><span class="s1">stack </span><span class="s2">}</span>
  <span class="s2">});</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">results_</span><span class="s2">.</span><span class="s1">addResult</span><span class="s2">(</span><span class="s1">expectationResult</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">getMatchersClass_ </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">matchersClass </span><span class="s2">|| </span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">matchersClass</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">addMatchers </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">matchersPrototype</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">parent </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">getMatchersClass_</span><span class="s2">();</span>
  <span class="s0">var </span><span class="s1">newMatchersClass </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
    <span class="s1">parent</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s2">};</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">inherit</span><span class="s2">(</span><span class="s1">newMatchersClass</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">);</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Matchers</span><span class="s2">.</span><span class="s1">wrapInto_</span><span class="s2">(</span><span class="s1">matchersPrototype</span><span class="s2">, </span><span class="s1">newMatchersClass</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">matchersClass </span><span class="s2">= </span><span class="s1">newMatchersClass</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">finishCallback </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">reporter</span><span class="s2">.</span><span class="s1">reportSpecResults</span><span class="s2">(</span><span class="s0">this</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">finish </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">removeAllSpies</span><span class="s2">();</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">finishCallback</span><span class="s2">();</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">) {</span>
    <span class="s1">onComplete</span><span class="s2">();</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">after </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">doAfter</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">isRunning</span><span class="s2">()) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s1">doAfter</span><span class="s2">, </span><span class="s0">this</span><span class="s2">), </span><span class="s0">true</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">afterCallbacks</span><span class="s2">.</span><span class="s1">unshift</span><span class="s2">(</span><span class="s1">doAfter</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">execute </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">spec </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
  <span class="s0">if </span><span class="s2">(!</span><span class="s1">spec</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">specFilter</span><span class="s2">(</span><span class="s1">spec</span><span class="s2">)) {</span>
    <span class="s1">spec</span><span class="s2">.</span><span class="s1">results_</span><span class="s2">.</span><span class="s1">skipped </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
    <span class="s1">spec</span><span class="s2">.</span><span class="s1">finish</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">);</span>
    <span class="s0">return</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">reporter</span><span class="s2">.</span><span class="s1">reportSpecStarting</span><span class="s2">(</span><span class="s0">this</span><span class="s2">);</span>

  <span class="s1">spec</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">currentSpec </span><span class="s2">= </span><span class="s1">spec</span><span class="s2">;</span>

  <span class="s1">spec</span><span class="s2">.</span><span class="s1">addBeforesAndAftersToQueue</span><span class="s2">();</span>

  <span class="s1">spec</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">start</span><span class="s2">(</span><span class="s0">function </span><span class="s2">() {</span>
    <span class="s1">spec</span><span class="s2">.</span><span class="s1">finish</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">);</span>
  <span class="s2">});</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">addBeforesAndAftersToQueue </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">runner </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">currentRunner</span><span class="s2">();</span>
  <span class="s0">var </span><span class="s1">i</span><span class="s2">;</span>

  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">suite </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">suite</span><span class="s2">; </span><span class="s1">suite</span><span class="s2">; </span><span class="s1">suite </span><span class="s2">= </span><span class="s1">suite</span><span class="s2">.</span><span class="s1">parentSuite</span><span class="s2">) {</span>
    <span class="s0">for </span><span class="s2">(</span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">suite</span><span class="s2">.</span><span class="s1">before_</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">addBefore</span><span class="s2">(</span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s1">suite</span><span class="s2">.</span><span class="s1">before_</span><span class="s2">[</span><span class="s1">i</span><span class="s2">], </span><span class="s0">this</span><span class="s2">));</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">runner</span><span class="s2">.</span><span class="s1">before_</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">addBefore</span><span class="s2">(</span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s1">runner</span><span class="s2">.</span><span class="s1">before_</span><span class="s2">[</span><span class="s1">i</span><span class="s2">], </span><span class="s0">this</span><span class="s2">));</span>
  <span class="s2">}</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">afterCallbacks</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s0">this</span><span class="s2">.</span><span class="s1">afterCallbacks</span><span class="s2">[</span><span class="s1">i</span><span class="s2">], </span><span class="s0">this</span><span class="s2">), </span><span class="s0">true</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s1">suite </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">suite</span><span class="s2">; </span><span class="s1">suite</span><span class="s2">; </span><span class="s1">suite </span><span class="s2">= </span><span class="s1">suite</span><span class="s2">.</span><span class="s1">parentSuite</span><span class="s2">) {</span>
    <span class="s0">for </span><span class="s2">(</span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">suite</span><span class="s2">.</span><span class="s1">after_</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s1">suite</span><span class="s2">.</span><span class="s1">after_</span><span class="s2">[</span><span class="s1">i</span><span class="s2">], </span><span class="s0">this</span><span class="s2">), </span><span class="s0">true</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">}</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">runner</span><span class="s2">.</span><span class="s1">after_</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">, </span><span class="s1">runner</span><span class="s2">.</span><span class="s1">after_</span><span class="s2">[</span><span class="s1">i</span><span class="s2">], </span><span class="s0">this</span><span class="s2">), </span><span class="s0">true</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">explodes </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">throw </span><span class="s3">'explodes function should not have been called'</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">spyOn </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">, </span><span class="s1">methodName</span><span class="s2">, </span><span class="s1">ignoreMethodDoesntExist</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">obj </span><span class="s2">== </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">) {</span>
    <span class="s0">throw </span><span class="s3">&quot;spyOn could not find an object to spy upon for &quot; </span><span class="s2">+ </span><span class="s1">methodName </span><span class="s2">+ </span><span class="s3">&quot;()&quot;</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(!</span><span class="s1">ignoreMethodDoesntExist </span><span class="s2">&amp;&amp; </span><span class="s1">obj</span><span class="s2">[</span><span class="s1">methodName</span><span class="s2">] === </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">undefined</span><span class="s2">) {</span>
    <span class="s0">throw </span><span class="s1">methodName </span><span class="s2">+ </span><span class="s3">'() method does not exist'</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(!</span><span class="s1">ignoreMethodDoesntExist </span><span class="s2">&amp;&amp; </span><span class="s1">obj</span><span class="s2">[</span><span class="s1">methodName</span><span class="s2">] &amp;&amp; </span><span class="s1">obj</span><span class="s2">[</span><span class="s1">methodName</span><span class="s2">].</span><span class="s1">isSpy</span><span class="s2">) {</span>
    <span class="s0">throw new </span><span class="s1">Error</span><span class="s2">(</span><span class="s1">methodName </span><span class="s2">+ </span><span class="s3">' has already been spied upon'</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s0">var </span><span class="s1">spyObj </span><span class="s2">= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">createSpy</span><span class="s2">(</span><span class="s1">methodName</span><span class="s2">);</span>

  <span class="s0">this</span><span class="s2">.</span><span class="s1">spies_</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">spyObj</span><span class="s2">);</span>
  <span class="s1">spyObj</span><span class="s2">.</span><span class="s1">baseObj </span><span class="s2">= </span><span class="s1">obj</span><span class="s2">;</span>
  <span class="s1">spyObj</span><span class="s2">.</span><span class="s1">methodName </span><span class="s2">= </span><span class="s1">methodName</span><span class="s2">;</span>
  <span class="s1">spyObj</span><span class="s2">.</span><span class="s1">originalValue </span><span class="s2">= </span><span class="s1">obj</span><span class="s2">[</span><span class="s1">methodName</span><span class="s2">];</span>

  <span class="s1">obj</span><span class="s2">[</span><span class="s1">methodName</span><span class="s2">] = </span><span class="s1">spyObj</span><span class="s2">;</span>

  <span class="s0">return </span><span class="s1">spyObj</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Spec</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">removeAllSpies </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">spies_</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
    <span class="s0">var </span><span class="s1">spy </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">spies_</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>
    <span class="s1">spy</span><span class="s2">.</span><span class="s1">baseObj</span><span class="s2">[</span><span class="s1">spy</span><span class="s2">.</span><span class="s1">methodName</span><span class="s2">] = </span><span class="s1">spy</span><span class="s2">.</span><span class="s1">originalValue</span><span class="s2">;</span>
  <span class="s2">}</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">spies_ </span><span class="s2">= [];</span>
<span class="s2">};</span>

<span class="s4">/**</span>
 <span class="s4">* Internal representation of a Jasmine suite.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Env} env</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} description</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} specDefinitions</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Suite} parentSuite</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">env</span><span class="s2">, </span><span class="s1">description</span><span class="s2">, </span><span class="s1">specDefinitions</span><span class="s2">, </span><span class="s1">parentSuite</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">self </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">id </span><span class="s2">= </span><span class="s1">env</span><span class="s2">.</span><span class="s1">nextSuiteId </span><span class="s2">? </span><span class="s1">env</span><span class="s2">.</span><span class="s1">nextSuiteId</span><span class="s2">() : </span><span class="s0">null</span><span class="s2">;</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">description </span><span class="s2">= </span><span class="s1">description</span><span class="s2">;</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">queue </span><span class="s2">= </span><span class="s0">new </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Queue</span><span class="s2">(</span><span class="s1">env</span><span class="s2">);</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">parentSuite </span><span class="s2">= </span><span class="s1">parentSuite</span><span class="s2">;</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">env </span><span class="s2">= </span><span class="s1">env</span><span class="s2">;</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">before_ </span><span class="s2">= [];</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">after_ </span><span class="s2">= [];</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">children_ </span><span class="s2">= [];</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">suites_ </span><span class="s2">= [];</span>
  <span class="s1">self</span><span class="s2">.</span><span class="s1">specs_ </span><span class="s2">= [];</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">getFullName </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">var </span><span class="s1">fullName </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">description</span><span class="s2">;</span>
  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">parentSuite </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parentSuite</span><span class="s2">; </span><span class="s1">parentSuite</span><span class="s2">; </span><span class="s1">parentSuite </span><span class="s2">= </span><span class="s1">parentSuite</span><span class="s2">.</span><span class="s1">parentSuite</span><span class="s2">) {</span>
    <span class="s1">fullName </span><span class="s2">= </span><span class="s1">parentSuite</span><span class="s2">.</span><span class="s1">description </span><span class="s2">+ </span><span class="s3">' ' </span><span class="s2">+ </span><span class="s1">fullName</span><span class="s2">;</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">fullName</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">finish </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">reporter</span><span class="s2">.</span><span class="s1">reportSuiteResults</span><span class="s2">(</span><span class="s0">this</span><span class="s2">);</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">finished </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s0">typeof</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">) == </span><span class="s3">'function'</span><span class="s2">) {</span>
    <span class="s1">onComplete</span><span class="s2">();</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">beforeEach </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">beforeEachFunction</span><span class="s2">) {</span>
  <span class="s1">beforeEachFunction</span><span class="s2">.</span><span class="s1">typeName </span><span class="s2">= </span><span class="s3">'beforeEach'</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">before_</span><span class="s2">.</span><span class="s1">unshift</span><span class="s2">(</span><span class="s1">beforeEachFunction</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">afterEach </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">afterEachFunction</span><span class="s2">) {</span>
  <span class="s1">afterEachFunction</span><span class="s2">.</span><span class="s1">typeName </span><span class="s2">= </span><span class="s3">'afterEach'</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">after_</span><span class="s2">.</span><span class="s1">unshift</span><span class="s2">(</span><span class="s1">afterEachFunction</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">results </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">results</span><span class="s2">();</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">add </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">suiteOrSpec</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">children_</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">suiteOrSpec</span><span class="s2">);</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">suiteOrSpec </span><span class="s0">instanceof </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">suites_</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">suiteOrSpec</span><span class="s2">);</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">currentRunner</span><span class="s2">().</span><span class="s1">addSuite</span><span class="s2">(</span><span class="s1">suiteOrSpec</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">specs_</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">suiteOrSpec</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s1">suiteOrSpec</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">specs </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">specs_</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">suites </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">suites_</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">children </span><span class="s2">= </span><span class="s0">function</span><span class="s2">() {</span>
  <span class="s0">return this</span><span class="s2">.</span><span class="s1">children_</span><span class="s2">;</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Suite</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">execute </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">self </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">queue</span><span class="s2">.</span><span class="s1">start</span><span class="s2">(</span><span class="s0">function </span><span class="s2">() {</span>
    <span class="s1">self</span><span class="s2">.</span><span class="s1">finish</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">);</span>
  <span class="s2">});</span>
<span class="s2">};</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsBlock </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">env</span><span class="s2">, </span><span class="s1">timeout</span><span class="s2">, </span><span class="s1">spec</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">timeout </span><span class="s2">= </span><span class="s1">timeout</span><span class="s2">;</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">env</span><span class="s2">, </span><span class="s0">null</span><span class="s2">, </span><span class="s1">spec</span><span class="s2">);</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">inherit</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsBlock</span><span class="s2">, </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">);</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsBlock</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">execute </span><span class="s2">= </span><span class="s0">function </span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">VERBOSE</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">reporter</span><span class="s2">.</span><span class="s1">log</span><span class="s2">(</span><span class="s3">'&gt;&gt; Jasmine waiting for ' </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">timeout </span><span class="s2">+ </span><span class="s3">' ms...'</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">setTimeout</span><span class="s2">(</span><span class="s0">function </span><span class="s2">() {</span>
    <span class="s1">onComplete</span><span class="s2">();</span>
  <span class="s2">}, </span><span class="s0">this</span><span class="s2">.</span><span class="s1">timeout</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s4">/**</span>
 <span class="s4">* A block which waits for some condition to become true, with timeout.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@constructor</span>
 <span class="s4">* </span><span class="s5">@extends </span><span class="s4">jasmine.Block</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Env} env The Jasmine environment.</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Number} timeout The maximum time in milliseconds to wait for the condition to become true.</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{Function} latchFunction A function which returns true when the desired condition has been met.</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{String} message The message to display if the desired condition hasn't been met within the given time period.</span>
 <span class="s4">* </span><span class="s5">@param </span><span class="s4">{jasmine.Spec} spec The Jasmine spec.</span>
 <span class="s4">*/</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsForBlock </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">env</span><span class="s2">, </span><span class="s1">timeout</span><span class="s2">, </span><span class="s1">latchFunction</span><span class="s2">, </span><span class="s1">message</span><span class="s2">, </span><span class="s1">spec</span><span class="s2">) {</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">timeout </span><span class="s2">= </span><span class="s1">timeout </span><span class="s2">|| </span><span class="s1">env</span><span class="s2">.</span><span class="s1">defaultTimeoutInterval</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">latchFunction </span><span class="s2">= </span><span class="s1">latchFunction</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">message </span><span class="s2">= </span><span class="s1">message</span><span class="s2">;</span>
  <span class="s0">this</span><span class="s2">.</span><span class="s1">totalTimeSpentWaitingForLatch </span><span class="s2">= </span><span class="s6">0</span><span class="s2">;</span>
  <span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">env</span><span class="s2">, </span><span class="s0">null</span><span class="s2">, </span><span class="s1">spec</span><span class="s2">);</span>
<span class="s2">};</span>
<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">inherit</span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsForBlock</span><span class="s2">, </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">Block</span><span class="s2">);</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsForBlock</span><span class="s2">.</span><span class="s1">TIMEOUT_INCREMENT </span><span class="s2">= </span><span class="s6">10</span><span class="s2">;</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsForBlock</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">execute </span><span class="s2">= </span><span class="s0">function</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">) {</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">VERBOSE</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">reporter</span><span class="s2">.</span><span class="s1">log</span><span class="s2">(</span><span class="s3">'&gt;&gt; Jasmine waiting for ' </span><span class="s2">+ (</span><span class="s0">this</span><span class="s2">.</span><span class="s1">message </span><span class="s2">|| </span><span class="s3">'something to happen'</span><span class="s2">));</span>
  <span class="s2">}</span>
  <span class="s0">var </span><span class="s1">latchFunctionResult</span><span class="s2">;</span>
  <span class="s0">try </span><span class="s2">{</span>
    <span class="s1">latchFunctionResult </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">latchFunction</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">spec</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">catch </span><span class="s2">(</span><span class="s1">e</span><span class="s2">) {</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">spec</span><span class="s2">.</span><span class="s1">fail</span><span class="s2">(</span><span class="s1">e</span><span class="s2">);</span>
    <span class="s1">onComplete</span><span class="s2">();</span>
    <span class="s0">return</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">latchFunctionResult</span><span class="s2">) {</span>
    <span class="s1">onComplete</span><span class="s2">();</span>
  <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">totalTimeSpentWaitingForLatch </span><span class="s2">&gt;= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">timeout</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">message </span><span class="s2">= </span><span class="s3">'timed out after ' </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">timeout </span><span class="s2">+ </span><span class="s3">' msec waiting for ' </span><span class="s2">+ (</span><span class="s0">this</span><span class="s2">.</span><span class="s1">message </span><span class="s2">|| </span><span class="s3">'something to happen'</span><span class="s2">);</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">spec</span><span class="s2">.</span><span class="s1">fail</span><span class="s2">({</span>
      <span class="s1">name</span><span class="s2">: </span><span class="s3">'timeout'</span><span class="s2">,</span>
      <span class="s1">message</span><span class="s2">: </span><span class="s1">message</span>
    <span class="s2">});</span>

    <span class="s0">this</span><span class="s2">.</span><span class="s1">abort </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
    <span class="s1">onComplete</span><span class="s2">();</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">totalTimeSpentWaitingForLatch </span><span class="s2">+= </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsForBlock</span><span class="s2">.</span><span class="s1">TIMEOUT_INCREMENT</span><span class="s2">;</span>
    <span class="s0">var </span><span class="s1">self </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">env</span><span class="s2">.</span><span class="s1">setTimeout</span><span class="s2">(</span><span class="s0">function</span><span class="s2">() {</span>
      <span class="s1">self</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">onComplete</span><span class="s2">);</span>
    <span class="s2">}, </span><span class="s1">jasmine</span><span class="s2">.</span><span class="s1">WaitsForBlock</span><span class="s2">.</span><span class="s1">TIMEOUT_INCREMENT</span><span class="s2">);</span>
  <span class="s2">}</span>
<span class="s2">};</span>

<span class="s1">jasmine</span><span class="s2">.</span><span class="s1">version_</span><span class="s2">= {</span>
  <span class="s3">&quot;major&quot;</span><span class="s2">: </span><span class="s6">1</span><span class="s2">,</span>
  <span class="s3">&quot;minor&quot;</span><span class="s2">: </span><span class="s6">3</span><span class="s2">,</span>
  <span class="s3">&quot;build&quot;</span><span class="s2">: </span><span class="s6">1</span><span class="s2">,</span>
  <span class="s3">&quot;revision&quot;</span><span class="s2">: </span><span class="s6">1354556913</span>
<span class="s2">};</span>
</pre>
</body>
</html>