<html>
<head>
<title>set-array.mjs.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #6aab73;}
.s2 { color: #2aacb8;}
.s3 { color: #cf8e6d;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
set-array.mjs.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;file&quot;</span><span class="s0">:</span><span class="s1">&quot;set-array.mjs&quot;</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../src/set-array.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;type Key = string | number | symbol;</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* SetArray acts like a `Set` (allowing only one occurrence of a string `key`), but provides the</span><span class="s3">\n </span><span class="s1">* index of the `key` in the backing array.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This is designed to allow synchronizing a second array with the contents of the backing array,</span><span class="s3">\n </span><span class="s1">* like how in a sourcemap `sourcesContent[i]` is the source content associated with `source[i]`,</span><span class="s3">\n </span><span class="s1">* and there are never duplicates.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class SetArray&lt;T extends Key = Key&gt; {</span><span class="s3">\n  </span><span class="s1">private declare _indexes: Record&lt;T, number | undefined&gt;;</span><span class="s3">\n  </span><span class="s1">declare array: readonly T[];</span><span class="s3">\n\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">this._indexes = { __proto__: null } as any;</span><span class="s3">\n    </span><span class="s1">this.array = [];</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface PublicSet&lt;T extends Key&gt; {</span><span class="s3">\n  </span><span class="s1">array: T[];</span><span class="s3">\n  </span><span class="s1">_indexes: SetArray&lt;T&gt;['_indexes'];</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Typescript doesn't allow friend access to private fields, so this just casts the set into a type</span><span class="s3">\n </span><span class="s1">* with public access modifiers.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function cast&lt;T extends Key&gt;(set: SetArray&lt;T&gt;): PublicSet&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">return set as any;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Gets the index associated with `key` in the backing array, if it is already present.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function get&lt;T extends Key&gt;(setarr: SetArray&lt;T&gt;, key: T): number | undefined {</span><span class="s3">\n  </span><span class="s1">return cast(setarr)._indexes[key];</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Puts `key` into the backing array, if it is not already present. Returns</span><span class="s3">\n </span><span class="s1">* the index of the `key` in the backing array.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function put&lt;T extends Key&gt;(setarr: SetArray&lt;T&gt;, key: T): number {</span><span class="s3">\n  </span><span class="s1">// The key may or may not be present. If it is present, it's a number.</span><span class="s3">\n  </span><span class="s1">const index = get(setarr, key);</span><span class="s3">\n  </span><span class="s1">if (index !== undefined) return index;</span><span class="s3">\n\n  </span><span class="s1">const { array, _indexes: indexes } = cast(setarr);</span><span class="s3">\n\n  </span><span class="s1">const length = array.push(key);</span><span class="s3">\n  </span><span class="s1">return (indexes[key] = length - 1);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Pops the last added item out of the SetArray.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function pop&lt;T extends Key&gt;(setarr: SetArray&lt;T&gt;): void {</span><span class="s3">\n  </span><span class="s1">const { array, _indexes: indexes } = cast(setarr);</span><span class="s3">\n  </span><span class="s1">if (array.length === 0) return;</span><span class="s3">\n\n  </span><span class="s1">const last = array.pop()!;</span><span class="s3">\n  </span><span class="s1">indexes[last] = undefined;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Removes the key, if it exists in the set.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function remove&lt;T extends Key&gt;(setarr: SetArray&lt;T&gt;, key: T): void {</span><span class="s3">\n  </span><span class="s1">const index = get(setarr, key);</span><span class="s3">\n  </span><span class="s1">if (index === undefined) return;</span><span class="s3">\n\n  </span><span class="s1">const { array, _indexes: indexes } = cast(setarr);</span><span class="s3">\n  </span><span class="s1">for (let i = index + 1; i &lt; array.length; i++) {</span><span class="s3">\n    </span><span class="s1">const k = array[i];</span><span class="s3">\n    </span><span class="s1">array[i - 1] = k;</span><span class="s3">\n    </span><span class="s1">indexes[k]!--;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">indexes[key] = undefined;</span><span class="s3">\n  </span><span class="s1">array.pop();</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAEA;;;;;;;;MAQa,QAAQ;IAInB;QACE,IAAI,CAAC,QAAQ,GAAG,EAAE,SAAS,EAAE,IAAI,EAAS,CAAC;QAC3C,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;KACjB;CACF;AAOD;;;;AAIA,SAAS,IAAI,CAAgB,GAAgB;IAC3C,OAAO,GAAU,CAAC;AACpB,CAAC;AAED;;;SAGgB,GAAG,CAAgB,MAAmB,EAAE,GAAM;IAC5D,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;AACpC,CAAC;AAED;;;;SAIgB,GAAG,CAAgB,MAAmB,EAAE,GAAM;;IAE5D,MAAM,KAAK,GAAG,GAAG,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;IAC/B,IAAI,KAAK,KAAK,SAAS;QAAE,OAAO,KAAK,CAAC;IAEtC,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;IAElD,MAAM,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC/B,QAAQ,OAAO,CAAC,GAAG,CAAC,GAAG,MAAM,GAAG,CAAC,EAAE;AACrC,CAAC;AAED;;;SAGgB,GAAG,CAAgB,MAAmB;IACpD,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;IAClD,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC;QAAE,OAAO;IAE/B,MAAM,IAAI,GAAG,KAAK,CAAC,GAAG,EAAG,CAAC;IAC1B,OAAO,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC;AAC5B,CAAC;AAED;;;SAGgB,MAAM,CAAgB,MAAmB,EAAE,GAAM;IAC/D,MAAM,KAAK,GAAG,GAAG,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;IAC/B,IAAI,KAAK,KAAK,SAAS;QAAE,OAAO;IAEhC,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;IAClD,KAAK,IAAI,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAC7C,MAAM,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QACnB,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;QACjB,OAAO,CAAC,CAAC,CAAE,EAAE,CAAC;KACf;IACD,OAAO,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC;IACzB,KAAK,CAAC,GAAG,EAAE,CAAC;AACd;;;;&quot;</span><span class="s0">}</span></pre>
</body>
</html>